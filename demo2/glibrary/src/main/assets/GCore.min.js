var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,e=[];!(b=a.next()).done;)e.push(b.value);return e};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){if(a==Array.prototype||a==Object.prototype)return a;a[b]=e.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var e=a[b];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var e=$jscomp.propertyToPolyfillSymbol[b];if(null==e)return a[b];e=a[e];return void 0!==e?e:a[b]};
$jscomp.polyfill=function(a,b,e,f){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,e,f):$jscomp.polyfillUnisolated(a,b,e,f))};$jscomp.polyfillUnisolated=function(a,b,e,f){e=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var h=a[f];if(!(h in e))return;e=e[h]}a=a[a.length-1];f=e[a];b=b(f);b!=f&&null!=b&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,e,f){var h=a.split(".");a=1===h.length;f=h[0];f=!a&&f in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<h.length-1;g++){var l=h[g];if(!(l in f))return;f=f[l]}h=h[h.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?f[h]:null;b=b(e);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,h,{configurable:!0,writable:!0,value:b}):b!==e&&($jscomp.propertyToPolyfillSymbol[h]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(h):$jscomp.POLYFILL_PREFIX+h,h=
$jscomp.propertyToPolyfillSymbol[h],$jscomp.defineProperty(f,h,{configurable:!0,writable:!0,value:b})))};
$jscomp.getConstructImplementation=function(){function a(){function e(){}new e;Reflect.construct(e,[],function(){});return new e instanceof e}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(e,f,h){e=b(e,f);h&&Reflect.setPrototypeOf(e,h.prototype);return e}}return function(e,f,h){void 0===h&&(h=e);h=$jscomp.objectCreate(h.prototype||Object.prototype);return Function.prototype.apply.call(e,h,f)||
h}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(e){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var e=$jscomp.setPrototypeOf;e(a,b)}else for(e in b)if("prototype"!=e)if(Object.defineProperties){var f=Object.getOwnPropertyDescriptor(b,e);f&&Object.defineProperty(a,e,f)}else a[e]=b[e];a.superClass_=b.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var e=a.next();$jscomp.generator.ensureIteratorResultIsObject_(e);if(e.done)this.yieldResult=e.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(e.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,e){e?this.finallyContexts_[e]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(e){return{value:e,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,e){try{var f=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(f);if(!f.done)return this.context_.stop_(),f;var h=f.value}catch(g){return this.context_.yieldAllIterator_=null,this.context_.throw_(g),this.nextStep_()}this.context_.yieldAllIterator_=null;e.call(this.context_,h);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(f){return a.next(f)}function e(f){return a.throw(f)}return new Promise(function(f,h){function g(l){l.done?f(l.value):Promise.resolve(l.value).then(b,e).then(g,h)}g(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.polyfill("Reflect",function(a){return a?a:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(a){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(e,f){try{return b(e,f),!0}catch(h){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(h,g){this.$jscomp$symbol$id_=h;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var e=0,f=function(h){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(h||"")+"_"+e++,h)};return f},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),e=0;e<b.length;e++){var f=$jscomp.global[b[e]];"function"===typeof f&&"function"!=typeof f.prototype[a]&&$jscomp.defineProperty(f.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function e(l){return l instanceof h?l:new h(function(v,n){v(l)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(l){if(null==this.batch_){this.batch_=[];var v=this;this.asyncExecuteFunction(function(){v.executeBatch_()})}this.batch_.push(l)};var f=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(l){f(l,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var l=
this.batch_;this.batch_=[];for(var v=0;v<l.length;++v){var n=l[v];l[v]=null;try{n()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};b.prototype.asyncThrow_=function(l){this.asyncExecuteFunction(function(){throw l;})};var h=function(l){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var v=this.createResolveAndReject_();try{l(v.resolve,v.reject)}catch(n){v.reject(n)}};h.prototype.createResolveAndReject_=function(){function l(p){return function(c){n||(n=!0,p.call(v,c))}}var v=this,n=!1;
return{resolve:l(this.resolveTo_),reject:l(this.reject_)}};h.prototype.resolveTo_=function(l){if(l===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(l instanceof h)this.settleSameAsPromise_(l);else{a:switch(typeof l){case "object":var v=null!=l;break a;case "function":v=!0;break a;default:v=!1}v?this.resolveToNonPromiseObj_(l):this.fulfill_(l)}};h.prototype.resolveToNonPromiseObj_=function(l){var v=void 0;try{v=l.then}catch(n){this.reject_(n);return}"function"==typeof v?
this.settleSameAsThenable_(v,l):this.fulfill_(l)};h.prototype.reject_=function(l){this.settle_(2,l)};h.prototype.fulfill_=function(l){this.settle_(1,l)};h.prototype.settle_=function(l,v){if(0!=this.state_)throw Error("Cannot settle("+l+", "+v+"): Promise already settled in state"+this.state_);this.state_=l;this.result_=v;this.executeOnSettledCallbacks_()};h.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var l=0;l<this.onSettledCallbacks_.length;++l)g.asyncExecute(this.onSettledCallbacks_[l]);
this.onSettledCallbacks_=null}};var g=new b;h.prototype.settleSameAsPromise_=function(l){var v=this.createResolveAndReject_();l.callWhenSettled_(v.resolve,v.reject)};h.prototype.settleSameAsThenable_=function(l,v){var n=this.createResolveAndReject_();try{l.call(v,n.resolve,n.reject)}catch(p){n.reject(p)}};h.prototype.then=function(l,v){function n(z,y){return"function"==typeof z?function(m){try{p(z(m))}catch(u){c(u)}}:y}var p,c,w=new h(function(z,y){p=z;c=y});this.callWhenSettled_(n(l,p),n(v,c));return w};
h.prototype.catch=function(l){return this.then(void 0,l)};h.prototype.callWhenSettled_=function(l,v){function n(){switch(p.state_){case 1:l(p.result_);break;case 2:v(p.result_);break;default:throw Error("Unexpected state: "+p.state_);}}var p=this;null==this.onSettledCallbacks_?g.asyncExecute(n):this.onSettledCallbacks_.push(n)};h.resolve=e;h.reject=function(l){return new h(function(v,n){n(l)})};h.race=function(l){return new h(function(v,n){for(var p=$jscomp.makeIterator(l),c=p.next();!c.done;c=p.next())e(c.value).callWhenSettled_(v,
n)})};h.all=function(l){var v=$jscomp.makeIterator(l),n=v.next();return n.done?e([]):new h(function(p,c){function w(m){return function(u){z[m]=u;y--;0==y&&p(z)}}var z=[],y=0;do z.push(void 0),y++,e(n.value).callWhenSettled_(w(z.length-1),c),n=v.next();while(!n.done)})};return h},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var e=0,f={next:function(){if(e<a.length){var h=e++;return{value:b(h,a[h]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(b,e,f){var h=this.length||0;0>e&&(e=Math.max(0,h+e));if(null==f||f>h)f=h;f=Number(f);0>f&&(f=Math.max(0,h+f));for(e=Number(e||0);e<f;e++)this[e]=b;return this}},"es6","es3");$jscomp.typedArrayFill=function(a){return a?a:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.checkStringArgs=function(a,b,e){if(null==a)throw new TypeError("The 'this' value for String.prototype."+e+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+e+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(b,e){var f=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===e&&(e=f.length);e=Math.max(0,Math.min(e|0,f.length));for(var h=b.length;0<h&&0<e;)if(f[--e]!=b[--h])return!1;return 0>=h}},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(b,e,f){e=null!=e?e:function(v){return v};var h=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof g){b=g.call(b);for(var l=0;!(g=b.next()).done;)h.push(e.call(f,g.value,l++))}else for(g=b.length,l=0;l<g;l++)h.push(e.call(f,b[l],l));return h}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,e){var f=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var h=f.length,g=b.length;e=Math.max(0,Math.min(e|0,f.length));for(var l=0;l<g&&e<h;)if(f[e++]!=b[l++])return!1;return l>=g}},"es6","es3");
function GDataIncAnalysis(){function a(c,w,z){if(null==c)return null;for(var y=[],m=0;m<c.length;m++){var u=null;z&&(u=z[c[m][0].toLowerCase()]);null==c[m][1]&&(c[m][1]="t");if("x"==c[m][1][0])for(var x=parseInt(c[m][1][1]),d,t=0;t<w.length;t++)void 0==y[t]&&(y[t]=[]),w[t]&&null!=w[t][m]&&(u&&u[t]&&3==(u[t]&3)?y[t][m]=null:(d=u&&u[t]&&0<(u[t]>>5&7)?(u[t]>>5&7)-1:x,y[t][m]=w[t][m]/f[d]));else{for(t=0;t<w.length;t++)void 0==y[t]&&(y[t]=[]),y[t][m]=u&&u[t]&&3==(u[t]&3)?null:null!=w[t]&&null!=w[t][m]?
w[t][m]:null;if("c"==c[m][1]||"t"==c[m][1]||"t"==c[m][1][0]&&"0"<=c[m][1][1]&&"9">=c[m][1][1])for(t=0;t<y.length;t++)y[t][m]&&"string"==typeof y[t][m]&&(y[t][m]=y[t][m].replace(/\\n/g,"\n"))}}return y}function b(c,w,z){if(null==c)return null;for(var y=[],m=0;m<c.length;m++){void 0==y[m]&&(y[m]=[]);var u=null;z&&(u=z[c[m][0].toLowerCase()]);if(null!=w[m])if("x"==c[m][1][0])for(var x=parseInt(c[m][1][1]),d=0;d<w[m].length;d++)if(u&&u[d]&&3==(u[d]&3))y[m][d]=null;else{var t=u&&u[d]&&0<(u[d]>>5&7)?(u[d]>>
5&7)-1:x;y[m][d]=w[m][d]/f[t]}else{for(d=0;d<w[m].length;d++)y[m][d]=u&&u[d]&&3==(u[d]&3)?null:w[m][d];if("c"==c[m][1]||"t"==c[m][1]||"t"==c[m][1][0]&&"0"<=c[m][1][1]&&"9">=c[m][1][1])for(d=0;d<y[m].length;d++)y[m][d]&&"String"==y[m][d].constructor.name&&(y[m][d]=y[m][d].replace(/\\n/g,"\n"))}}return y}function e(c){c=new Date;return 1E5*c.getUTCMinutes()+1E3*c.getUTCSeconds()+c.getUTCMilliseconds()}this.socketDecode=function(c,w,z){z=0;"undefined"==typeof c.result&&(c.result=[]);for(var y=c.orgLen=
0;y<w.result.length;y++){var m=w.result[y].table;if(null!=m){var u=m.info,x=m.gid;null==x&&(x=w.result[y].gid);u.name=x.name;u.msg=w.msg?w.msg:"";var d=parseInt(x.idx),t,q,D,A=!1;1==c.cacheWindow&&(A=!0);u.begin--;u.thisBegin&&u.thisBegin--;var G=m.field,B=m.data,I=m.last,L=m.adjust,C=m.modify,F=G;null==F&&c.result&&c.result[d]&&c.result[d].table&&(F=c.result[d].table.field);if(null==F&&c.result[d]&&c.result[d].table&&null==c.result[d].table.field)c.result[d]=null;else{v(m,F,z);delete m.flgs;var P=
JSON.stringify(m).length;c.orgLen+=P;var K=m.flags;"row"!=u.rank&&"col"!=u.rank&&(u.rank="row");void 0==c.result[d]&&(c.result[d]={updateCounter:0});void 0==c.result[d].table&&(c.result[d].table={});c.result[d].updateCounter=e();var E=!1;P=c.result[d].table.info;if(void 0==P){if(null==B&&C){c.result[d]=null;continue}c.result[d].table.info=xDeepCopy(u);E=!0}else null==c.result[d].gid||c.result[d].gid.id!=x.id?E=!0:G&&m.data&&("row"==u.rank&&u.rows==m.data.length||"col"==u.rank&&u.rows==m.data[0].length)?
E=!0:P.begin+P.rows<u.begin||u.begin+u.rows<P.begin?(E=2,void 0==F&&(F=c.result[d].table.field),null==G&&(G=F)):u.begin==u.thisBegin&&B&&("row"==u.rank?B.length==u.rows&&(E=!1):B&&B[0]&&B[0].length==u.rows&&(E=!1));if(E&&null!=C)break;if(E)if(2!=E&&(c.result[d].table={}),c.result[d].table.data=[],c.result[d].table.flags={},c.result[d].table.dataStatus=[],B){if("row"==u.rank){var N=a(F,B,K);if(A)c.result[d].table.data=N,u.dataBegin=u.begin,u.dataRows=u.rows;else if(N){for(t=E=0;E<N.length;t++,E++)c.result[d].table.data[t]=
N[E];for(dataBegin in c.result[d].table.data)break;u.dataBegin=0;u.dataRows=c.result[d].table.data.length}else u.dataBegin=0,u.dataRows=0}else if(N=b(F,B,K),A)c.result[d].table.data=N,u.dataBegin=u.begin,u.dataRows=u.rows;else if(N){for(q=0;q<N.length;q++)for(E=0,c.result[d].table.data[q]=[],t=0;E<N[q].length;t++,E++)c.result[d].table.data[q][t]=N[q][E];u.dataBegin=u.begin;u.dataRows=c.result[d].table.data[0].length}else u.dataBegin=0,u.dataRows=0;if(K&&0<Object.keys(K).length)if(A)for(D in K)c.result[d].table.flags[D.toLowerCase()]=
K[D];else if("row"==u.rank)for(D in K)for(E=0,q=D.toLowerCase(),c.result[d].table.flags[q]=[],t=u.begin;E<K[D].length;E++,t++)c.result[d].table.flags[q][t]=K[D][E];else for(D in K)for(E=0,q=D.toLowerCase(),c.result[d].table.flags[q]=[],t=0;E<K[D].length;E++,t++)c.result[d].table.flags[q][t]=K[D][E]}else u.dataBegin=0,u.dataRows=0;else c.result[d].table.dataStatus=[],A?(p(c.result[d].table,m,F),u.rows=c.result[d].table.info.dataRows):p(c.result[d].table,m,F);if(C){if(c.result[d].table.dataStatus)for(t=
0;t<c.result[d].table.dataStatus.length;t++)void 0==c.result[d].table.dataStatus[t]&&(c.result[d].table.dataStatus[t]=0);if(null==B&&C.flags)for(D in K=0,"row"==u.rank?c.result[d].table.data&&(K=c.result[d].table.data.length):c.result[d].table&&c.result[d].table.data[0]&&(K=c.result[d].table.data[0].length),C.flags)for(E=0;E<C.record.length;E++)t=C.flags[D][E],q=C.record[E]-1,q-=c.result[d].table.info.dataBegin,-1<q&&q<K&&(B=D.toLowerCase(),void 0==c.result[d].table.flags[B]&&(c.result[d].table.flags[B]=
[]),c.result[d].table.flags[B][q]=t);K=c.result[d].table.flags;if("updateappend"==u.type)if(t=C.record[0]-1,t<u.begin||t>=u.begin+u.row)console.log("updateappend \u8d85\u51fa\u7a97\u53e3\u8303\u56f4!");else{A&&(t-=u.begin);B=1;E=N=0;if(C.data&&C.data[E])for(var M=0;M<C.data[E].length;M++)N+=C.data[E][M].length;if("row"==u.rank)for(M=0;M<N;M++){if(q=g(C.data[E][0],M),!(q>=F.length)){if("x"==F[q][1][0]){var J=parseInt(F[q][1][1]),H=null;K&&(H=K[F[q][0].toLowerCase()]);H&&H[t]&&3==(H[t]&3)?c.result[d].table.data[t][q]=
null:(H&&H[t]&&0<(H[t]>>5&7)&&(J=(H[t]>>5&7)-1),c.result[d].table.data[t][q]=null==c.result[d].table.data[t][q]?C.data[B]/f[J]:c.result[d].table.data[t][q]+C.data[B]/f[J],c.result[d].table.data[t][q]=parseFloat(c.result[d].table.data[t][q].toFixed(J)))}else"i"==F[q][1][0]?c.result[d].table.data[t][q]="."==F[q][1][2]?C.data[B]:c.result[d].table.data[t][q]+C.data[B]:"t"!=F[q][1]&&"t"==F[q][1][0]?c.result[d].table.data[t][q]+=C.data[B]:"d"==F[q][1][0]?c.result[d].table.data[t][q]+=C.data[B]:"g"==F[q][1][0]?
c.result[d].table.data[t][q][2]&&(J=c.result[d].table.data[t][q][2],c.result[d].table.data[t][q][0]==C.data[B][0]&&(B=c.result[d].table.data[t][q][J-1].length,c.result[d].table.data[t][q][J-1][B-1]=C.data[B][0])):c.result[d].table.data[t][q]=C.data[B];B++}}else for(M=0;M<N;M++)q=g(C.data[E],M),"x"==F[q][1][0]?(J=parseInt(F[q][1][1]),H=null,K&&(H=K[F[q][0].toLowerCase()]),H&&H[t]&&3==(H[t]&3)?c.result[d].table.data[t][q]=null:(H&&H[t]&&0<(H[t]>>5&7)&&(J=(H[t]>>5&7)-1),c.result[d].table.data[q][t]=
null==c.result[d].table.data[q][t]?C.data[B]/f[J]:c.result[d].table.data[q][t]+C.data[B]/f[J],c.result[d].table.data[q][t]=parseFloat(c.result[d].table.data[q][t].toFixed(J)))):"i"==F[q][1][0]?c.result[d].table.data[q][t]="."==F[q][1][2]?C.data[B]:c.result[d].table.data[q][t]+C.data[B]:"t"!=F[q][1]&&"t"==F[q][1][0]?c.result[d].table.data[q][t]+=C.data[B]:"d"==F[q][1][0]?c.result[d].table.data[q][t]+=C.data[B]:"g"!=F[q][1][0]&&(c.result[d].table.data[q][t]=C.data[B]),B++;c.result[d].table.dataStatus[t]=
1}else if(C.data)for(E=0;E<C.record.length;E++)if(t=C.record[E]-1,null!=C.data[E]&&0!=C.data[E].length)if(t<u.begin||t>=u.begin+u.rows)console.log("update \u8d85\u51fa\u7a97\u53e3\u8303\u56f4!");else{A&&(t-=u.begin);B=1;for(M=N=0;M<C.data[E][0].length;M++)N+=C.data[E][0][M].length;for(M=0;M<N;M++){q=g(C.data[E][0],M);if(void 0!=c.result[d].table.data[t])if("x"==F[q][1][0])J=parseInt(F[q][1][1]),H=null,K&&(H=K[F[q][0].toLowerCase()]),H&&H[t]&&3==(H[t]&3)?c.result[d].table.data[t][q]=null:(H&&H[t]&&
0<(H[t]>>5&7)&&(J=(H[t]>>5&7)-1),c.result[d].table.data[t][q]=null==c.result[d].table.data[t][q]?C.data[E][B]/f[J]:c.result[d].table.data[t][q]+C.data[E][B]/f[J],c.result[d].table.data[t][q]=parseFloat(c.result[d].table.data[t][q].toFixed(J)));else if("i"==F[q][1][0])c.result[d].table.data[t][q]="."==F[q][1][2]?C.data[E][B]:c.result[d].table.data[t][q]+C.data[E][B];else if("t"!=F[q][1]&&"t"==F[q][1][0]&&"a"!=F[q][1][1]&&"A"<=F[q][1][1])c.result[d].table.data[t][q]="1"==u.compressed?"s"==F[q][1][1]?
c.result[d].table.data[t][q]+1E3*C.data[E][B]:"m"==F[q][1][1]?c.result[d].table.data[t][q]+6E4*C.data[E][B]:c.result[d].table.data[t][q]+C.data[E][B]:c.result[d].table.data[t][q]+C.data[E][B];else if("d"==F[q][1][0])c.result[d].table.data[t][q]+=C.data[E][B];else if("g"==F[q][1][0]){if(c.result[d].table.data[t]&&c.result[d].table.data[t][q]&&c.result[d].table.data[t][q][2]){J=c.result[d].table.data[t][q][2];H=c.result[d].table.data[t][q][0];for(var O=0;O<J-1;O++)H-=c.result[d].table.data[t][q][3+
O][0]+1;if("1"==u.compressed){if(c.result[d].table.data[t][q][3+J-1][H-1]=C.data[E][B][0],1<C.data[E][B].length)for(O=1;O<C.data[E][B].length;O++)c.result[d].table.data[t][q][3+J-1][H+O-1]=c.result[d].table.data[t][q][3+J-1][H+O-2],c.result[d].table.data[t][q][0]++}else if(c.result[d].table.data[t][q][3+J-1][H-1]=C.data[E][B][0],1<C.data[E][B].length)for(O=1;O<C.data[E][B].length;O++)c.result[d].table.data[t][q][3+J-1][H+O-1]=C.data[E][B][O],c.result[d].table.data[t][q][0]++}}else c.result[d].table.data[t][q]=
C.data[E][B];B++}c.result[d].table.dataStatus[t]=1}u.dataBegin=P.dataBegin;u.dataRows=P.dataRows}u&&(null!=u.dataBegin&&null!=u.name||!c.result[d].table.info||(u.dataBegin=c.result[d].table.info.dataBegin,u.dataRows=c.result[d].table.info.dataRows,u.name=c.result[d].table.info.name),c.result[d].table.info=xDeepCopy(u));if(G&&(c.result[d].table.field=xDeepCopy(G),c.alias&&c.alias[d]))for(A=c.alias[d].split(","),B=0;B<A.length&&B<F.length;B++)""!=A[B]&&(c.result[d].table.field[B][0]=trim(A[B]));if(L&&
(c.result[d].table.adjust=xDeepCopy(L),"1"==u.compressed&&(L=c.result[d].table.adjust)&&0<L.length))for(F=n,G=A=0;G<L.length;G++)if(L[G][0]+=F,F=L[G][0],0<L[G][1].length)for(C=0;C<L[G][1].length;C++)L[G][1][C][0]+=F,F=L[G][1][C][0],L[G][1][C][1]+=A,A=L[G][1][C][1];else L[G][1]+=A,A=L[G][1];if(I&&(c.result[d].table.last=xDeepCopy(I),"1"==u.compressed&&(I=c.result[d].table.last)&&0<I.length))for(L=n,G=A=F=0;G<I.length;G++)I[G][0]+=L,L=I[G][0],I[G][2]=I[G][1]+A,I[G][1]=F,A=I[G][2],F+=A;for(D in m)I=
D.toLowerCase(),"gid"!=I&&"info"!=I&&"data"!=I&&"modify"!=I&&"field"!=D&&"flags"!=I&&"flgs"!=I&&"adjust"!=I&&"last"!=I&&("1"==u.compressed&&v(m[D].table,null,z),c.result[d].table[D]=m[D]);c.result[d].updateCounter=e();c.result[d].gid=xDeepCopy(x)}}}return c};this.httpDecode=function(c,w){void 0==c.result&&(c.result=[]);if(null==w.result)return c.result;for(var z=0;z<w.result.length;z++){var y=w.result[z].table,m=y.info,u=y.flags;if(!m)break;var x=y.gid;null==x&&(x=w.result[z].gid);m.name=x.name;m.id=
x.id;m.msg=w.msg?w.msg:"";m.thisBegin?m.thisBegin--:m.thisBegin=m.dataBegin-1;m.begin--;var d=parseInt(x.id),t=!1;if(null==c.result||null==c.result[0]||c.result[0].httpId!==d)t=!0;x=y.field;var q=y.data;if("row"!=m.rank&&"col"!=m.rank)return c.result;void 0==c.result[0]&&(c.result[0]={updateCounter:0});void 0==c.result[0].table&&(c.result[0].table={});c.result[0].updateCounter=e();c.result[0].httpId=d;d=c.result[0].table.info;if(void 0==d)c.result[0].table.info=xDeepCopy(m),t=!0;else if(d.id!=m.id)t=
!0,d.id=m.id;else if(d.begin==m.begin&&d.dataRows<=m.rows)t=!0;else if(d.dataBegin+d.dataRows<m.begin||m.begin+m.rows<d.dataBegin)t=!0,void 0==x&&(newField=x=c.result[0].table.field);if(0<=m.totalRows&&q){if(t){c.result[0].table.data=[];c.result[0].table.flags={};c.result[0].table.dataStatus=[];if("row"==m.rank){if(y=a(x,q,u)){for(r=k=0;k<y.length;r++,k++)c.result[0].table.data[r]=y[k];c.result[0].table.info.begin=m.thisBegin;c.result[0].table.info.thisBegin=m.thisBegin;c.result[0].table.info.rows=
m.rows;c.result[0].table.info.totalRows=m.totalRows}c.result[0].table.data||(m.rows=m.totalRows=0)}else c.result[0].table.data=b(x,q,u);if(x&&(c.result[0].table.field=xDeepCopy(x),c.alias&&c.alias[0]))for(m=c.alias[0].split(","),y=0;y<m.length&&y<x.length;y++)""!=m[y]&&(c.result[0].table.field[y][0]=trim(m[y]))}else{if(m.begin>=d.begin+d.rows){if(q=0,"row"==m.rank)for(x=m.thisBegin;q<y.data.length;x++,q++)c.result[0].table.data[x]=y.data[q]}else if(m.begin+m.rows<=d.begin){q=0;if("row"==m.rank)for(x=
m.thisBegin;q<y.data.length;x++,q++)c.result[0].table.data[x]=y.data[q];c.result[0].table.info.begin=m.thisBegin;c.result[0].table.info.thisBegin=m.thisBegin}else if(m.begin<d.begin+d.rows)for(m.thisBegin<d.begin&&(c.result[0].table.info.begin=m.thisBegin,c.result[0].table.info.thisBegin=m.thisBegin),y=m.begin,x=c.result[0].table.data,u=0;u<q.length;u++)x[y+u]=q[u];c.result[0].table.info.rows=m.rows;c.result[0].table.info.totalRows=m.totalRows}c.result[0].table.info.dataBegin=0;c.result[0].table.info.dataRows=
c.result[0].table.data.length}else{1==parseInt(w.pageId)&&2==parseInt(w.index)&&(debugCount++,console.log("-- "+debugCount+" ---- \u7a7a\u8868 -------"));break}}return c};var f=[1,10,100,1E3,1E4,1E5,1E6],h={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35,A:36,B:37,C:38,D:39,E:40,F:41,G:42,H:43,I:44,J:45,K:46,L:47,M:48,N:49,O:50,P:51,Q:52,R:53,S:54,T:55,U:56,V:57,W:58,X:59,Y:60,
Z:61,"~":62,"!":63,"*":-1},g=function(c,w){for(var z=0,y=0,m=0;m<c.length;m++){if(w<z+c[m].length)return h[c[m][w-z]]+y;z+=c[m].length;y+=64}},l=[1E6,1E5,1E4,1E3,100,10,1],v=function(c,w,z){z=12622752E5;var y=n;if(null!=c){var m=c.info;if(null!=m&&"1"==m.compressed){if(null==w&&(w=c.field,null==w))return;if(c.flgs){for(var u=null,x=0,d=0;d<w.length;d++)0<=w[d][1].indexOf("!")&&(null==u&&(u={}),u[w[d][0].toLowerCase()]=c.flgs[x++]);u&&(c.flags=u)}if(c.flags){u=c.flags;for(var t in u)for(d=0;d<u[t].length;d++)if(1<
u[t][d].length){x=u[t][d][0];var q=Array(u[t][d][0]).fill(u[t][d][1]);u[t]=u[t].slice(0,d).concat(q).concat(u[t].slice(d+1));d+=x-1}}if(c.data&&w)if("tree"==m.mode)for(m=0;m<w.length;m++)if("_expand"==w[m][0])for(d=0;d<c.data.length;d++)c.data[d]&&c.data[d][m]&&(c.data[d][m]=0==c.data[d][m]?"":1==c.data[d][m]?"-":"+");else{if("_path"==w[m][0]){z="";y=-1;for(u=0;u<w.length&&"_level"!=w[u][0];u++);if(null!=u)for(d=0;d<c.data.length;d++)y==c.data[d][u]&&(c.data[d][m]=z),z=c.data[d][m],y=c.data[d][u]}}else if("col"==
m.rank)for(m=0;m<w.length;m++){if(null!=c.data[m]){if("g"!=w[m][1][0])if("c"==w[m][1]||"t"==w[m][1]||"t"==w[m][1][0]&&"0"<=w[m][1][1]&&"9">=w[m][1][1])for(d=0;d<c.data[m].length;d++)"Array"==c.data[m][d].constructor.name&&(x=c.data[m][d][0],q=Array(c.data[m][d][0]).fill(c.data[m][d][1]),c.data[m]=c.data[m].slice(0,d).concat(q).concat(c.data[m].slice(d+1)),d+=x-1);else for(d=0;d<c.data[m].length;d++)c.data[m][d]&&1<c.data[m][d].length&&(x=c.data[m][d][0],q=Array(c.data[m][d][0]).fill(c.data[m][d][1]),
c.data[m]=c.data[m].slice(0,d).concat(q).concat(c.data[m].slice(d+1)),d+=x-1);if("ts"==w[m][1])for(c.data[m][0]*=1E3,c.data[m][0]+=z,d=1;d<c.data[m].length;d++)c.data[m][d]=null!=c.data[m][d]&&null!=c.data[m][d-1]?c.data[m][d-1]+1E3*c.data[m][d]:1E3*c.data[m][d];else if("tm"==w[m][1])for(c.data[m][0]*=6E4,c.data[m][0]+=z,d=1;d<c.data[m].length;d++)c.data[m][d]=null!=c.data[m][d]&&null!=c.data[m][d-1]?c.data[m][d-1]+6E4*c.data[m][d]:6E4*c.data[m][d];else if("tms"==w[m][1])for(c.data[m][0]+=z,d=1;d<
c.data[m].length;d++)null!=c.data[m][d]&&null!=c.data[m][d-1]&&(c.data[m][d]=c.data[m][d-1]+c.data[m][d]);else if("x"==w[m][1][0])if(c.flags&&c.flags[w[m][0].toLowerCase()])for(u=c.flags[w[m][0].toLowerCase()],d=1;d<c.data[m].length;d++)null!=c.data[m][d]&&null!=c.data[m][d-1]&&(u[d]>>5==u[d-1]>>5?c.data[m][d]+=c.data[m][d-1]:(x=(u[d-1]>>5&7)-1,-1==x&&(x=parseInt(w[m][1][1])),q=(u[d]>>5&7)-1,-1==q&&(q=parseInt(w[m][1][1])),c.data[m][d]=parseInt(((c.data[m][d-1]*l[x]+c.data[m][d]*l[x>q?x:q])/l[q]).toFixed(0))));
else for(d=1;d<c.data[m].length;d++)null!=c.data[m][d]&&null!=c.data[m][d-1]&&(c.data[m][d]+=c.data[m][d-1]);else if("dd"==w[m][1]||"dq"==w[m][1]||"dm"==w[m][1]){if(0<c.data[m].length)for(c.data[m][0]+=y,d=1;d<c.data[m].length;d++)null!=c.data[m][d]&&null!=c.data[m][d-1]&&(c.data[m][d]+=c.data[m][d-1])}else if("dy"==w[m][1]&&0<c.data[m].length)for(c.data[m][0]*=1E4,d=1;d<c.data[m].length;d++)c.data[m][d]=null!=c.data[m][d]&&null!=c.data[m][d-1]?1E4*c.data[m][d]+c.data[m][d-1]:1E4*c.data[m][d]}}else if("row"==
m.rank)for(m=0;m<w.length;m++)if("dd"==w[m][1]||"dq"==w[m][1]||"dm"==w[m][1]){if(0<c.data.length)for(d=0;d<c.data.length;d++)c.data[d][m]+=y}else if("dy"==w[m][1]){if(0<c.data.length)for(d=0;d<c.data.length;d++)c.data[d][m]*=1E4}else if("ti"==w[m][1])for(d=0;d<c.data.length;d++){if(c.data[d]&&c.data[d][m])for(u=x=0;u<c.data[d][m].length;u++)c.data[d][m][u][0]+=x,x=c.data[d][m][u][0],c.data[d][m][u][0]*=1E3,c.data[d][m][u][1]+=x,x=c.data[d][m][u][1],c.data[d][m][u][1]*=1E3}else if("g"==w[m][1][0])for(d=
0;d<c.data.length;d++){if(c.data[d]&&c.data[d][m]&&c.data[d][m][2])for(u=q=0;u<c.data[d][m][2];u++)if(c.data[d][m][u+3])for(x=1;x<c.data[d][m][u+3].length;x++)c.data[d][m][u+3][x]+=q,q=c.data[d][m][u+3][x]}else if("ts"==w[m][1])for(d=0;d<c.data.length;d++)c.data[d]&&c.data[d][m]&&(c.data[d][m]*=1E3,c.data[d][m]+=z);else if("tm"==w[m][1])for(d=0;d<c.data.length;d++)c.data[d]&&c.data[d][m]&&(c.data[d][m]*=6E4,c.data[d][m]+=z);else if("tms"==w[m][1])for(d=0;d<c.data.length;d++)c.data[d]&&c.data[d][m]&&
(c.data[d][m]+=z);if(c.modify){if(c.modify.record)for(m=1,d=0;d<c.modify.record.length;d++)c.modify.record[d]+=m,m=c.modify.record[d];if(c.modify.flgs&&w){u=null;for(d=x=0;d<w.length;d++)0<=w[d][1].indexOf("!")&&(null==u&&(u={}),u[w[d][0].toLowerCase()]=c.modify.flgs[x++]);u&&(c.modify.flags=u)}if(c.modify.flags)for(t in u=c.modify.flags,u)for(d=0;d<u[t].length;d++)1<u[t][d].length&&(q=Array(u[t][d][0]).fill(u[t][d][1]),u[t]=u[t].slice(0,d).concat(q).concat(u[t].slice(d+1)))}}}},n=18980101,p=function(c,
w,z){var y=w.info,m=w.data;w=w.flags;var u=c.info,x=c.data;if(m){if("row"==y.rank){var d=a(z,m,w);if(d)if(y.thisBegin<u.dataBegin){for(var t=u.dataBegin-y.thisBegin,q=0;q<t;q++)x.unshift(null);for(q=0;q<d.length;q++)x[q]=d[q];if(w)for(var D in w){if(null==c.flags[D.toLowerCase()])c.flags[D.toLowerCase()]=[];else for(q=0;q<t;q++)c.flags[D.toLowerCase()].unshift(null);for(q=0;q<w[D].length;q++)c.flags[D.toLowerCase()][q]=w[D][q]}y.dataBegin=y.thisBegin}else if(y.thisBegin>=u.dataBegin){q=t=y.thisBegin-
u.dataBegin;for(m=0;m<d.length;q++,m++)x[q]=d[m];if(w)for(D in w)for(null==c.flags[D.toLowerCase()]&&(c.flags[D.toLowerCase()]=[]),q=t,m=0;m<w[D].length;q++,m++)c.flags[D.toLowerCase()][q]=w[D][m];y.dataBegin=u.dataBegin}y.dataRows=x.length}else{if(d=b(z,m,w))if(y.thisBegin<u.dataBegin){t=u.dataBegin-y.thisBegin;for(var A=0;A<z.length;A++){for(q=0;q<t;q++)x[A].unshift(null);for(q=0;q<d[A].length;q++)x[A][q]=d[A][q]}if(w)for(D in w){if(null==c.flags[D.toLowerCase()])c.flags[D.toLowerCase()]=[];else for(q=
0;q<t;q++)c.flags[D.toLowerCase()].unshift(null);for(q=0;q<w[D].length;q++)c.flags[D.toLowerCase()][q]=w[D][q]}y.dataBegin=y.thisBegin}else if(y.thisBegin>=u.dataBegin){t=y.thisBegin-u.dataBegin;for(A=0;A<z.length;A++)for(null==x[A]&&(x[A]=[]),q=t,m=0;m<d[A].length;q++,m++)x[A][q]=d[A][m];if(w)for(D in w)for(null==c.flags[D.toLowerCase()]&&(c.flags[D.toLowerCase()]=[]),q=t,m=0;m<w[D].length;q++,m++)c.flags[D.toLowerCase()][q]=w[D][m];y.dataBegin=u.dataBegin}y.dataRows=x&&x[0]?x[0].length:0}u.dataRows=
y.dataRows;u.dataBegin=y.dataBegin}else if(0==y.totalRows){if("row"==y.rank)c.data=[];else for(c.data=[],A=0;A<z.length;A++)c.data[A]=null;u.dataRows=0;u.dataBegin=0}}}GDataIncAnalysis.sharedInstance=function(){null==this.instance&&(this.instance=new GDataIncAnalysis);return this.instance};function GDataManager(){var a=function(f,h){var g=GRequestManager.getItemsWithId(f);if(g&&null!=g.onCallback)g.onCallback(h);else null!=GSDK_HOOK.getOnCallback()&&(g=GDataSourceManager.sharedInstance(),h=g.getDataSourceWithId(f),f={id:f,data:h},GSDK_HOOK.getOnCallback()(f))},b=function(f){var h=f[1];switch(f[0]){case "t":switch(h){case void 0:case "a":return GDataType.dtString;case "h":case "m":case "s":return GDataType.dtInt64}case "i":case "d":case "t":return GDataType.dtInt;case "f":case "x":return GDataType.dtFloat;
case "g":return GDataType.dtArray}},e=function(f,h){var g=GDataSetManager.sharedInstance(),l=GDataSourceManager.sharedInstance();g=g.getDataSetWithId(f);var v=0;h=h.result;if(0!=h.length){var n=h[0].table;var p=n.field;var c=n.data;var w=n.info;h=w.name;var z=w.totalRows;var y=w.begin;var m=(null!=c[0]?c[0]:[]).length;if("row"==w.rank){w=[];for(var u=0;u<m;u++){w[u]=[];for(var x=0;x<c.length;x++)w[u][x]=c[x][u]}n.info.rank="col";n.data=w;m=0<w.length?w[0].length:0}n=xDeepCopy(n);l.setDataSetSourceWithId(f,
n);g.rowCount=m;if(null!=p){f={};for(l=0;l<p.length;l++)v=new GColumnInfo,m=p[l][0],n=p[l][1],f[m]=v,v.index=l+1,v.name=m,v.dataType=b(n),v.data=n;g.columnInfos=f;v=p.length}g.name=h;g.begin=y;g.colCount=v;g.totalRows=z;return g}};this.fireData=function(f){var h=f.type,g=f.params;if("undefined"!=typeof g.limit&&-1!=g.limit.indexOf(",")){var l=g.limit.split(",");l[0]=parseInt(l[0]);l[1]=parseInt(l[1])}"http"==h?null!=l&&(f.limit=l,delete f.params.limit):"quote"==h&&(null!=l&&(g.limit=l),g.function=
"select",GDataTool.wsParamsFlatten(f,g));a:{l=GDataSourceManager.sharedInstance();var v=f.objectId;if(0==l.isDataSourceWithId(v)){var n=GDataSetManager.sharedInstance(),p=new GDataSet;n.addDataSetWithId(v,p);if("quote"==h&&(n=f.params,1==n.url.endsWith("/day")||1==n.url.endsWith("/trend")||1==n.url.endsWith("/minute")||1==n.url.endsWith("/minute5"))){l.addDataSourceWithId(v,{cacheWindow:!0});break a}l.addDataSourceWithId(v,{})}}"http"==h?(g=GDataTool.httpParamsToString(g),g={name:"staic",requestId:f.requestId,
field:f.field,condition:g},null!=f.limit&&(g.limit=f.limit),g=GDataTool.generateHttpMessage("Api","sdk",""+f.objectId,g),GANetwork.sendHttp(f.url,"["+g+"]")):"quote"==h&&(h=GDataTool.wsParamsToString(g),h={name:"quote",requestId:f.requestId,sql:h},null!=g.limit&&(h.limit=g.limit),f=GDataTool.generateWsMessage("Api","sdk",""+f.objectId,h),GANetwork.send(f))};this.receiveWSData=function(f,h){if("quote"==f)for(f=0;f<h.length;f++){var g=h[f].gid.idx,l=GDataSourceManager.sharedInstance(),v=GDataIncAnalysis.sharedInstance(),
n=l.getDataSourceWithId(g);v=v.socketDecode(n,h[f]);l.setDataSourceWithId(g,xDeepCopy(v));l=e(g,v);a(g,l)}};this.receiveHTTPData=function(f){for(var h=0;h<f.length;h++){var g=f[h].gid.idx,l=GDataSourceManager.sharedInstance(),v=GDataIncAnalysis.sharedInstance(),n=l.getDataSourceWithId(g);v=v.httpDecode(n,f[h]);l.setDataSourceWithId(g,xDeepCopy(v));l=e(g,v);a(g,l)}}}GDataManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataManager);return this.instance};
function GDataSourceManager(){var a={},b={};this.addDataSourceWithId=function(e,f){null==a[e]&&(a[e]=f)};this.getDataSourceWithId=function(e){return a[e]};this.setDataSourceWithId=function(e,f){return null!=a[e]?(a[e]=f,!0):!1};this.delDataSourceWithId=function(e){return null!=a[e]?delete a[e]:!1};this.getAllDataSource=function(){return a};this.clearAllDataSource=function(){a={}};this.isDataSourceWithId=function(e){return null!=a[e]?!0:!1};this.setDataSetSourceWithId=function(e,f){b[e]=f};this.getDataSetSourceWithId=
function(e){return b[e]}}GDataSourceManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataSourceManager);return this.instance};function GDataSetManager(){var a={};this.addDataSetWithId=function(b,e){null==a[b]&&(e.id=b,a[b]=e)};this.getDataSetWithId=function(b){return a[b]};this.setDataSetWithId=function(b,e){return null!=a[b]?(a[b]=e,!0):!1};this.delDataSetWithId=function(b){return null!=a[b]?delete a[b]:!1};this.getAllDataSet=function(){return a}}
GDataSetManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataSetManager);return this.instance};function GDataTool(){this.describe="\u5de5\u5177\u7c7b"}
GDataTool.httpParamsToString=function(a){var b=[],e;for(e in a)if("condition"==e)b.push(a[e]);else switch(a[e].constructor.name.toLowerCase()){case "string":b.push(e+" = '"+a[e]+"'");break;case "number":b.push(e+" = "+a[e]);break;case "array":for(var f="[",h=0;h<a[e].length;h++){var g=a[e][h];switch(g.constructor.name.toLowerCase()){case "string":f+=0==h?"'"+g+"'":",'"+g+"'";break;case "number":f+=0==h?""+g:","+g}}f+="]";b.push(e+" = "+f)}for(a=0;a<b.length;a++)var l=0==a?b[a]:l+(" and "+b[a]);return l};
GDataTool.generateHttpMessage=function(a,b,e,f){var h={lang:"zh-cn",gid:{fm:"",pg:"",idx:""},http:[]};h.gid.fm=a;h.gid.pg=b;h.gid.idx=e;a=GDataTool.packHttpMessage(f);h.http.push(a);return JSON.stringify(h)};
GDataTool.packHttpMessage=function(a){var b={gid:{name:"",id:""},field:[],condition:{}};for(e in a)null!=b[e]&&(b[e]="field"!=e||null!=a[e]&&""!=a[e]?a[e]:[]);b.gid={name:a.name,id:a.requestId};if(null!=b.field&&0<b.field.length){var e=b.field.split(",");for(var f=[],h=0;h<e.length;h++){var g=e[h].replace(/ /g,"");g=trim(g);g=g.toLowerCase();f.push(g)}b.field=f}if(null!=b.condition&&null!=a.condition){e=a.condition;var l;null!=a.must&&(l=a.must.split(","));e=GAnalysisES(e,l);l=e.esCondition;if(0==
e.mustCheckStatu)return;null!=a.param&&(l.param=a.param);b.condition=l}null!=a.limit&&0<a.limit.length?a.batchMode&&"limit"==a.batchMode.toLowerCase()?(b.from=a.limit[0],b.fromSize=a.limit[1]):(b.pageNo=a.limit[0],b.pageSize=a.limit[1]):(b.pageNo=null!=a.pageNo?a.pageNo:"0",b.pageSize=null!=a.pageSize?a.pageSize:"10");return b};
GDataTool.wsParamsToString=function(a){var b={type:null,field:null,from:null,where:null,date:null,last:null,resample:null,relation:null,includeFlags:null,subscribe:null,orderby:null},e;for(e in a){var f=a[e];switch(e.toLowerCase()){case "function":b.type=f;break;case "field":b.field=f;break;case "url":b.from="from "+f;if(null!=a.keys){f=b.from.split("/");for(var h=a.keys.split(","),g=1;g<f.length;g++){var l=trim(h[g-1]);f[g]=f[g]+"("+l+")"}b.from=f.join("/")}break;case "date":b.date="at "+f;break;
case "last":b.last="at last "+f;break;case "condition":b.where="where "+f;break;case "resample":b.resample="resample("+f+")";break;case "relations":b.relation="relation("+f+")";break;case "includeflags":1==f&&(b.includeFlags="include flags");break;case "subscribe":1==f&&(b.subscribe="sub 100");break;case "orderby":b.orderby="order by "+f}}var v;for(v in b)if(null!=b[v]){a=b[v];var n="type"===v?a:n+(" "+a)}return n};
GDataTool.generateWsMessage=function(a,b,e,f){a={lang:"zh-cn",gid:{fm:a,pg:b,idx:e}};b=[];f=GDataTool.packWsMessage(f);null!=f.limit&&(f.limit=f.limit[0]+","+f.limit[1]);b.push(f);f=makeMessageString(JSON.stringify(b));a.sql=f;return JSON.stringify(a)};GDataTool.packWsMessage=function(a,b){b={gid:{name:a.name,id:a.requestId,idx:void 0===b?0:b},type:"query"};b.sql=a.sql;null!=a.limit&&(b.limit=a.limit);return b};
GDataTool.wsParamsFlatten=function(a,b){for(var e in a)null!=a[e]&&("Object"==a[e].constructor.name?GDataTool.wsParamsFlatten(a[e],b):b[e]=a[e])};
GDataTool.getValueFormatString=function(a,b,e,f,h){if(null==a)return null!=e&&0<=e.indexOf("%N")?"-":"";if(f&&3==(f&3))return"-";if("Array"==a.constructor.name){if("ti"==b){e="";for(var g=0;g<a.length;g++)e+="["+getValueFormatString(a[g][0],"tm","HH:mm")+","+getValueFormatString(a[g][1],"tm","HH:mm")+"] ";return e}return JSON.stringify(a)}"%d"==e&&(b="i");g=2;b&&("i"==b[0]?g=0:1<b.length&&(g=parseInt(b.slice(1))));var l=GDataTool.isTextType(b),v="Number"==a.constructor.name?!0:!1;h&&h.unit&&1<h.unit&&
v?(a/=h.unit,h=""+a,v=h.indexOf("."),b=0<=v?2<h.length-v-1?"f2":"f"+(h.length-v-1):"f"):(null==b||l)&&v&&(l=!1,h=""+a,v=h.indexOf("."),0<=v?(b="f"+(h.length-v-1),g=h.length-v-1):(b="f",g=0));h=a;if(void 0!=e){if(l){if("."==e[0]){if(l=a.indexOf("."),-1!=l)return a.slice(0,l)}else if("["==e[0])return v=parseInt(e.slice(1)),a.slice(0,v);return a}if(0==a&&0<=e.indexOf("%0"))return"-";l=e.indexOf("%B");0<=l&&(h=-1,null!=f&&(h=(f>>5&7)-1),0>h&&(h=1<b.length?parseInt(b.slice(1)):0),a/=Math.pow(10,h),5<=
a||-5>=a)&&(a=Math.round(a));h=a;var n=e;for(v=0;8>v;v++)if(l=e.indexOf("%."+v),-1!=l){if("string"==typeof a)return void 0!=e&&0<=e.indexOf("%%")?a+"%":a;h=a.toFixed(v);void 0!=e&&0<=e.indexOf("%%")&&(h+="%");g=v;break}-1!=e.indexOf("%V")&&(n=xGlobal.integerFormat,null==n&&(n="%5K"));l=n.indexOf("%,");if(0<=l){h+="";a=h.length;for(l=a-1;0<l;l--)if("."==h[l]){a=l;break}if(3<a)for(l=a-3;0<l&&"-"!=h.slice(0,l);l-=3)h=h.slice(0,l)+","+h.slice(l);return h}l=0<=n.indexOf("%K")?0:0<=n.indexOf("%0K")?0:0<=
n.indexOf("%1K")?1:0<=n.indexOf("%2K")?2:0<=n.indexOf("%3K")?3:0<=n.indexOf("%4K")?4:0<=n.indexOf("%5K")?5:0<=n.indexOf("%6K")?6:0<=n.indexOf("%7K")?7:0<=n.indexOf("%8K")?8:-1;if(0<=l){b=!1;0>a&&(a=Math.abs(a),b=!0);e="";1E3>a?h=a.toFixed(g):1E6>a?(0<l&&(g=3),h=(a/1E3).toFixed(g),e="K"):1E9>a?(0<l&&(g=3),h=(a/1E6).toFixed(g),e="M"):1E12>a?(0<l&&(g=3),h=(a/1E9).toFixed(g),e="B"):(0<l&&(g=3),h=(a/1E12).toFixed(g),e="T");0==l||0==g||h.length<=l||g==g+l-h.length+1||(g=g+l-h.length+1,0>g&&(g=0),a=parseFloat(h),
h=a.toFixed(g));1==b&&(h="-"+h);if(0<g)for(g=h.length-1;0<g;g--)if("0"!=h[g]){h=h.substr(0,g+1);"."==h[h.length-1]&&(h=h.substr(0,h.length-1));break}return h+e}l=0<=n.indexOf("%W")?0:0<=n.indexOf("%0W")?0:0<=n.indexOf("%1W")?1:0<=n.indexOf("%2W")?2:0<=n.indexOf("%3W")?3:0<=n.indexOf("%4W")?4:0<=n.indexOf("%5W")?5:0<=n.indexOf("%6W")?6:0<=n.indexOf("%7W")?7:0<=n.indexOf("%8W")?8:-1;if("string"==typeof a)return"-";if(0<=l)return b=!1,0>a&&(a=Math.abs(a),b=!0),e="",1E4>a?h=a.toFixed(g):1E8>a?(0<l&&(g=
3),h=(a/1E4).toFixed(g),e="\u4e07"):1E12>a?(0<l&&(g=3),h=(a/1E8).toFixed(g),e="\u4ebf"):(0<l&&(g=3),h=(a/1E12).toFixed(g),e="\u4e07\u4ebf"),0==l||0==g||h.length<=l||g==g+l-h.length+1||(g=g+l-h.length+1,0>g&&(g=0),a=parseFloat(h),h=a.toFixed(g)),1==b&&(h="-"+h),h+e}if(void 0!=b)if("f"==b[0]||"x"==b[0])null!=f&&0<(f>>5&7)&&(g=(f>>5&7)-1),void 0!=e&&0<=e.indexOf("%+")&&0<=a?h="+"+a.toFixed(g):"number"==typeof a&&(h=a.toFixed(g)),void 0!=e&&0<=e.indexOf("%%")&&(h+="%");else if("i"==b[0]){if(void 0!=e&&
0<=e.indexOf("%+")&&0<=a)return"+"+a}else{if("d"==b)return a=""+a,a.slice(0,4)+"/"+a.slice(4,6)+"/"+a.slice(6,8);if("th"==b||"tm"==b||"ts"==b||"tms"==b||"dd"==b||"dm"==b||"dq"==b||"dy"==b){if("string"==typeof a)return a;f=!1;g=new Date;29991231>a&&("dd"==b||"dm"==b||"dq"==b||"dy"==b)?(g.setFullYear(parseInt(a/1E4),parseInt(a/100%100)-1,parseInt(a%100)),f=!0):g.setTime(a);0==f&&xGlobal.utcTime?(a=g.getUTCFullYear()+"/"+GDataTool.getValidDateTime(g.getUTCMonth()+1)+"/"+GDataTool.getValidDateTime(g.getUTCDate()),
h=GDataTool.getValidDateTime(g.getUTCHours())+":"+GDataTool.getValidDateTime(g.getUTCMinutes())+":"+GDataTool.getValidDateTime(g.getUTCSeconds())):(a=g.getFullYear()+"/"+GDataTool.getValidDateTime(g.getMonth()+1)+"/"+GDataTool.getValidDateTime(g.getDate()),h=GDataTool.getValidDateTime(g.getHours())+":"+GDataTool.getValidDateTime(g.getMinutes())+":"+GDataTool.getValidDateTime(g.getSeconds()));e?(h=e,0==f&&xGlobal.utcTime?(h=h.replace("YYYY",g.getUTCFullYear()),h=h.replace("YY",GDataTool.getValidDateTime(g.getUTCFullYear()%
100)),h=h.replace("MM",GDataTool.getValidDateTime(g.getUTCMonth()+1)),h=h.replace("DD",GDataTool.getValidDateTime(g.getUTCDate())),h=h.replace("HH",GDataTool.getValidDateTime(g.getUTCHours())),h=h.replace("mm",GDataTool.getValidDateTime(g.getUTCMinutes())),h=h.replace("SS",GDataTool.getValidDateTime(g.getUTCSeconds())),h=h.replace("WEEK",xGlobal.weekString_local[g.getUTCDay()])):(h=h.replace("YYYY",g.getFullYear()),h=h.replace("YY",GDataTool.getValidDateTime(g.getUTCFullYear()%100)),h=h.replace("MM",
GDataTool.getValidDateTime(g.getMonth()+1)),h=h.replace("WEEK",xGlobal.weekString_local[g.getUTCDay()]),0==f?(h=h.replace("DD",GDataTool.getValidDateTime(g.getDate())),h=h.replace("HH",GDataTool.getValidDateTime(g.getHours())),h=h.replace("mm",GDataTool.getValidDateTime(g.getMinutes())),h=h.replace("SS",GDataTool.getValidDateTime(g.getSeconds()))):(h=h.replace("DD,",GDataTool.getValidDateTime(g.getDate())),h=h.replace("DD",GDataTool.getValidDateTime(g.getDate())),h=h.replace("HH:",""),h=h.replace("mm:",
""),h=h.replace("SS",""),h=h.replace("HH",""),h=h.replace("mm","")))):h=f?a:a+", "+h;return h}if("ti"==b)for(h="",l=0;l<a.length;l++)e=new Date,e.setTime(a[l][0]),g=new Date,g.setTime(a[l][1]),h+="["+GDataTool.getValidDateTime(e.getHours())+":"+GDataTool.getValidDateTime(e.getMinutes())+","+GDataTool.getValidDateTime(g.getHours())+":"+GDataTool.getValidDateTime(g.getMinutes())+"] "}return h};GDataTool.isTextType=function(a){return null==a||"c"==a||"t"==a||"t"==a[0]&&"1"<=a[1]&&"9">=a[1]?!0:!1};
GDataTool.getValidDateTime=function(a){return 10>a?"0"+a:""+a};GDataTool.GETGFLAG_ISARROW_EQ=function(a){return 0==(a&3)?!0:!1};GDataTool.GETGFLAG_ISARROW_UP=function(a){return 1==(a&3)?!0:!1};GDataTool.GETGFLAG_ISARROW_DN=function(a){return 2==(a&3)?!0:!1};GDataTool.GETGFLAG_ISINVALID=function(a){return 3==(a&3)?!0:!1};GDataTool.GETGFLAG_COLOR=function(a){return a>>2&3};GDataTool.GETGFLAG_DEC=function(a){return a>>5&7?(a>>5&7)-1:-1};
GDataTool.GET_UP_DOWN_FLAGS=function(a){if(1==GDataTool.GETGFLAG_ISARROW_EQ(a))return 0;if(1==GDataTool.GETGFLAG_ISARROW_UP(a))return 1;if(1==GDataTool.GETGFLAG_ISARROW_DN(a))return 2};var xGlobal={};function GRequestManager(){this.requestList={}}GRequestManager.sharedInstance=function(){null==this.instance&&(this.instance=new GRequestManager);return this.instance};GRequestManager.requestList=GRequestManager.sharedInstance().requestList;GRequestManager.addItems=function(a){GRequestManager.requestList[a.id]=a};GRequestManager.getAllRequestItems=function(){return GRequestManager.requestList};GRequestManager.getItemsWithId=function(a){return GRequestManager.requestList[a]};
GRequestManager.deleteItemsWithId=function(a){var b=GRequestManager.requestList[a];b&&b.stop&&b.stop();return delete GRequestManager.requestList[a]};function GANetwork(){}GANetwork.send=function(a,b){b=void 0===b?null:b;(b=GWsManagers.sharedInstance().getWsWithType(null==b?"quote":b))?b.send(a):GSDKLog.error("ws\u672a\u521d\u59cb\u5316")};GANetwork.sendHttp=function(a,b){var e=GANetwork.getAHttpRequest();e.setUrl(GSession.sharedInstance().getHttpUrl()+a);e.setBody(b);e.send().then(function(f){GDataManager.sharedInstance().receiveHTTPData(f)}).catch(function(f){console.log(f);GSDKLog.log(f)})};GANetwork.getHttpRequest=function(){return new GHttp};
GANetwork.getAHttpRequest=function(){return new function(){var a=this;GHttp.call(this);this.send=function(){return new Promise(function(b,e){var f=getEnvInfo();if("web"==f){f=new webHttpRequest;f.onSuccess=function(p){"Array"!=p.constructor.name&&(p=[p]);if(1!=p[0].status){var c=new GMessage;c.message=p[0].msg;c.code=500;p=Error(JSON.stringify(c));e(p)}else b(p)};f.onFail=function(p){p="\u8fde\u63a5\u670d\u52a1\u5931\u8d25[\u8fd4\u56de\u7801:"+p.status+"],\u8bf7\u4e0e\u5ba2\u670d\u4eba\u5458\u8054\u7cfb.";
var c=new GMessage;c.message=p;c.code=500;p=Error(JSON.stringify(c));e(p)};a.setType("post");a.setHeader("Content-Type","application/json");var h=GTenant.sharedInstance().getUserData();h&&h.access_token&&a.setHeader("Authorization","Bearer "+h.access_token);h=a.getUrl();var g=a.getType(),l=a.getHeader(),v=a.getBody(),n=a.getParam();f.send(h,g,l,v,n)}else"node"==f&&GSDKlog.info("\u8fd4\u56denode Http\u5bf9\u8c61")})}}};function GEncoded(){this.byteToString=function(a){if("string"===typeof a)return a;for(var b="",e=0;e<a.length;e++){var f=a[e].toString(2),h=f.match(/^1+?(?=0)/);if(h&&8==f.length){f=h[0].length;h=a[e].toString(2).slice(7-f);for(var g=1;g<f;g++)h+=a[g+e].toString(2).slice(2);b+=String.fromCharCode(parseInt(h,2));e+=f-1}else b+=String.fromCharCode(a[e])}return b}}GEncoded.sharedInstance=function(){null==this.instance&&(this.instance=new GEncoded);return this.instance};
function xEnDecoder(a){var b=this;_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";_varStr="ABuvwxyz_456CDEFG$123HIJKLMWXYZabcdefgNOPQRSTUVhijklmnopqrst7890";if(a){a+="";for(var e=0,f=0;f<a.length;f++)e+=a.charCodeAt(f)+f;for(a=0;2>a;a++){var h=3.141592653589793;for(f=0;8>f;f++){h*=h;var g=(e*h+"").split(".");g=(g[0]+g[1]).substr(0,16);g=parseInt(g);for(var l=0;8>l;l++){var v=g%100;v%=_keyStr.length;g=parseInt(g/100);var n=g%100;g=parseInt(g/100);if(0<v&&v<_keyStr.length-
1)if(v+n>=_keyStr.length){n=_keyStr.length-v;var p=_keyStr.substr(0,v),c=_keyStr.substr(v,n);_keyStr=c+p}else p=_keyStr.substr(0,v),c=_keyStr.substr(v,n),v=_keyStr.substr(v+n),_keyStr=c+p+v}}}}this.encode=function(x){var d="",t=0;for(x=_utf8_encode(x);t<x.length;){var q=x.charCodeAt(t++);var D=x.charCodeAt(t++);var A=x.charCodeAt(t++);var G=q>>2;q=(q&3)<<4|D>>4;var B=(D&15)<<2|A>>6;var I=A&63;isNaN(D)?B=I=64:isNaN(A)&&(I=64);d=d+_keyStr.charAt(G)+_keyStr.charAt(q)+_keyStr.charAt(B)+_keyStr.charAt(I)}return d};
this.decode=function(x){var d="",t=0;for(x=x.replace(/[^A-Za-z0-9\+\/=]/g,"");t<x.length;){var q=_keyStr.indexOf(x.charAt(t++));var D=_keyStr.indexOf(x.charAt(t++));var A=_keyStr.indexOf(x.charAt(t++));var G=_keyStr.indexOf(x.charAt(t++));q=q<<2|D>>4;D=(D&15)<<4|A>>2;var B=(A&3)<<6|G;d+=String.fromCharCode(q);64!=A&&(d+=String.fromCharCode(D));64!=G&&(d+=String.fromCharCode(B))}return d=_utf8_decode(d)};_utf8_encode=function(x){x=x.replace(/\r\n/g,"\n");for(var d="",t=0;t<x.length;t++){var q=x.charCodeAt(t);
128>q?d+=String.fromCharCode(q):(127<q&&2048>q?d+=String.fromCharCode(q>>6|192):(d+=String.fromCharCode(q>>12|224),d+=String.fromCharCode(q>>6&63|128)),d+=String.fromCharCode(q&63|128))}return d};_utf8_decode=function(x){var d="",t=0;for(c1=c2=0;t<x.length;){var q=x.charCodeAt(t);128>q?(d+=String.fromCharCode(q),t++):191<q&&224>q?(c2=x.charCodeAt(t+1),d+=String.fromCharCode((q&31)<<6|c2&63),t+=2):(c2=x.charCodeAt(t+1),c3=x.charCodeAt(t+2),isNaN(c3)||(d+=String.fromCharCode((q&15)<<12|(c2&63)<<6|c3&
63)),t+=3)}return d};var w=function(x,d,t){"("==t?t=")":"["==t&&(t="]");for(d++;d<x.length;d++)if("("==x[d]||"["==x[d]){if(d=w(x,d,x[d]),null==d)break}else if(x[d]==t)return d},z=function(x,d,t){for(d++;d<x.length;d++)if(x[d]==t)return d},y=function(x,d){a:{for(;d<x.length&&(" "==x[d]||"\t"!=x[d]);)break a;d=void 0}var t;for(t=d;d<x.length;d++)if("["==x[d])d=w(x,d,x[d]);else if(" "==x[d]||"\t"==x[d]||"\n"==x[d]||";"==x[d]||","==x[d]||"?"==x[d]||":"==x[d]||"{"==x[d]||"("==x[d]||'"'==x[d]||"'"==x[d])return{i:d,
word:x.substr(t,d-t)};return{i:d,word:x.substr(t)}},m=function(){var x=parseInt(64*Math.random())%16;10>x&&(x=10);for(var d="",t=0;t<x;t++){var q=parseInt(100*Math.random())%54;d+=_varStr[q]}return"0"<=d[0]&&"9">=d[0]?m():d},u=function(x){for(var d="",t=0,q=0;q<x.length;q++)if("("==x[q]||"["==x[q]){d+=x.substr(t,q-t+1);t=q;q=w(x,q,x[q]);if(null==q)return;t=u(x.substr(t+1,q-t-1));d+=t.code;t=q}else if('"'==x[q]||"'"==x[q]){var D=x[q],A="";d+=x.substr(t,q-t+1);for(q++;q<x.length;q++){if(x[q]==D){t=
q;d+=A;break}A+="\\x"+x.charCodeAt(q).toString(16)}}q>t&&(d+=x.substr(t,q-t));return{i:q,code:d}};this.obfuscateJsCode=function(x){for(var d="",t=0,q,D=[],A=0;A<x.length;A++)if("("==x[A]||"["==x[A]){if(A=w(x,A,x[A]),null==A)return}else if('"'==x[A]||"'"==x[A]){if(A=z(x,A,x[A]),null==A)return}else if("/"!=x[A]||"/"!=x[A+1]&&"*"!=x[A+1])if("\n"==x[A]||" "==x[A]||"\t"==x[A])d+=x.substr(t,A-t),t=A+1;else{q=y(x,A);if(null==q)return;A=q.i;if("var"==q.word){A++;q=y(x,A);if(null==q)return;D.push({word:q.word,
name:m()});A=q.i}("a"<=q.word[0]&&"z">=q.word[0]||"A"<=q.word[0]&&"Z">=q.word[0])&&"("==x[A]&&(t=b.encode(q.word),d+=t,t=A)}else if(q=A,"/"==x[A+1])for(A+=2;A<x.length;A++){if("\n"==x[A]){d+=x.substr(t,q-t);t=A+2;break}}else for(A+=2;A<x.length;A++)if("*"==x[A]&&"/"==x[A+1]){d+=x.substr(t,q-t);t=A+2;break}A>t&&(d+=x.substr(t,A-t));for(A=0;A<D.length;A++)q="newCode = newCode.replace(/(\\b"+D[A].word+"\\b)/g,'"+D[A].name+"')",eval(q);if(d=u(d))return d.code}};function GHttp(){var a,b,e,f,h;this.setUrl=function(g){a=g};this.getUrl=function(){return a};this.setHeader=function(g,l){null==b&&(b={});b[g]=l};this.getHeader=function(){return b};this.setType=function(g){e=g};this.getType=function(){return e};this.setParam=function(g,l){null==f&&(f={});f[g]=l};this.getParam=function(){return f};this.setBody=function(g){h=g};this.getBody=function(){return h};this.send=function(){return new Promise(function(g,l){var v=getEnvInfo();"web"==v?(v=new webHttpRequest,
v.onSuccess=function(n){g(n)},v.onFail=function(n){l(n)},v.send(a,e,b,h,f)):"node"==v&&console.error("\u8fd4\u56denode Http\u5bf9\u8c61")})}}
function webHttpRequest(){var a=this;this.onSuccess;this.onFail;this.send=function(b,e,f,h,g){var l=new XMLHttpRequest;l.open(e,b);for(var v in f)null!=f[v]&&l.setRequestHeader(v,f[v]);b="";if(null!=h)b=h;else if(null!=g)if(e=e.toLowerCase(),"post"==e)b=JSON.stringify(g);else if("get"==e){e=0;for(var n in g)h=g[n],b=0==e?"?"+n+"="+h:b+("&"+n+"="+h),e++}l.send(b);GSDKLog.log("http\u53d1\u9001\u6570\u636e:"+b);l.onreadystatechange=function(){if(4==l.readyState)if(200==l.status){if(void 0!=l.responseText){var p=
l.responseText;p&&(p=JSON.parse(p),null!=a.onSuccess&&(a.onSuccess(p),GSDKLog.log("http\u63a5\u6536\u6570\u636e"+JSON.stringify(p))))}}else if(p={status:l.status},null!=a.onFail)a.onFail(p)}}};function GWsManagers(){var a={};this.addConnect=function(b,e){a[b]=e};this.getWsWithType=function(b){if(null!=a[b])return a[b]};this.getAllConnect=function(){return a};this.delWsWithType=function(b){null!=a[b]&&delete a[b]}}GWsManagers.sharedInstance=function(){null==this.instance&&(this.instance=new GWsManagers);return this.instance};function GWebsocket(){var a,b,e,f,h,g,l,v;this.setUrl=function(n){a=n};this.setType=function(n){};this.setProtocol=function(n){b=n};this.set_onOpen=function(n){f=n};this.set_onMessage=function(n){h=n};this.set_onClose=function(n){g=n};this.set_onError=function(n){l=n};this.setParams=function(n,p){null==e&&(e={});e[n]=p};this.send=function(n){v.readyState==v.OPEN?v.send(n):GSDKLog.log("ws\u672a\u8fde\u63a5")};this.close=function(n,p){v.close(n,p)};this.connect=function(){var n=getEnvInfo();if("web"==
n){v=new WebSocket(a,b);v.binaryType="arraybuffer";if(null!=e)for(var p in e)v[p]=e[p];v.onclose=g;v.onerror=l;v.onmessage=h;v.onopen=f}else"node"==n&&GSDKLog.error("\u8fd4\u56denode Http\u5bf9\u8c61")}};function GQuoteWs(){var a=this,b=this,e=null,f=null,h,g,l,v=0;this.quoteLogin=function(n,p,c,w,z){h=p;g=c;l=w;p=new GWebsocket;p.setParams("binaryType","arraybuffer");p.setUrl(n);p.setType("quote");p.setProtocol("gangtise");p.set_onOpen(a.onopen);p.set_onMessage(a.onmessage);p.set_onClose(a.onclose);p.set_onError(a.onerror);p.connect();e=z;GWsManagers.sharedInstance().addConnect("quote",p);b.webService=p};this.quoteLoginOut=function(n){b.webService.close(3999,"\u7528\u6237\u4e3b\u52a8\u9000\u51fa");
f=n};this.onopen=function(n){console.log("\u884c\u60c5\u8fde\u63a5\u5df2\u5f00\u542f");v=0;n=JSON.stringify({type:"login",gid:{pg:"1",idx:"-1"},account:h,userid:g,token:l});b.webService.send(n)};this.onmessage=function(n){var p=[];"{"==n.data[0]||"["==n.data[0]?n=n.data:(p=p.concat(Array.from(new Uint8Array(n.data))),n=29>p[0]?(new xGtsJason(json_dictionary)).decompress_json(p):GEncoded.sharedInstance().byteToString(p));console.log(n);results="["==n[0]?JSON.parse(n):[JSON.parse(n)];"login"==results[0].type?
e(!0):"close"==results[0].type?GSDKLog.log("\u5373\u5c06\u5173\u95ed",n):GDataManager.sharedInstance().receiveWSData("quote",results)};this.onclose=function(n){3999==n.code?f(!0):(console.log("onClose",n),n={code:n.code,message:n.reason},GSession.sharedInstance().quoteClose(n))};this.onerror=function(n){console.log("onError",n)};this.reload=function(){v++;GSession.sharedInstance().pushMsg("\u5f53\u524d\u6b63\u5728\u91cd\u8fde\uff0c\u91cd\u8fde\u7b2c"+v+"\u6b21",1002)}}
GQuoteWs.sharedInstance=function(){null==this.instance&&(this.instance=new GQuoteWs);return this.instance};function GService(){}GService.Path={tenantLogin:"thirdparty/login/tenantLogin",refreshToken:"auth/oauth/token?grant_type=refresh_token&refresh_token=",tenantLoginOut:"auth/oauth/logout"};
GService.tenantLoginApi=function(a){return new Promise(function(b,e){var f=GANetwork.getAHttpRequest();f.setUrl(GSession.sharedInstance().getHttpUrl()+GService.Path.tenantLogin);f.setBody(a);f.send().then(function(h){h=getTableForMap(h[0].result[0].table);var g={},l;for(l in h)g[l]=h[l].value;b(g)}).catch(function(h){console.log(h);e(h)})})};GService.tenantLoginOutApi=function(a,b){return new Promise(function(e,f){e({msg:"\u64cd\u4f5c\u6210\u529f\uff01",status:!0})})};
GService.refreshTokenApi=function(a,b){return new Promise(function(e,f){var h=GANetwork.getHttpRequest();h.setUrl(GSession.sharedInstance().getHttpUrl()+GService.Path.refreshToken+b);h.setType("post");h.setHeader("Content-Type","application/x-www-form-urlencoded");h.setHeader("Authorization","Basic "+a);h.send().then(function(g){if(void 0!=g.access_token)e(g);else{var l=new GMessage;l.message="Token\u5237\u65b0  "+g.msg;l.code=501;g=Error(JSON.stringify(l));f(g)}}).catch(function(g){console.log(g);
g="Token\u5237\u65b0, \u8fde\u63a5\u670d\u52a1\u5931\u8d25[\u8fd4\u56de\u7801:"+g.status+"],\u8bf7\u4e0e\u5ba2\u670d\u4eba\u5458\u8054\u7cfb.";var l=new GMessage;l.message=g;l.code=500;g=Error(JSON.stringify(l));f(g)})})};function GSession(){var a=this,b,e,f=function(){GTenant.sharedInstance().getToken().then(function(l){l=GTenant.sharedInstance().getUserData();h(l)}).catch(function(l){a.pushJsonMsg(l)})},h=function(l){var v=GSession.sharedInstance().getWSUrl(),n=l.tenantcode+"_"+l.userid,p=l.userid;l=l.access_token;GQuoteWs.sharedInstance().quoteLogin(v,n,p,l,function(c){var w=new GMessage;1==c?(w.message="\u767b\u5f55\u6210\u529f,\u884c\u60c5\u5df2\u5f00\u542f",w.code=2001):(w.message="\u884c\u60c5\u767b\u5f55\u5931\u8d25",
w.code=5001);GSDKLog.log("\u884c\u60c5\u767b\u5f55\u6210\u529f");a.pushNotification(w)})},g=function(l){b="ws://"+l+":9100/websocket";e="http://"+l+":9000/"};this.pushNotification=function(l){if(null!=GSDK.onNotification)GSDK.onNotification(l)};this.pushJsonMsg=function(l){try{var v=JSON.parse(l);a.pushMsg(v.message,v.code)}catch(n){console.log("errorJson\u4e0d\u662f\u4e00\u4e2aJson\u5bf9\u8c61")}};this.pushMsg=function(l,v){var n=new GMessage;n.message=l;n.code=v;a.pushNotification(n)};this.login=
function(l){GSDKLog.log("\u5f00\u59cb\u6267\u884c\u767b\u5f55\u6d41\u7a0b");null!=l.url?(GSDKLog.log("\u8bbe\u7f6e\u79df\u6237Url"),g(l.url),GSDKLog.log("\u5f00\u59cb\u6267\u884c\u79df\u6237\u767b\u5f55"),GTenant.sharedInstance().login(l).then(function(v){GSDKLog.log("\u79df\u6237\u767b\u5f55\u6210\u529f");return v}).then(function(v){GSDKLog.log("\u5f00\u59cb\u6267\u884c\u884c\u60c5\u767b\u5f55");h(v)}).catch(function(v){GSDKLog.log(v);a.pushJsonMsg(v.message)})):(l=new GMessage,l.message="\u672a\u8bbe\u7f6e\u79df\u6237url",
l.code=500,a.pushJsonMsg(JSON.stringify(l)))};this.loginOut=function(){GTenant.sharedInstance().loginOut().then(function(l){l;console.log(getNowSaftTime()+"    \u79df\u6237\u767b\u51fa\u6210\u529f!",l);return l}).then(function(l){a.clearUrl();GQuoteWs.sharedInstance().quoteLoginOut(function(v){var n=new GMessage;1==v?(n.message="\u767b\u51fa\u6210\u529f\uff0c\u884c\u60c5\u5df2\u65ad\u5f00",n.code=2002):(n.message="\u884c\u60c5\u767b\u51fa\u5931\u8d25",n.code=5002);a.pushNotification(n)})}).catch(function(l){console.log(l);
a.pushJsonMsg(l.message)})};this.quoteClose=function(l){a.pushMsg("\u884c\u60c5\u670d\u52a1\u5f02\u5e38\u65ad\u5f00",2003);console.log("\u884c\u60c5\u8fde\u63a5\u65ad\u5f00",l);f()};this.setProxyApi=function(){};this.getWSUrl=function(){return b};this.getHttpUrl=function(){return e};this.clearUrl=function(){e=b=null}}GSession.sharedInstance=function(){null==this.instance&&(this.instance=new GSession);return this.instance};var GSDK_HOOK=function(){};
GSDK_HOOK.start=function(){GSDK_HOOK.setOnNotification();GSDK_HOOK.setOnCallback();GSDK_HOOK.setOnRealLog()};GSDK_HOOK.setOnNotification=function(){"undefined"!=typeof sdk_cpp_notification?GSDK_HOOK.onNotification=sdk_cpp_notification:"undefined"!=typeof sdk_java_notification?GSDK_HOOK.onNotification=sdk_java_notification:"undefined"!=typeof sdk_oc_notification&&(GSDK_HOOK.onNotification=sdk_oc_notification);GSDK.onNotification=GSDK_HOOK.onNotification};
GSDK_HOOK.setOnRealLog=function(){"undefined"!=typeof sdk_cpp_log?GSDK_HOOK.onRealLog=sdk_cpp_log:"undefined"!=typeof sdk_java_log?GSDK_HOOK.onRealLog=sdk_java_log:"undefined"!=typeof sdk_oc_log&&(GSDK_HOOK.onRealLog=sdk_oc_log);GSDK.onRealLog=GSDK_HOOK.onRealLog};
GSDK_HOOK.setOnCallback=function(){"undefined"!=typeof sdk_cpp_callback?GSDK_HOOK.onCallback=sdk_cpp_callback:"undefined"!=typeof sdk_java_callback?GSDK_HOOK.onCallback=sdk_java_callback:"undefined"!=typeof sdk_oc_callback&&(GSDK_HOOK.onCallback=sdk_oc_callback)};GSDK_HOOK.getOnCallback=function(){return GSDK_HOOK.onCallback};GSDK_HOOK.getOnNotification=function(){return GSDK_HOOK.onNotification};GSDK_HOOK.getOnRealLog=function(){return GSDK_HOOK.onRealLog};function GTenant(){var a=this,b,e,f="R1RTX1RoaXJkX1BhcnR5Omdhbmd0aXNl",h,g=function(l){h=(new Date).getTime()+1E3*(parseInt(l.expires_in)-600);b=l};this.login=function(l){var v,n,p,c,w,z,y;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){if(1==m.nextAddress){v=[];for(n in l)if(null!=l[n])switch(p=n.toLowerCase(),p){case "url":break;case "basic":f=l[n];break;default:v.push(n+" = '"+l[n]+"'")}c="";for(w=0;w<v.length;w++)c=0==w?v[w]:c+(" and "+v[w]);c=GAnalysisES(c);z=[{lang:"zh-cn",gid:{fm:"tenant"},
http:[{gid:{name:"tenantCheck"},type:"query",field:"access_token token_type refresh_token expires_in tenantid deviceType clientid tenantcode user_id".split(" "),condition:c.esCondition}]}];z=JSON.stringify(z);return m.yield(GService.tenantLoginApi(z).then(function(u){g(u);e=l;a.resetRefreshTokenTimer(u);GSDKLog.log("\u767b\u5f55\u6210\u529f\uff1a"+JSON.stringify(u));return u}).catch(function(u){GSDKLog.error("\u767b\u5f55\u5931\u8d25\uff1a"+u.message);throw Error(u.message);}),2)}y=m.yieldResult;
return m.return(y)})};this.loginOut=function(l){var v;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return n.yield(GService.tenantLoginOutApi().then(function(p){a.clearUserData();a.clearTimer();return p}).catch(function(p){console.log(p);throw Error(p.message);}),2);v=n.yieldResult;return n.return(v)})};this.getUserData=function(){return b};this.getUserArguments=function(){return e};this.getBasic=function(){return f};this.getToken=function(){return new Promise(function(l,
v){var n=(new Date).getTime(),p=b.access_token;n<h?l(p):(n=b.refresh_token,GService.refreshTokenApi(a.getBasic(),n).then(function(c){console.log(getNowSaftTime()+"    \u5237\u65b0Token\u6210\u529f!");g(c);a.resetRefreshTokenTimer(c);l(c.access_token)}).catch(function(c){console.log(c);a.login(e).then(function(w){l(w.access_token)}).catch(function(w){console.log(w);v(w.message)})}))})};this.refreshToken=function(l){l=l.refresh_token;GService.refreshTokenApi(a.getBasic(),l).then(function(v){console.log(getNowSaftTime()+
"    \u5237\u65b0Token\u6210\u529f!");g(v);a.resetRefreshTokenTimer(v)}).catch(function(v){console.log(v);GSession.sharedInstance().pushJsonMsg(v.message)})};this.resetRefreshTokenTimer=function(l){var v=l.expires_in-600,n=getEnvInfo();a.clearTimer();"web"==n?a.refreshTokenTimer=window.setTimeout(function(p){a.refreshToken(p)},1E3*v,l):"node"==n&&(a.refreshTokenTimer=setTimeout(function(p){a.refreshToken(p)},1E3*v,l))};this.clearTimer=function(){var l=getEnvInfo();"web"==l?null!=a.refreshTokenTimer&&
window.clearTimeout(a.refreshTokenTimer):"node"==l&&null!=a.refreshTokenTimer&&clearTimeout(a.refreshTokenTimer)};this.clearUserData=function(){e=userData=null}}GTenant.sharedInstance=function(){null==this.instance&&(this.instance=new GTenant);return this.instance};function GAnalysisES(a,b){if(null==a||""==a)return{};var e={seq:"(=)",eq:"=",gte:">=",lte:"<=",mustNot:"!=",gt:">",lt:"<",in:" in ",order:"order"},f={must:[]},h=!0;a=a.split(" and ");for(var g=0;g<a.length;g++){var l=a[g],v;for(v in e){var n=l.indexOf(e[v]);if("eq"==v&&-1!=n){var p=l[n-1];if(">"==p||"<"==p||"!"==p||"("==p)continue}if(-1!=n){var c=l.split(e[v]);p=trim(c[0]);p=p.replace(/_A_N_D_/g,"and");p=p.toLowerCase();var w=trim(c[1]);if(b)for(n=0;n<b.length;n++)p==b[n].toLowerCase()&&(""!=w&&w&&
"''"!=w&&'""'!=w||(h=!1));if(""==w||!w||"''"==w||'""'==w)break;else if("' '"==w||'" "'==w)w="",c[1]="''";if("break"==p)break;var z=void 0;n=!0;switch(e[v]){case ">=":case "<=":case ">":case "<":z={range:{}};z.range[p]={};for(var y in f)for(var m=f[y],u=0;u<m.length;u++){var x=m[u],d;for(d in x)null!=x[d][p]&&(z.range[p]=x[d][p],n=!1)}m=!0;if(0==trim(w).indexOf('"')||0==trim(w).indexOf("'"))m=!1;m?w=parseInt(trim(c[1])):(w=trimSingle(trim(c[1])),w=trimDbSingle(w),w=w.replace(/_A_N_D_/g,"and"));z.range[p][v]=
w;break;case "=":case "(=)":n=!0;w=[];if("(=)"==e[v]){w=trimSingle(trim(c[1]));w=trimDbSingle(w);w=JSON.parse(w);c={term:{}};c.term[p]=w;z=c;break}m=!1;if("string"==typeof c[1]&&0==trim(c[1]).indexOf("[")){if("[]"==c[1]){n=!1;break}m=!0;u=trim(c[1]).slice(1,-1);u=u.split(",");for(x=0;x<u.length;x++)if('""'!=trim(u[x])&&"''"!=trim(u[x])&&""!=trim(u[x])){if(0==u[x].indexOf("D'")){if("D''"==u[x]||'D""'==u[x])continue;var t=u[x].slice(2,-1);if(8==t.length){var q=t.slice(0,4);q+="-"+t.slice(4,6);q+="-"+
t.slice(6,8);u[x]="'"+q+"'"}}t=!0;if(0==trim(u[x]).indexOf('"')||0==trim(u[x]).indexOf("'"))t=!1;t?t=parseInt(trim(u[x])):(t=trimSingle(trim(u[x])),t=trimDbSingle(t),t=t.replace(/_A_N_D_/g,"and"));w.push(t)}}if(m){if(c=[],!(0>=w.length)){for(z=0;z<w.length;z++)c.push(w[z]);z={terms:{}};z.terms[p]=c}}else{if(0==c[1].indexOf("D'")){if("D''"==c[1]||'D""'==c[1])continue;z=c[1].slice(2,-1);8==z.length&&(w=z.slice(0,4),w+="-"+z.slice(4,6),w+="-"+z.slice(6,8),c[1]="'"+w+"'")}z=!0;if(0==trim(c[1]).indexOf('"')||
0==trim(c[1]).indexOf("'"))z=!1;if(z)w=parseInt(trim(c[1]));else{w=trimSingle(trim(c[1]));w=trimDbSingle(w);if(2<c.length)for(z=2;z<c.length;z++)m=trimSingle(trim(c[z])),m=trimDbSingle(m),w+="="+m;w=w.replace(/_A_N_D_/g,"and")}c={term:{}};c.term[p]=w;z=c}break;case " in ":n=!0;w.startsWith("(")&&w.endsWith(")")&&(w=w.slice(1,-1));z=w.split(",");c=[];for(w=0;w<z.length;w++)z[w]=z[w].replace(/'/g,""),c.push(z[w]);z={terms:{}};z.terms[p]=c;break;case "order":f.sort||(f.sort={});f.sort[p]={order:w};break;
case "!=":for(n=!1,f.must_not||(f.must_not=[]),p=analysisES(""==w?p+"=' '":p+"="+w).esCondition,c=0;c<p.must.length;c++)f.must_not[c]=p.must[c]}if(null!=z&&1==n){f.must.push(z);break}else if(0==n)break}}}return{esCondition:f,mustCheckStatu:h}};function ASTNode(){this.locModel={type:"",value:"",locIndex:null,loc:{start:{line:null,indexes:null},end:{line:null,indexes:null}}};this.astNode={type:"",id:"",params:[],body:[],parent:null}}
function ASTEnum(){this.keywordEnum={select:0,selecttree:1,"delete":2,from:3,and:4,or:5,at:6,"in":7,where:8,relation:9,include:10,sub:11,resample:12,"order by":13};this.punctuatorEnum={"(":0,")":1,",":2,"=":"eq",">":"gt",">=":"gte","<":"lt","<=":"lte","<>":"neq","!=":"neq","!":10,"/":11,"'":12,'"':13};this.charEnum={KEY_WORD:"Keyword",IDENTIFIER:"Identifier",PUNCTUATOR:"Punctuator",NUMERIC:"Numeric",STRING:"String",BOOLEAN:"Boolean"}}
ASTEnum.shareInstance=function(){this.instance||(this.instance=new ASTEnum);return this.instance};function GSQLModel(){this.field=[];this.keys=[];this.where=[];this.limit=[];this.orderby={};this.relations=[];this.resample={};this.expand=[];this._and=[];this.and={_and:this._and};this.model={type:"",field:this.field,table:""};this.codegenState={in:!1,where:!1,relation:!1,resample:!1,resampleStrObj:!1,resampleCount:0,brackets:!1,bracketsCount:0}}
function GScriptAST(){this.lineModel={line:null,indent:null,sliceStart:null,sliceEnd:null};this.punctuatorEnum=ASTEnum.shareInstance().punctuatorEnum;this.keywordEnum=ASTEnum.shareInstance().keywordEnum;this.charEnum=ASTEnum.shareInstance().charEnum;var a=new ASTNode;this.tokensLocNode=a.locModel;this.astNode=a.astNode;this.debug=!1;this.parse=function(b){var e={program:{},tokens:[],lines:[]};b=b.split("\n");for(var f=0;f<b.length;f++){var h=b[f],g=null,l=null,v=this.deCopy(this.lineModel);v.line=
h;v.indent=f;for(var n=0;n<h.length;n++)" "!==h[n]&&(null===g&&(g=n),l=n+1);v.sliceStart=g;v.sliceEnd=l;e.lines.push(v)}b=[];for(f=0;f<e.lines.length;f++){h=e.lines[f];g=h.line.substring(h.sliceStart,h.sliceEnd);l=0;v=-1;n=!1;for(var p=0;p<=g.length;p++){var c=g[p];switch(c){case " ":if(-1===v&&0==n)v=0;else break;this.addData(b,this.createLocNode(f,g,b.length,[l,p]));l=p;if(2<b.length){var w=b[b.length-2];c=b[b.length-1];null!=this.keywordEnum[(w.value+" "+c.value).toLowerCase()]&&(w=w.loc.start.indexes,
c=c.loc.end.indexes,b.splice(b.length-2,2),this.addData(b,this.createLocNode(f,g,b.length,[w,c])))}break;case "'":case '"':0===v?(l=p,v=-1,n=!0):-1===v&&1==n&&(n=!1,v=0,this.addData(b,this.createLocNode(f,g,b.length,[l,p+1])),l=p+2);break;case "/":case ",":case ")":case "(":case "=":v=0;" "!==g[p-1]&&!0!==this.isPunctuator(g[p-1])&&this.addData(b,this.createLocNode(f,g,b.length,[l,p]));this.addData(b,this.createLocNode(f,g,b.length,[p]));l=p;break;case "!":case "<":case ">":if(null==g[p+1]){this.errorMsg(h.indent,
g,p,g[p]+" \u7b26\u53f7\u8bed\u6cd5\u9519\u8bef");return}if(">"===g[p+1]||"="===g[p+1]){v=0;" "!==g[p-1]&&this.addData(b,this.createLocNode(f,g,b.length,[l,p]));this.addData(b,this.createLocNode(f,g,b.length,[p,p+2]));l=p++;break}v=0;" "!==g[p-1]&&this.addData(b,this.createLocNode(f,g,b.length,[l,p]));this.addData(b,this.createLocNode(f,g,b.length,[p]));l=p;break;default:0===v?(l=p,v=-1):null==c&&-1===v&&(v=0,this.addData(b,this.createLocNode(f,g,b.length,[l,p])),l=p)}}}e.tokens=b;b=this.createASTProgram(e.tokens);
e.program=b;return e};this.isPunctuator=function(b){return"undefined"!==typeof this.punctuatorEnum[b]?!0:!1};this.errorMsg=function(b,e,f,h){console.error("AST\u89e3\u6790\u5931\u8d25\uff1a\n        errorLine:\u7b2c"+b+"\u884c,\n        errorSQL:'"+e+"',\n        errorPos:\u4e0b\u6807"+f+",\n        errorMsg:'"+h+"'")};this.addData=function(b,e){b.push(e)};this.createLocNode=function(b,e,f,h){var g;if(1==h.length){e=e[h[0]];var l=g=h[0]}else e=e.substring(h[0],h[1]),l=h[0],g=h[1];h=this.deCopy(this.tokensLocNode);
h.locIndex=f;h.value=e;h.loc.start.line=b;h.loc.start.indexes=l;h.loc.end.line=b;h.loc.end.indexes=g;b=this.scannerValueType(e);h.type=b;return h};this.scannerValueType=function(b){return isNaN(Number(b))?null!=this.keywordEnum[b.toLowerCase()]?this.charEnum.KEY_WORD:null!=this.punctuatorEnum[b]?this.charEnum.PUNCTUATOR:"'"===b[0]||'"'===b[0]||"'"===b[b.length-1]||'"'===b[b.length-1]?this.charEnum.STRING:this.charEnum.IDENTIFIER:this.charEnum.NUMERIC};this.createASTProgram=function(b){for(var e={error:null,
body:[],params:[],sourceType:"sql",type:"Program"},f=e,h=[],g=0;g<b.length;g++){var l=b[g],v=l.type,n=l.value,p=this.deCopy(this.astNode);switch(v){case "Keyword":switch(n.toLowerCase()){case "select":case "selecttree":case "from":case "include":case "sub":p.type=v;p.id=l;p.parent=f;f.body.push(p);f=p;break;case "in":f.id.value="in";break;case "where":p.type=v;p.id=l;p.parent=f;f.body.push(p);f=this.deCopy(this.astNode);f.id=this.deCopy(l);f.id.value="and";f.id.type="Keyword";f.id.declaration="sourcewhere";
f.type="Keyword";f.parent=p;p.body.push(f);break;case "at":case "relation":case "resample":case "order by":for(n=null;null==n;)"from"==f.id.value?n=f:"from"==f.parent.id.value?n=f.parent:f=f.parent;f=n;p.type=v;p.id=l;p.parent=f;f.body.push(p);f=p;break;case "or":case "and":"where"!==f.id.value.toLowerCase()&&(f=f.parent),p.type=v,p.id=l,p.parent=f,f.body.push(p),f=p}break;case "Identifier":p.id=l;p.type=v;p.parent=f;f.params.push(p);break;case "Punctuator":switch(n){case "(":"from"===f.id.value.toLowerCase()?
(h.push(f),f=f.params,f=0>=f.length?f:f[f.length-1]):"where"!==f.id.value.toLowerCase()?(p.id=this.deCopy(l),p.id.value="where",p.id.type="Keyword",p.id.declaration="brackets",p.type="Keyword",p.parent=f,f.body.push(p),h.push(f),f=p):h.push(f);break;case ")":l=h[h.length-1];"in"===l.id.value&&"Keyword"===l.type&&(l=l.parent);if(0<f.params.length)f.params[f.params.length-1].id.declaration="endbrackets_1";else{for(;0<f.body.length;)f=f.body[f.body.length-1];null!=f.params&&(f=f.params[f.params.length-
1],p=f.id.declaration.split("_"),p=p[0]+"_"+(parseInt(p[1])+1),f.id.declaration=p)}h.pop();f=l;break;case "=":case "<":case "<=":case ">":case ">=":case "!=":case "<>":f.id.operator=n}break;case "Numeric":case "String":p.type=v,p.id=l,p.parent=f,f.params.push(p)}}return e};this.transform=function(b){};this.codegen=function(b){};this.VLR=function(b,e,f,h,g,l,v){if(null!=g){var n=g.value;switch(n){case "select":e.model.type=n;"left"==l&&(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value),
e.field.push(b.id.value));break;case "from":"left"==l&&(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value),e.model.table=""==e.model.table?b.id.value:e.model.table+("/"+b.id.value));break;case "in":"left"==l?(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value),n={},n[b.id.value]=null,e._and.push(n)):b.id&&"brackets"==b.id.declaration&&(1==this.debug&&console.log(n+"\u62ec\u53f7\u5f00\u59cb"),f.in=!0);break;case "where":if("left"==l){if(1==v&&null!=g.operator)if(1==this.debug&&
console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+b.id.value),1==f.brackets){var p={};g=this.punctuatorEnum[g.operator];var c=this.getFormatValue(b);p[g]=c;g=e._and[e._and.length-1];1<this.codegenState.bracketsCount&&(g=this.readNestObj(g).obj);if("Array"==g.constructor.name)g=g[g.length-1];else{for(var w in g)var z=w;g=g[z];g="Object"==g.constructor.name?g:g[g.length-1]}for(var y in g)z=y;null==g[z]?g[z]=p:console.error("\u63d2\u5165\u5931\u8d25\uff1a",p)}else 1==f.resample&&this.resampleInsert(b,
e,f);else if(1!=f.relation&&1!=f.resample&&1!=f.in&&"brackets"==g.declaration&&(1==this.debug&&console.log(n+"\u62ec\u53f7\u5f00\u59cb \u7c7b\u578b\u4e3a\uff1a"+b.parent.parent.id.value),f.brackets=!0,g={},g["_"+b.parent.parent.id.value]={},1<=f.bracketsCount?(p=e._and[e._and.length-1],p=this.readNestObj(p).obj,p.push(g)):e._and.push(g),f.bracketsCount++),1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value),1==f.relation)g=this.getFormatValue(b),e.relations.push(g);else if(1==f.resample)this.resampleInsert(b,
e,f);else if(1==f.in){g=this.getFormatValue(b);p=e._and[e._and.length-1];var m;for(m in p){var u=m;null==p[m]&&(p[m]={in:[]})}p[u].in.push(g)}else if(1==f.brackets)if(g=z=e._and[e._and.length-1],1<f.bracketsCount&&(g=this.readNestObj(g).obj),p={},p[b.id.value]=null,"Array"==g.constructor.name)g.push(p);else{for(var x in g)c=x;if(null==c){z=this.readNestObj(z).parent;for(var d in z)c=d;g[c]=p}else"Object"==g[c].constructor.name?g[c]=p:g[c].push(p)}b.id&&b.id.declaration&&1==b.id.declaration.startsWith("endbrackets")&&
(g=parseInt(b.id.declaration.split("_")[1]),1==f.relation?(1==this.debug&&console.log("relation\u7ed3\u675f"),f.relation=!1):1==f.in?(1==this.debug&&console.log("in\u7ed3\u675f"),f.in=!1):1==f.resample?(1==this.debug&&console.log("resample\u7ed3\u675f"),f.resample=!1):(f.brackets=!1,f.bracketsCount-=g,1==this.debug&&console.log(n+"\u62ec\u53f7\u7ed3\u675f "+g+"\u6b21,\u5269\u4f59\u9500\u6bc1\u62ec\u53f7\uff1a"+f.bracketsCount+"\u6b21 ")))}else f.where=!0;break;case "or":case "and":if("left"==l)if(1==
v){if(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+b.id.value),1==f.where)if(1==f.brackets){p=e._and[e._and.length-1];var t;for(t in p)var q=t;"_or"==q&&"and"==n?(n=this.readNestObj(p).obj,n=n[n.length-1],n=n._and,"Object"!=n.constructor.name&&(n=n[n.length-1]),this.insertValue(n,b,g)):"_and"==q&&"or"==n?(n=this.readNestObj(p).obj,n=n[n.length-1],n=n._or,"Object"!=n.constructor.name&&(n=n[n.length-1]),this.insertValue(n,b,g)):(p=this.readNestObj(p).obj,this.insertValue("Object"==
p.constructor.name?p:p[p.length-1],b,g))}else"or"==n?(n=e._and[e._and.length-1],n="Object"==n._or.constructor.name?n._or:n._or[n._or.length-1],this.insertValue(n,b,g)):this.insertValue(e._and[e._and.length-1],b,g)}else{if(1==f.where)if(g={},g[b.id.value]=null,1==f.brackets){y=e._and[e._and.length-1];for(var D in y)p=D;z=this.readNestObj(y).obj;if("_or"==p&&"and"==n)c={},"Object"==z.constructor.name&&"Object"==z[p].constructor.name?(y=this.readNestObj(y).parent,d=z[p],y[p]=[],z=y[p],c._and=[],c._and.push(d),
c._and.push(g)):"Array"==z.constructor.name?(p=z[z.length-1],0<p["_"+n].length&&(z=p["_"+n]),c=g):c._and=g,z.push(c);else if("_and"==p&&"or"==n)p={_or:{}},p._or=g,z.push(p);else{c=0;for(var A in y)c++;1<=c&&(y[p]=[],y[p].push(z),z=y[p]);z.push(g)}}else"or"==n?(p={_or:{}},p._or=g,e._and.push(p)):e._and.push(g);1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value)}else"endbrackets"!=g.declaration&&"endbrackets"!=b.id.declaration||1!=this.debug||console.log(n+"\u62ec\u53f7\u7ed3\u675f");break;
case "at":"left"==l&&(1==v?(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a "+b.id.value),null!=e.model[n+"Last"]?(g=this.getFormatValue(b),e.model[n+"Last"]=g):null!=e.model[n+"Date"]&&(g=this.punctuatorEnum[g.operator],p=this.getFormatValue(b),e.model[n+"Date"][g]=p)):(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a "+b.id.value),"Identifier"==b.id.type&&("last"==b.id.value.toLowerCase()?e.model[n+"Last"]="":"date"==b.id.value.toLowerCase()&&(e.model[n+"Date"]={}))));break;case "relation":"left"==
l?1==v?1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+b.id.value):1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value):(1==this.debug&&console.log(n+"\u8282\u70b9->\u5b50\u8282\u70b9 "+b.id.value),f.relation=!0);break;case "resample":"left"==l?1==v?1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+b.id.value):1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value):(1==this.debug&&console.log(n+"\u8282\u70b9->\u5b50\u8282\u70b9 "+b.id.value),
f.resample=!0);case "include":"left"==l&&"flags"==b.id.value.toLowerCase()&&(e.model.includeFlags=1);break;case "sub":"left"==l&&(n=this.getFormatValue(b),e.model.subscribe=n);break;case "order by":"left"==l&&(n=this.getFormatValue(b),0==v?e.orderby.field=n:1==v&&("desc"==n.toLowerCase()?e.orderby.desc=1:"asc"==n.toLowerCase()?e.orderby.desc=-1:console.info("order by \u9519\u8bef\u8bed\u53e5\uff1a"+n,b)));break;default:"left"==l&&1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+b.id.value),null==
this.keywordEnum[n]&&b.parent&&b.parent.parent&&"from"==b.parent.parent.id.value&&(1==this.debug&&console.log("from\u8282\u70b9 - "+n+"\u503c\uff1a   "+b.id.value),e.keys.push(this.getFormatValue(b)))}}g=b.params;n=b.body;for(p=0;p<g.length;p++)this.VLR(g[p],e,f,!1,b.id,"left",p);for(g=0;g<n.length;g++)if(n[g].id.value&&"select"==n[g].id.value.toLowerCase()&&1==h){p=new GSQLModel;this.VLR(n[g],p,p.codegenState);1<p._and.length?p.model.where=p.and:1==p._and.length&&(p.model.where=p._and[0]);0<p.keys.length&&
(p.model.keys=p.keys);0<p.relations.length&&(p.model.relations=p.relations);1==this.mapIsLength(p.resample)&&(p.model.resample=p.resample);1==this.mapIsLength(p.orderby)&&(p.model.orderby=p.orderby);y=e._and[e._and.length-1];z=void 0;for(var G in y)z=G;y={};y[z]={in:p.model};e.where=y;null==e.model.where&&(e.model.where={});e.model.where=e.where;e._and.splice(e._and.length-1);e._and.push(e.where);f.in=!1}else this.VLR(n[g],e,f,!0,b.id,"right",null)};this.readNestObj=function(b){for(var e=0,f,h=0;h<
this.codegenState.bracketsCount;h++){e++;for(var g in b)1==g.startsWith("_")&&(e==this.codegenState.bracketsCount?(f=b,b=b[g]):(f=b,b=b[g][b[g].length-1]))}return{obj:b,parent:f}};this.insertValue=function(b,e,f){var h=!1,g=null,l;for(l in b)null==b[l]&&(g=l,h=!0);1==h?(h={},f=this.punctuatorEnum[f.operator],e=this.getFormatValue(e),h[f]=e,b[g]=h):console.error(val+"\u8282\u70b9\u63d2\u5165\u5931\u8d25\uff0c\u8fd0\u7b97\u7b26\uff1a"+f.operator+"\uff0c\u503c\uff1a"+e.id.value)};this.resampleInsert=
function(b,e,f){if("string"==b.id.type.toLowerCase())if(-1!=b.id.value.indexOf('"')&&3>b.id.value.split('"').length){var h=1==b.id.value.startsWith('"')?1:0;b.id.value=b.id.value.replace('"',"");f.resampleStrObj=1==f.resampleStrObj?!1:!0}else-1!=b.id.value.indexOf("'")&&3>b.id.value.split("'").length&&(h=1==b.id.value.startsWith("'")?1:0,b.id.value=b.id.value.replace("'",""),f.resampleStrObj=1==f.resampleStrObj?!1:!0);if(null!=h||1==f.resampleStrObj){null==e.resample.how&&(e.resample.how={});var g=
b.id.value.split(":");2==g.length?e.resample.how[g[0]]=g[1]:console.error("resample \u89e3\u6790\u5931\u8d25\uff0c\u9519\u8bef\u7684\u53d8\u9891\u53c2\u6570\uff01 "+b.id.value);0==f.resampleStrObj&&f.resampleCount++}else{if(0==f.resampleCount%2)g=this.getFormatValue(b),e.resample[g]=null;else{b=this.getFormatValue(b);e=this.readNestObj(e.resample).obj;for(var l in e)g=l;null==e[g]?e[g]=b:console.error("\u63d2\u5165\u5931\u8d25\uff1a",valueMap)}f.resampleCount++}};this.getFormatValue=function(b){return"String"==
b.id.type?eval(b.id.value):"Numeric"==b.id.type?parseInt(b.id.value):b.id.value};this.autoGenerate=function(b){var e=new GSQLModel;this.sqlModel=e;this.codegenState=e.codegenState;b=this.parse(b).program;this.VLR(b,this.sqlModel,this.codegenState,!1);1<this.sqlModel._and.length?this.sqlModel.model.where=this.sqlModel.and:1==this.sqlModel._and.length&&(this.sqlModel.model.where=this.sqlModel._and[0]);0<this.sqlModel.keys.length&&(this.sqlModel.model.keys=this.sqlModel.keys);0<this.sqlModel.relations.length&&
(this.sqlModel.model.relations=this.sqlModel.relations);1==this.mapIsLength(this.sqlModel.resample)&&(this.sqlModel.model.resample=this.sqlModel.resample);1==this.mapIsLength(this.sqlModel.orderby)&&(this.sqlModel.model.orderby=this.sqlModel.orderby);return this.sqlModel.model};this.getParams=function(b){for(var e=null,f=0;f<b.params.length;f++)null==e&&(e=[]),e.push(b.params[f]);return e};this.getParamsValue=function(b,e){for(var f=[],h=1;h<arguments.length;++h)f[h-1]=arguments[h];h=null;for(var g=
0;g<b.params.length;g++){null==h&&(h=[]);for(var l={},v=0;v<f.length;v++)l[f[v]]=b.params[g].id[f[v]];h.push(l)}return h};this.mapIsLength=function(b){for(var e in b)if(null!=b[e])return!0;return!1};this.deCopy=function(b){return JSON.parse(JSON.stringify(b))}}(function(){var a="object"===typeof window?window:{},b="function"===typeof define&&define.amd;"object"===typeof process&&process.versions&&process.versions.node&&(a=global);a.scriptAst=new GScriptAST;b&&define(function(){return exports})})();var GSDKLog=function(){};GSDKLog.log=function(a){GSDKLog.output("log",a)};GSDKLog.info=function(a){GSDKLog.output("info",a)};GSDKLog.error=function(a){GSDKLog.output("error",a)};GSDKLog.output=function(a,b){var e=new GLog;e.level=a;e.msg=b;e.time=getNowSaftTime();if(GSDK&&null!=GSDK.onRealLog)GSDK.onRealLog(e)};function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function ltrim(a){return a.replace(/(^\s*)/g,"")}function rtrim(a){return a.replace(/(\s*$)/g,"")}function trimSingle(a){return a.replace(/(^'*)|('*$)/g,"")}function trimDbSingle(a){return a.replace(/(^"*)|("*$)/g,"")}function isStringType(a){var b=/(^"*)|("*$)/;return/(^'*)|('*$)/.test(a)||b.test(a)?!0:!1}
function strIsNumber(a){var b=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return/^\d+(\.\d+)?$/.test(a)||b.test(a)?!0:!1}function objLength(a){var b=0,e;for(e in a)b++;return b}
function getTableForMap(a){var b=null;if(a&&a.data&&"row"==a.info.rank&&0<a.data.length&&a.field&&a.field.length==a.data[0].length)for(var e=0;e<a.field.length;e++)b||(b={}),b[a.field[e][0]]={value:a.data[0][e],valueType:a.field[e][1]};else if(a&&a.data&&"col"==a.info.rank&&0<a.data.length&&a.field&&a.field.length==a.data.length)for(e=0;e<a.field.length;e++)b||(b={}),b[a.field[e][0]]={value:a.data[e][0],valueType:a.field[e][1]};return b}
function getNowSaftTime(){var a=new Date,b=a.getFullYear(),e=a.getMonth()+1,f=a.getDate(),h=10>a.getHours()?"0"+a.getHours():a.getHours(),g=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes(),l=10>a.getSeconds()?"0"+a.getSeconds():a.getSeconds();a=a.getMilliseconds();return b+"-"+e+"-"+f+" "+h+":"+g+":"+l+"."+a}function getEnvInfo(){if("undefined"!=typeof window&&null!=window)return"web";if("object"===typeof process&&process.versions&&process.versions.node)return"node"}
function makeMessageString(a){a=a.replace(/"/g,"__2__");a=a.replace(/\n/g,"\\n");a=a.replace(/\t/g,"\\t");return a=a.replace(/\\/g,"\\\\")}function xDeepCopy(a){a=JSON.stringify(a);return JSON.parse(a)}function CheckMustParams(a,b){for(var e=0;e<b.length;e++)if(""==a[b[e]]||null==a[b[e]])return GSDKLog.error(b[e]+"\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a"),!1;return!0};function GDataType(){}GDataType.dtBool=0;GDataType.dtString=1;GDataType.dtInt=2;GDataType.dtInt64=3;GDataType.dtFloat=4;GDataType.dtDouble=5;GDataType.dtDateTime=6;GDataType.dtTimeStamp=7;GDataType.dtTimeStampMs=8;GDataType.dtDataSet=9;GDataType.dtArray=10;GDataType.dtStringArray=11;var GColumnInfo=function(){this.data=this.dataType=this.name=this.index=null},GCellData=function(){};GCellData.prototype.getValueText=function(){};GCellData.prototype.getRawData=function(){};
GCellData.prototype.isValid=function(){};GCellData.prototype.getDecimal=function(){};GCellData.prototype.getColorFlags=function(){};GCellData.prototype.getUpDownFlags=function(){};var GDataSet=function(){this.name;this.rowCount;this.colCount;this.begin;this.totalRows;this.columnInfos};GDataSet.prototype.getColumn=function(a){for(var b in this.columnInfos)if(this.columnInfos[b].index==a)return this.columnInfos[b]};
GDataSet.prototype.getColumnByName=function(a){for(var b in this.columnInfos)if(a.toLowerCase()===b.toLowerCase())return this.columnInfos[b]};
GDataSet.prototype.getCellData=function(a,b){var e=GDataSourceManager.sharedInstance().getDataSetSourceWithId(this.id);--a;--b;var f=e.data[b][a],h=e.field[b][1],g;if(null!=e.flags){var l=e.field[b][0];null!=e.flags[l.toLowerCase()]&&(g=e.flags[l.toLowerCase()][a])}if(null!=f){null==e.cellData&&(e.cellData=[]);null==e.cellData[b]&&(e.cellData[b]=[]);if(null==e.cellData[b][a]||e.cellData[b][a].getRawData()!=f){l=new GCellData;var v=""+GDataTool.getValueFormatString(f,h,null,g),n=GDataTool.GETGFLAG_COLOR(g),
p=1==GDataTool.GETGFLAG_ISINVALID(g)?0:1,c=GDataTool.GETGFLAG_DEC(g),w=GDataTool.GET_UP_DOWN_FLAGS(g);l.getValueText=function(){return v};l.getRawData=function(){return f};l.isValid=function(){return p};l.getDecimal=function(){return c};l.getColorFlags=function(){return n};l.getUpDownFlags=function(){return w};e.cellData[b][a]=l}return e.cellData[b][a]}};GDataSet.prototype.getCellText=function(a,b){a=this.getCellData(a,b);return null==a?"-":a.getValueText()};
GDataSet.prototype.getCellDataByName=function(a,b){b=this.getColumnByName(b).index;return this.getCellData(a,b)};GDataSet.prototype.getCellTextByName=function(a,b){b=this.getColumnByName(b).index;return this.getCellText(a,b)};GDataSet.prototype.getColValues=function(a){return GDataSourceManager.sharedInstance().getDataSetSourceWithId(this.id).data[a-1]};GDataSet.prototype.getColValuesByName=function(a){a=this.getColumnByName(a);return this.getColValues(a.index)};
GDataSet.prototype.getRowValues=function(a){var b=[],e;for(e in this.columnInfos){var f=this.getCellTextByName(a,this.columnInfos[e].name);b.push(f)}return b};var GFormula=function(){this.formula;this.systemFormulaName};GFormula.prototype.setParam=function(a,b){};GFormula.prototype.run=function(){};var GRequestCommon=function(){this.id;this.onCallback;this.url;this.field;this.params={};this.id=""+GSDK.count++};GRequestCommon.prototype.setUrl=function(a){this.url=a};GRequestCommon.prototype.setField=function(a){this.field=a};GRequestCommon.prototype.setParam=function(a,b){this.params[a]=b};GRequestCommon.prototype.clearParams=function(){this.params={}};
GRequestCommon.prototype.request=function(){var a=GSDK.requestId++;a={type:"http",objectId:this.id,requestId:a,url:this.url,field:this.field,params:this.params};GDataManager.sharedInstance().fireData(a)};var GKeyWizard=function(){this.onCallback=GSDK_HOOK.getOnCallback();this.begin=0;this.count=10;this.search=GSDK.createRequestItem("GRequestCommon");this.id=this.search.id};
GKeyWizard.prototype.match=function(a){if(CheckMustParams(this,["category","market"]))return this.search.setUrl("keyboardsearch/secu/search/query"),this.field="sufSecuCode, secuAbbr",this.search.setField(this.field),this.search.setParam("keyword",a),this.search.setParam("category",this.category),this.search.setParam("market",this.market),this.search.setParam("limit",this.begin+","+this.count),this.search.onCallback=this.onCallback,this.search.request(),this.search.id};
GKeyWizard.prototype.clearParams=function(){this.search.clearParams()};var GRequestQuote=function(){this.id;this.isSubscribe=!1;this.field;this.onCallback;this.url;this.params={};this.id=""+GSDK.count++};GRequestQuote.prototype.setUrl=function(a){this.url=a};GRequestQuote.prototype.setField=function(a){this.field=a};GRequestQuote.prototype.setParam=function(a,b){this.params[a]=b};GRequestQuote.prototype.clearParams=function(){this.params={}};
GRequestQuote.prototype.request=function(){var a={type:"quote",objectId:this.id,requestId:0,url:this.url,params:this.params,field:this.field};GDataManager.sharedInstance().fireData(a)};GRequestQuote.prototype.stop=function(){this.isSubscribe=!1;this.request()};var GSnapshotQuote=function(){GRequestQuote.call(this);this.codes;this.fields};$jscomp.inherits(GSnapshotQuote,GRequestQuote);GSnapshotQuote.prototype.setCodes=function(a){this.codes=a};
GSnapshotQuote.prototype.addCode=function(a){var b=this.codes.split(",");b.push(a);this.codes=b.toString()};GSnapshotQuote.prototype.delCode=function(a){for(var b=this.codes.split(","),e=0;e<b.length;e++)if(b[e]==a){delete b[e];break}if(e!=b.length){for(;e<b.length;e++)b[e]=b[e+1];--b.length}this.codes=b.toString()};GSnapshotQuote.prototype.setFields=function(a){this.fields=a};GSnapshotQuote.prototype.addField=function(a){var b=this.fields.split(",");b.push(a);this.fields=b.toString()};
GSnapshotQuote.prototype.delField=function(a){for(var b=this.fields.split(","),e=0;e<b.length;e++)if(b[e]==a){delete b[e];break}if(e!=b.length){for(;e<b.length;e++)b[e]=b[e+1];--b.length}this.fields=b.toString()};
GSnapshotQuote.prototype.request=function(){if(CheckMustParams(this,["codes","fields"])){var a="";if(null!=this.codes)for(var b=this.codes.split(","),e=0;e<b.length;e++)e==b.length-1?a+="'"+b[e]+"'":a+="'"+b[e]+"',";this.setUrl("md.quote");this.setParam("condition","code in ("+a+")");this.setParam("field",this.fields);this.setParam("subscribe",this.isSubscribe);GRequestQuote.prototype.request.call(this)}};var GSnapshotUpdowns=function(){GRequestQuote.call(this)};
$jscomp.inherits(GSnapshotUpdowns,GRequestQuote);GSnapshotUpdowns.prototype.request=function(){CheckMustParams(this,["code"])&&(this.setUrl("dd.quote"),this.setField("risecount,SuspensionCount,FallCount"),this.setParam("condition","code = '"+this.code+"'"),this.setParam("subscribe",this.isSubscribe),GRequestQuote.prototype.request.call(this))};var GSeQuence=function(){GRequestQuote.call(this);this.begin=-1;this.count=25};$jscomp.inherits(GSeQuence,GRequestQuote);
var GKLine=function(){GSeQuence.call(this);this.endDate};$jscomp.inherits(GKLine,GSeQuence);
GKLine.prototype.request=function(){if(CheckMustParams(this,["code","period"])){var a=function(g){switch(g){case "day":return"md.quote/day";case "minute":return"md.quote/minute";default:return"md.quote/minute5"}},b=function(g){switch(g){case "minute":return"Time,Open,High,Low,Close,Volume,Amount";default:return"Date,Open,High,Low,Close,Volume,Amount"}},e=function(g,l){switch(g){case "minute":return"freq='"+l+" minutes', time='time', how='open:open, high:high,low:low,close:close'";case "day":return"freq='"+
l+"', time='date', how='open:open, high:high,low:low,close:close'"}};switch(this.period){case "1":a=a("minute");b=b("minute");break;case "5":a=a("minute5");b=b("minute");break;case "15":case "30":case "60":case "120":a=a("minute"+this.period);var f=e("minute",this.period);b=b("minute");break;case "day":case "week":case "month":case "quarter":case "year":a=a("day");"day"!=this.period&&(f=e("day",this.period));b=b("day");break;default:return}this.setUrl(a);this.setField(b);this.setParam("keys","'"+
this.code+"'");this.setParam("subscribe",this.isSubscribe);this.setParam("relations","factor,adjust:cq");null!=f&&this.setParam("resample",f);null!=this.begin&&null!=this.count&&this.setParam("limit",this.begin+","+this.count);var h;null!=this.beginDate&&(h="date >= "+this.beginDate);null!=this.endDate&&null!=h&&(h+=" and date <= "+this.endDate);null!=h?this.setParam("date",h):this.setParam("date","date > 19900101");GSeQuence.prototype.request.call(this)}};var GOrder=function(){GSeQuence.call(this)};
$jscomp.inherits(GOrder,GSeQuence);GOrder.prototype.request=function(){GSeQuence.prototype.setParams.call(this,{code:this.code});GSeQuence.prototype.request.call(this)};var GStep=function(){GSeQuence.call(this)};$jscomp.inherits(GStep,GSeQuence);GStep.prototype.request=function(){GSeQuence.prototype.setParams.call(this,{code:this.code});GSeQuence.prototype.request.call(this)};var GTick=function(){GSeQuence.call(this)};$jscomp.inherits(GTick,GSeQuence);
GTick.prototype.request=function(){CheckMustParams(this,["code"])&&(this.setField("TIME,price,Volume,DealLots"),this.setUrl("md.quote/tick"),this.setParam("keys","'"+this.code+"'"),this.setParam("includeFlags",!0),this.setParam("subscribe",this.isSubscribe),this.setParam("limit",this.begin+","+this.count),GSeQuence.prototype.request.call(this))};var GTrend=function(){GSeQuence.call(this)};$jscomp.inherits(GTrend,GSeQuence);
GTrend.prototype.request=function(){CheckMustParams(this,["code","days"])&&(this.setUrl("md.quote/trend"),this.setField("Time, Price, Volume, Amount, VWAP, netValue"),null==this.days&&(this.days=1),1!=this.days&&this.setParam("last",""+this.days),this.setParam("relation","exchTime"),this.setParam("keys","'"+this.code+"'"),this.setParam("subscribe",this.isSubscribe),GSeQuence.prototype.request.call(this))};var GCallAution=function(){GSeQuence.call(this)};$jscomp.inherits(GCallAution,GSeQuence);
GCallAution.prototype.request=function(){CheckMustParams(this,["code"])&&(this.setField("time, Price, MatchVolume"),this.setUrl("md.quote/auction"),this.setParam("keys","'"+this.code+"'"),this.setParam("subscribe",this.isSubscribe),this.setParam("limit",this.begin+","+this.count),GSeQuence.prototype.request.call(this))};var GHisTrend=function(){GSeQuence.call(this)};$jscomp.inherits(GHisTrend,GSeQuence);
GHisTrend.prototype.request=function(){CheckMustParams(this,["code","date"])&&(this.setUrl("md.quote/trend"),this.setField("Time, Price, Volume, Amount, VWAP, netValue"),this.setParam("date","date = "+this.date),this.setParam("relation","exchTime"),this.setParam("keys","'"+this.code+"'"),GSeQuence.prototype.request.call(this))};var GSectorSort=function(){GRequestQuote.call(this)};$jscomp.inherits(GSectorSort,GRequestQuote);
GSectorSort.prototype.request=function(){if(!this.sectorId&&!this.codes)GSDKLog.error("sectorId\u548ccodes\u4e0d\u80fd\u540c\u65f6\u4e3a\u7a7a");else if(CheckMustParams(this,["sortField"])){this.setUrl("md.quote");this.setField("code");var a="",b="";if(null!=this.codes)for(var e=this.codes.split(","),f=0;f<e.length;f++)f==e.length-1?b+="'"+e[f]+"'":b+="'"+e[f]+"',";this.condition?this.sectorId&&(a="code in (select code from meson.screen where blockId = '"+this.sectorId+"' filter "+this.condition+
")'"):a=this.sectorId?"code in (select code from rd.sector/composition('"+this.sectorId+"'))":"code in ("+b+")";this.setParam("condition",a);null==this.sortType?this.sortField+=" asc":"none"!=this.sortType&&(this.sortField+=" "+this.sortType);this.setParam("orderby",""+this.sortField);this.setParam("limit",this.begin+","+this.count);GRequestQuote.prototype.request.call(this)}};var GSDKInfo=function(){this.version="v1.0.1"},GMessage=function(){this.message;this.code},GLog=function(){this.level;this.msg;this.time},GSDK=function(){};GSDK.getInfo=function(){return new GSDKInfo};GSDK.connect=function(a,b,e,f,h){f=void 0===f?"default":f;h=void 0===h?null:h;var g=GSession.sharedInstance();a={url:a,userId:b,accessToken:e,env:f};if(null!=h)for(var l in h)null!=h[l]&&(a[l]=h[l]);g.login(a)};GSDK.disconnect=function(){GSession.sharedInstance().loginOut()};
GSDK.createRequestItem=function(a){try{var b=eval("new "+a+"()");GRequestManager.addItems(b);return b}catch(e){console.log(e),null!=GSDK.onNotification&&(a=new GMessage,a.message=a.message,a.code=1001,GSDK.onNotification(a))}};GSDK.destroyRequestItem=function(a){null!=a&&null!=a.id&&GSDK.destroyRequestItemById(a.id)};GSDK.destroyRequestItemById=function(a){null!=a&&(GRequestManager.deleteItemsWithId(a),GDataSetManager.sharedInstance().delDataSetWithId(a),GDataSourceManager.sharedInstance().delDataSourceWithId(a))};
GSDK.getAllRequestItems=function(){return GRequestManager.getAllRequestItems()};GSDK.clearAllRequestItems=function(){};GSDK.getAllSubscribe=function(){};GSDK.getRequestItemsById=function(a){return GRequestManager.getItemsWithId(a)};GSDK.count=0;GSDK.requestId=0;GSDK.onRealLog=GSDK_HOOK.getOnRealLog();GSDK.onNotification=GSDK_HOOK.getOnNotification();
