var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,c){a.raw=c;return a};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,f){if(a==Array.prototype||a==Object.prototype)return a;a[c]=f.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var f=a[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var f=$jscomp.propertyToPolyfillSymbol[c];if(null==f)return a[c];f=a[f];return void 0!==f?f:a[c]};
$jscomp.polyfill=function(a,c,f,e){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,f,e):$jscomp.polyfillUnisolated(a,c,f,e))};$jscomp.polyfillUnisolated=function(a,c,f,e){f=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var h=a[e];if(!(h in f))return;f=f[h]}a=a[a.length-1];e=f[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,f,e){var h=a.split(".");a=1===h.length;e=h[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<h.length-1;g++){var m=h[g];if(!(m in e))return;e=e[m]}h=h[h.length-1];f=$jscomp.IS_SYMBOL_NATIVE&&"es6"===f?e[h]:null;c=c(f);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,h,{configurable:!0,writable:!0,value:c}):c!==f&&($jscomp.propertyToPolyfillSymbol[h]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(h):$jscomp.POLYFILL_PREFIX+h,h=
$jscomp.propertyToPolyfillSymbol[h],$jscomp.defineProperty(e,h,{configurable:!0,writable:!0,value:c})))};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},c={};try{return c.__proto__=a,c.a}catch(f){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,c){this.nextAddress=c;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,c){a=$jscomp.makeIterator(a);var f=a.next();$jscomp.generator.ensureIteratorResultIsObject_(f);if(f.done)this.yieldResult=f.value,this.nextAddress=c;else return this.yieldAllIterator_=a,this.yield(f.value,c)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,c){this.catchAddress_=a;void 0!=c&&(this.finallyAddress_=c)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,c){this.nextAddress=a;this.catchAddress_=c||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,c,f){f?this.finallyContexts_[f]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=c||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,c){c=this.finallyContexts_.splice(c||0)[0];if(c=this.abruptCompletion_=this.abruptCompletion_||c){if(c.isException)return this.jumpToErrorHandler_();void 0!=c.jumpTo&&this.finallyAddress_<c.jumpTo?(this.nextAddress=c.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var c in a)this.properties_.push(c);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var c=this.context_.yieldAllIterator_;if(c)return this.yieldAllStep_("return"in c?c["return"]:function(f){return{value:f,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,c,f){try{var e=a.call(this.context_.yieldAllIterator_,c);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var h=e.value}catch(g){return this.context_.yieldAllIterator_=null,this.context_.throw_(g),this.nextStep_()}this.context_.yieldAllIterator_=null;f.call(this.context_,h);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(c){this.context_.yieldResult=void 0,this.context_.throw_(c)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(c){return a.next_(c)};this.throw=function(c){return a.throw_(c)};this.return=function(c){return a.return_(c)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,c){c=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(c,a.prototype);return c};
$jscomp.asyncExecutePromiseGenerator=function(a){function c(e){return a.next(e)}function f(e){return a.throw(e)}return new Promise(function(e,h){function g(m){m.done?e(m.value):Promise.resolve(m.value).then(c,f).then(g,h)}g(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(a){if(a)return a;var c=function(h,g){this.$jscomp$symbol$id_=h;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};c.prototype.toString=function(){return this.$jscomp$symbol$id_};var f=0,e=function(h){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(h||"")+"_"+f++,h)};return e},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<c.length;f++){var e=$jscomp.global[c[f]];"function"===typeof e&&"function"!=typeof e.prototype[a]&&$jscomp.defineProperty(e.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function c(){this.batch_=null}function f(m){return m instanceof h?m:new h(function(v,n){v(m)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;c.prototype.asyncExecute=function(m){if(null==this.batch_){this.batch_=[];var v=this;this.asyncExecuteFunction(function(){v.executeBatch_()})}this.batch_.push(m)};var e=$jscomp.global.setTimeout;c.prototype.asyncExecuteFunction=function(m){e(m,0)};c.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var m=
this.batch_;this.batch_=[];for(var v=0;v<m.length;++v){var n=m[v];m[v]=null;try{n()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};c.prototype.asyncThrow_=function(m){this.asyncExecuteFunction(function(){throw m;})};var h=function(m){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var v=this.createResolveAndReject_();try{m(v.resolve,v.reject)}catch(n){v.reject(n)}};h.prototype.createResolveAndReject_=function(){function m(p){return function(b){n||(n=!0,p.call(v,b))}}var v=this,n=!1;
return{resolve:m(this.resolveTo_),reject:m(this.reject_)}};h.prototype.resolveTo_=function(m){if(m===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(m instanceof h)this.settleSameAsPromise_(m);else{a:switch(typeof m){case "object":var v=null!=m;break a;case "function":v=!0;break a;default:v=!1}v?this.resolveToNonPromiseObj_(m):this.fulfill_(m)}};h.prototype.resolveToNonPromiseObj_=function(m){var v=void 0;try{v=m.then}catch(n){this.reject_(n);return}"function"==typeof v?
this.settleSameAsThenable_(v,m):this.fulfill_(m)};h.prototype.reject_=function(m){this.settle_(2,m)};h.prototype.fulfill_=function(m){this.settle_(1,m)};h.prototype.settle_=function(m,v){if(0!=this.state_)throw Error("Cannot settle("+m+", "+v+"): Promise already settled in state"+this.state_);this.state_=m;this.result_=v;this.executeOnSettledCallbacks_()};h.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var m=0;m<this.onSettledCallbacks_.length;++m)g.asyncExecute(this.onSettledCallbacks_[m]);
this.onSettledCallbacks_=null}};var g=new c;h.prototype.settleSameAsPromise_=function(m){var v=this.createResolveAndReject_();m.callWhenSettled_(v.resolve,v.reject)};h.prototype.settleSameAsThenable_=function(m,v){var n=this.createResolveAndReject_();try{m.call(v,n.resolve,n.reject)}catch(p){n.reject(p)}};h.prototype.then=function(m,v){function n(z,y){return"function"==typeof z?function(l){try{p(z(l))}catch(u){b(u)}}:y}var p,b,w=new h(function(z,y){p=z;b=y});this.callWhenSettled_(n(m,p),n(v,b));return w};
h.prototype.catch=function(m){return this.then(void 0,m)};h.prototype.callWhenSettled_=function(m,v){function n(){switch(p.state_){case 1:m(p.result_);break;case 2:v(p.result_);break;default:throw Error("Unexpected state: "+p.state_);}}var p=this;null==this.onSettledCallbacks_?g.asyncExecute(n):this.onSettledCallbacks_.push(n)};h.resolve=f;h.reject=function(m){return new h(function(v,n){n(m)})};h.race=function(m){return new h(function(v,n){for(var p=$jscomp.makeIterator(m),b=p.next();!b.done;b=p.next())f(b.value).callWhenSettled_(v,
n)})};h.all=function(m){var v=$jscomp.makeIterator(m),n=v.next();return n.done?f([]):new h(function(p,b){function w(l){return function(u){z[l]=u;y--;0==y&&p(z)}}var z=[],y=0;do z.push(void 0),y++,f(n.value).callWhenSettled_(w(z.length-1),b),n=v.next();while(!n.done)})};return h},"es6","es3");
$jscomp.iteratorFromArray=function(a,c){a instanceof String&&(a+="");var f=0,e={next:function(){if(f<a.length){var h=f++;return{value:c(h,a[h]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(c,f,e){var h=this.length||0;0>f&&(f=Math.max(0,h+f));if(null==e||e>h)e=h;e=Number(e);0>e&&(e=Math.max(0,h+e));for(f=Number(f||0);f<e;f++)this[f]=c;return this}},"es6","es3");$jscomp.typedArrayFill=function(a){return a?a:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.checkStringArgs=function(a,c,f){if(null==a)throw new TypeError("The 'this' value for String.prototype."+f+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+f+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(c,f){var e=$jscomp.checkStringArgs(this,c,"endsWith");c+="";void 0===f&&(f=e.length);f=Math.max(0,Math.min(f|0,e.length));for(var h=c.length;0<h&&0<f;)if(e[--f]!=c[--h])return!1;return 0>=h}},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(c,f,e){f=null!=f?f:function(v){return v};var h=[],g="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];if("function"==typeof g){c=g.call(c);for(var m=0;!(g=c.next()).done;)h.push(f.call(e,g.value,m++))}else for(g=c.length,m=0;m<g;m++)h.push(f.call(e,c[m],m));return h}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(c,f){var e=$jscomp.checkStringArgs(this,c,"startsWith");c+="";var h=e.length,g=c.length;f=Math.max(0,Math.min(f|0,e.length));for(var m=0;m<g&&f<h;)if(e[f++]!=c[m++])return!1;return m>=g}},"es6","es3");
function GDataIncAnalysis(){function a(b,w,z){if(null==b)return null;for(var y=[],l=0;l<b.length;l++){var u=null;z&&(u=z[b[l][0].toLowerCase()]);null==b[l][1]&&(b[l][1]="t");if("x"==b[l][1][0])for(var x=parseInt(b[l][1][1]),d,t=0;t<w.length;t++)void 0==y[t]&&(y[t]=[]),w[t]&&null!=w[t][l]&&(u&&u[t]&&3==(u[t]&3)?y[t][l]=null:(d=u&&u[t]&&0<(u[t]>>5&7)?(u[t]>>5&7)-1:x,y[t][l]=w[t][l]/e[d]));else{for(t=0;t<w.length;t++)void 0==y[t]&&(y[t]=[]),y[t][l]=u&&u[t]&&3==(u[t]&3)?null:null!=w[t]&&null!=w[t][l]?
w[t][l]:null;if("c"==b[l][1]||"t"==b[l][1]||"t"==b[l][1][0]&&"0"<=b[l][1][1]&&"9">=b[l][1][1])for(t=0;t<y.length;t++)y[t][l]&&"string"==typeof y[t][l]&&(y[t][l]=y[t][l].replace(/\\n/g,"\n"))}}return y}function c(b,w,z){if(null==b)return null;for(var y=[],l=0;l<b.length;l++){void 0==y[l]&&(y[l]=[]);var u=null;z&&(u=z[b[l][0].toLowerCase()]);if(null!=w[l])if("x"==b[l][1][0])for(var x=parseInt(b[l][1][1]),d=0;d<w[l].length;d++)if(u&&u[d]&&3==(u[d]&3))y[l][d]=null;else{var t=u&&u[d]&&0<(u[d]>>5&7)?(u[d]>>
5&7)-1:x;y[l][d]=w[l][d]/e[t]}else{for(d=0;d<w[l].length;d++)y[l][d]=u&&u[d]&&3==(u[d]&3)?null:w[l][d];if("c"==b[l][1]||"t"==b[l][1]||"t"==b[l][1][0]&&"0"<=b[l][1][1]&&"9">=b[l][1][1])for(d=0;d<y[l].length;d++)y[l][d]&&"String"==y[l][d].constructor.name&&(y[l][d]=y[l][d].replace(/\\n/g,"\n"))}}return y}function f(b){b=new Date;return 1E5*b.getUTCMinutes()+1E3*b.getUTCSeconds()+b.getUTCMilliseconds()}this.socketDecode=function(b,w,z){z=0;"undefined"==typeof b.result&&(b.result=[]);for(var y=b.orgLen=
0;y<w.result.length;y++){var l=w.result[y].table;if(null!=l){var u=l.info,x=l.gid;null==x&&(x=w.result[y].gid);u.name=x.name;u.msg=w.msg?w.msg:"";var d=parseInt(x.idx),t,q,D,A=!1;1==b.cacheWindow&&(A=!0);u.begin--;u.thisBegin&&u.thisBegin--;var G=l.field,B=l.data,I=l.last,L=l.adjust,C=l.modify,F=G;null==F&&b.result&&b.result[d]&&b.result[d].table&&(F=b.result[d].table.field);if(null==F&&b.result[d]&&b.result[d].table&&null==b.result[d].table.field)b.result[d]=null;else{v(l,F,z);delete l.flgs;var P=
JSON.stringify(l).length;b.orgLen+=P;var K=l.flags;"row"!=u.rank&&"col"!=u.rank&&(u.rank="row");void 0==b.result[d]&&(b.result[d]={updateCounter:0});void 0==b.result[d].table&&(b.result[d].table={});b.result[d].updateCounter=f();var E=!1;P=b.result[d].table.info;if(void 0==P){if(null==B&&C){b.result[d]=null;continue}b.result[d].table.info=xDeepCopy(u);E=!0}else null==b.result[d].gid||b.result[d].gid.id!=x.id?E=!0:G&&l.data&&("row"==u.rank&&u.rows==l.data.length||"col"==u.rank&&u.rows==l.data[0].length)?
E=!0:P.begin+P.rows<u.begin||u.begin+u.rows<P.begin?(E=2,void 0==F&&(F=b.result[d].table.field),null==G&&(G=F)):u.begin==u.thisBegin&&B&&("row"==u.rank?B.length==u.rows&&(E=!1):B&&B[0]&&B[0].length==u.rows&&(E=!1));if(E&&null!=C)break;if(E)if(2!=E&&(b.result[d].table={}),b.result[d].table.data=[],b.result[d].table.flags={},b.result[d].table.dataStatus=[],B){if("row"==u.rank){var N=a(F,B,K);if(A)b.result[d].table.data=N,u.dataBegin=u.begin,u.dataRows=u.rows;else if(N){for(t=E=0;E<N.length;t++,E++)b.result[d].table.data[t]=
N[E];for(dataBegin in b.result[d].table.data)break;u.dataBegin=0;u.dataRows=b.result[d].table.data.length}else u.dataBegin=0,u.dataRows=0}else if(N=c(F,B,K),A)b.result[d].table.data=N,u.dataBegin=u.begin,u.dataRows=u.rows;else if(N){for(q=0;q<N.length;q++)for(E=0,b.result[d].table.data[q]=[],t=0;E<N[q].length;t++,E++)b.result[d].table.data[q][t]=N[q][E];u.dataBegin=u.begin;u.dataRows=b.result[d].table.data[0].length}else u.dataBegin=0,u.dataRows=0;if(K&&0<Object.keys(K).length)if(A)for(D in K)b.result[d].table.flags[D.toLowerCase()]=
K[D];else if("row"==u.rank)for(D in K)for(E=0,q=D.toLowerCase(),b.result[d].table.flags[q]=[],t=u.begin;E<K[D].length;E++,t++)b.result[d].table.flags[q][t]=K[D][E];else for(D in K)for(E=0,q=D.toLowerCase(),b.result[d].table.flags[q]=[],t=0;E<K[D].length;E++,t++)b.result[d].table.flags[q][t]=K[D][E]}else u.dataBegin=0,u.dataRows=0;else b.result[d].table.dataStatus=[],A?(p(b.result[d].table,l,F),u.rows=b.result[d].table.info.dataRows):p(b.result[d].table,l,F);if(C){if(b.result[d].table.dataStatus)for(t=
0;t<b.result[d].table.dataStatus.length;t++)void 0==b.result[d].table.dataStatus[t]&&(b.result[d].table.dataStatus[t]=0);if(null==B&&C.flags)for(D in K=0,"row"==u.rank?b.result[d].table.data&&(K=b.result[d].table.data.length):b.result[d].table&&b.result[d].table.data[0]&&(K=b.result[d].table.data[0].length),C.flags)for(E=0;E<C.record.length;E++)t=C.flags[D][E],q=C.record[E]-1,q-=b.result[d].table.info.dataBegin,-1<q&&q<K&&(B=D.toLowerCase(),void 0==b.result[d].table.flags[B]&&(b.result[d].table.flags[B]=
[]),b.result[d].table.flags[B][q]=t);K=b.result[d].table.flags;if("updateappend"==u.type)if(t=C.record[0]-1,t<u.begin||t>=u.begin+u.row)console.log("updateappend \u8d85\u51fa\u7a97\u53e3\u8303\u56f4!");else{A&&(t-=u.begin);B=1;E=N=0;if(C.data&&C.data[E])for(var M=0;M<C.data[E].length;M++)N+=C.data[E][M].length;if("row"==u.rank)for(M=0;M<N;M++){if(q=g(C.data[E][0],M),!(q>=F.length)){if("x"==F[q][1][0]){var J=parseInt(F[q][1][1]),H=null;K&&(H=K[F[q][0].toLowerCase()]);H&&H[t]&&3==(H[t]&3)?b.result[d].table.data[t][q]=
null:(H&&H[t]&&0<(H[t]>>5&7)&&(J=(H[t]>>5&7)-1),b.result[d].table.data[t][q]=null==b.result[d].table.data[t][q]?C.data[B]/e[J]:b.result[d].table.data[t][q]+C.data[B]/e[J],b.result[d].table.data[t][q]=parseFloat(b.result[d].table.data[t][q].toFixed(J)))}else"i"==F[q][1][0]?b.result[d].table.data[t][q]="."==F[q][1][2]?C.data[B]:b.result[d].table.data[t][q]+C.data[B]:"t"!=F[q][1]&&"t"==F[q][1][0]?b.result[d].table.data[t][q]+=C.data[B]:"d"==F[q][1][0]?b.result[d].table.data[t][q]+=C.data[B]:"g"==F[q][1][0]?
b.result[d].table.data[t][q][2]&&(J=b.result[d].table.data[t][q][2],b.result[d].table.data[t][q][0]==C.data[B][0]&&(B=b.result[d].table.data[t][q][J-1].length,b.result[d].table.data[t][q][J-1][B-1]=C.data[B][0])):b.result[d].table.data[t][q]=C.data[B];B++}}else for(M=0;M<N;M++)q=g(C.data[E],M),"x"==F[q][1][0]?(J=parseInt(F[q][1][1]),H=null,K&&(H=K[F[q][0].toLowerCase()]),H&&H[t]&&3==(H[t]&3)?b.result[d].table.data[t][q]=null:(H&&H[t]&&0<(H[t]>>5&7)&&(J=(H[t]>>5&7)-1),b.result[d].table.data[q][t]=
null==b.result[d].table.data[q][t]?C.data[B]/e[J]:b.result[d].table.data[q][t]+C.data[B]/e[J],b.result[d].table.data[q][t]=parseFloat(b.result[d].table.data[q][t].toFixed(J)))):"i"==F[q][1][0]?b.result[d].table.data[q][t]="."==F[q][1][2]?C.data[B]:b.result[d].table.data[q][t]+C.data[B]:"t"!=F[q][1]&&"t"==F[q][1][0]?b.result[d].table.data[q][t]+=C.data[B]:"d"==F[q][1][0]?b.result[d].table.data[q][t]+=C.data[B]:"g"!=F[q][1][0]&&(b.result[d].table.data[q][t]=C.data[B]),B++;b.result[d].table.dataStatus[t]=
1}else if(C.data)for(E=0;E<C.record.length;E++)if(t=C.record[E]-1,null!=C.data[E]&&0!=C.data[E].length)if(t<u.begin||t>=u.begin+u.rows)console.log("update \u8d85\u51fa\u7a97\u53e3\u8303\u56f4!");else{A&&(t-=u.begin);B=1;for(M=N=0;M<C.data[E][0].length;M++)N+=C.data[E][0][M].length;for(M=0;M<N;M++){q=g(C.data[E][0],M);if(void 0!=b.result[d].table.data[t])if("x"==F[q][1][0])J=parseInt(F[q][1][1]),H=null,K&&(H=K[F[q][0].toLowerCase()]),H&&H[t]&&3==(H[t]&3)?b.result[d].table.data[t][q]=null:(H&&H[t]&&
0<(H[t]>>5&7)&&(J=(H[t]>>5&7)-1),b.result[d].table.data[t][q]=null==b.result[d].table.data[t][q]?C.data[E][B]/e[J]:b.result[d].table.data[t][q]+C.data[E][B]/e[J],b.result[d].table.data[t][q]=parseFloat(b.result[d].table.data[t][q].toFixed(J)));else if("i"==F[q][1][0])b.result[d].table.data[t][q]="."==F[q][1][2]?C.data[E][B]:b.result[d].table.data[t][q]+C.data[E][B];else if("t"!=F[q][1]&&"t"==F[q][1][0]&&"a"!=F[q][1][1]&&"A"<=F[q][1][1])b.result[d].table.data[t][q]="1"==u.compressed?"s"==F[q][1][1]?
b.result[d].table.data[t][q]+1E3*C.data[E][B]:"m"==F[q][1][1]?b.result[d].table.data[t][q]+6E4*C.data[E][B]:b.result[d].table.data[t][q]+C.data[E][B]:b.result[d].table.data[t][q]+C.data[E][B];else if("d"==F[q][1][0])b.result[d].table.data[t][q]+=C.data[E][B];else if("g"==F[q][1][0]){if(b.result[d].table.data[t]&&b.result[d].table.data[t][q]&&b.result[d].table.data[t][q][2]){J=b.result[d].table.data[t][q][2];H=b.result[d].table.data[t][q][0];for(var O=0;O<J-1;O++)H-=b.result[d].table.data[t][q][3+
O][0]+1;if("1"==u.compressed){if(b.result[d].table.data[t][q][3+J-1][H-1]=C.data[E][B][0],1<C.data[E][B].length)for(O=1;O<C.data[E][B].length;O++)b.result[d].table.data[t][q][3+J-1][H+O-1]=b.result[d].table.data[t][q][3+J-1][H+O-2],b.result[d].table.data[t][q][0]++}else if(b.result[d].table.data[t][q][3+J-1][H-1]=C.data[E][B][0],1<C.data[E][B].length)for(O=1;O<C.data[E][B].length;O++)b.result[d].table.data[t][q][3+J-1][H+O-1]=C.data[E][B][O],b.result[d].table.data[t][q][0]++}}else b.result[d].table.data[t][q]=
C.data[E][B];B++}b.result[d].table.dataStatus[t]=1}u.dataBegin=P.dataBegin;u.dataRows=P.dataRows}u&&(null!=u.dataBegin&&null!=u.name||!b.result[d].table.info||(u.dataBegin=b.result[d].table.info.dataBegin,u.dataRows=b.result[d].table.info.dataRows,u.name=b.result[d].table.info.name),b.result[d].table.info=xDeepCopy(u));if(G&&(b.result[d].table.field=xDeepCopy(G),b.alias&&b.alias[d]))for(A=b.alias[d].split(","),B=0;B<A.length&&B<F.length;B++)""!=A[B]&&(b.result[d].table.field[B][0]=trim(A[B]));if(L&&
(b.result[d].table.adjust=xDeepCopy(L),"1"==u.compressed&&(L=b.result[d].table.adjust)&&0<L.length))for(F=n,G=A=0;G<L.length;G++)if(L[G][0]+=F,F=L[G][0],0<L[G][1].length)for(C=0;C<L[G][1].length;C++)L[G][1][C][0]+=F,F=L[G][1][C][0],L[G][1][C][1]+=A,A=L[G][1][C][1];else L[G][1]+=A,A=L[G][1];if(I&&(b.result[d].table.last=xDeepCopy(I),"1"==u.compressed&&(I=b.result[d].table.last)&&0<I.length))for(L=n,G=A=F=0;G<I.length;G++)I[G][0]+=L,L=I[G][0],I[G][2]=I[G][1]+A,I[G][1]=F,A=I[G][2],F+=A;for(D in l)I=
D.toLowerCase(),"gid"!=I&&"info"!=I&&"data"!=I&&"modify"!=I&&"field"!=D&&"flags"!=I&&"flgs"!=I&&"adjust"!=I&&"last"!=I&&("1"==u.compressed&&v(l[D].table,null,z),b.result[d].table[D]=l[D]);b.result[d].updateCounter=f();b.result[d].gid=xDeepCopy(x)}}}return b};this.httpDecode=function(b,w){void 0==b.result&&(b.result=[]);if(null==w.result)return b.result;for(var z=0;z<w.result.length;z++){var y=w.result[z].table,l=y.info,u=y.flags;if(!l)break;var x=y.gid;null==x&&(x=w.result[z].gid);l.name=x.name;l.id=
x.id;l.msg=w.msg?w.msg:"";l.thisBegin?l.thisBegin--:l.thisBegin=l.dataBegin-1;l.begin--;var d=parseInt(x.id),t=!1;if(null==b.result||null==b.result[0]||b.result[0].httpId!==d)t=!0;x=y.field;var q=y.data;if("row"!=l.rank&&"col"!=l.rank)return b.result;void 0==b.result[0]&&(b.result[0]={updateCounter:0});void 0==b.result[0].table&&(b.result[0].table={});b.result[0].updateCounter=f();b.result[0].httpId=d;d=b.result[0].table.info;if(void 0==d)b.result[0].table.info=xDeepCopy(l),t=!0;else if(d.id!=l.id)t=
!0,d.id=l.id;else if(d.begin==l.begin&&d.dataRows<=l.rows)t=!0;else if(d.dataBegin+d.dataRows<l.begin||l.begin+l.rows<d.dataBegin)t=!0,void 0==x&&(newField=x=b.result[0].table.field);if(0<=l.totalRows&&q){if(t){b.result[0].table.data=[];b.result[0].table.flags={};b.result[0].table.dataStatus=[];if("row"==l.rank){if(y=a(x,q,u)){for(r=k=0;k<y.length;r++,k++)b.result[0].table.data[r]=y[k];b.result[0].table.info.begin=l.thisBegin;b.result[0].table.info.thisBegin=l.thisBegin;b.result[0].table.info.rows=
l.rows;b.result[0].table.info.totalRows=l.totalRows}b.result[0].table.data||(l.rows=l.totalRows=0)}else b.result[0].table.data=c(x,q,u);if(x&&(b.result[0].table.field=xDeepCopy(x),b.alias&&b.alias[0]))for(l=b.alias[0].split(","),y=0;y<l.length&&y<x.length;y++)""!=l[y]&&(b.result[0].table.field[y][0]=trim(l[y]))}else{if(l.begin>=d.begin+d.rows){if(q=0,"row"==l.rank)for(x=l.thisBegin;q<y.data.length;x++,q++)b.result[0].table.data[x]=y.data[q]}else if(l.begin+l.rows<=d.begin){q=0;if("row"==l.rank)for(x=
l.thisBegin;q<y.data.length;x++,q++)b.result[0].table.data[x]=y.data[q];b.result[0].table.info.begin=l.thisBegin;b.result[0].table.info.thisBegin=l.thisBegin}else if(l.begin<d.begin+d.rows)for(l.thisBegin<d.begin&&(b.result[0].table.info.begin=l.thisBegin,b.result[0].table.info.thisBegin=l.thisBegin),y=l.begin,x=b.result[0].table.data,u=0;u<q.length;u++)x[y+u]=q[u];b.result[0].table.info.rows=l.rows;b.result[0].table.info.totalRows=l.totalRows}b.result[0].table.info.dataBegin=0;b.result[0].table.info.dataRows=
b.result[0].table.data.length}else{1==parseInt(w.pageId)&&2==parseInt(w.index)&&(debugCount++,console.log("-- "+debugCount+" ---- \u7a7a\u8868 -------"));break}}return b};var e=[1,10,100,1E3,1E4,1E5,1E6],h={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35,A:36,B:37,C:38,D:39,E:40,F:41,G:42,H:43,I:44,J:45,K:46,L:47,M:48,N:49,O:50,P:51,Q:52,R:53,S:54,T:55,U:56,V:57,W:58,X:59,Y:60,
Z:61,"~":62,"!":63,"*":-1},g=function(b,w){for(var z=0,y=0,l=0;l<b.length;l++){if(w<z+b[l].length)return h[b[l][w-z]]+y;z+=b[l].length;y+=64}},m=[1E6,1E5,1E4,1E3,100,10,1],v=function(b,w,z){z=12622752E5;var y=n;if(null!=b){var l=b.info;if(null!=l&&"1"==l.compressed){if(null==w&&(w=b.field,null==w))return;if(b.flgs){for(var u=null,x=0,d=0;d<w.length;d++)0<=w[d][1].indexOf("!")&&(null==u&&(u={}),u[w[d][0].toLowerCase()]=b.flgs[x++]);u&&(b.flags=u)}if(b.flags){u=b.flags;for(var t in u)for(d=0;d<u[t].length;d++)if(1<
u[t][d].length){x=u[t][d][0];var q=Array(u[t][d][0]).fill(u[t][d][1]);u[t]=u[t].slice(0,d).concat(q).concat(u[t].slice(d+1));d+=x-1}}if(b.data&&w)if("tree"==l.mode)for(l=0;l<w.length;l++)if("_expand"==w[l][0])for(d=0;d<b.data.length;d++)b.data[d]&&b.data[d][l]&&(b.data[d][l]=0==b.data[d][l]?"":1==b.data[d][l]?"-":"+");else{if("_path"==w[l][0]){z="";y=-1;for(u=0;u<w.length&&"_level"!=w[u][0];u++);if(null!=u)for(d=0;d<b.data.length;d++)y==b.data[d][u]&&(b.data[d][l]=z),z=b.data[d][l],y=b.data[d][u]}}else if("col"==
l.rank)for(l=0;l<w.length;l++){if(null!=b.data[l]){if("g"!=w[l][1][0])if("c"==w[l][1]||"t"==w[l][1]||"t"==w[l][1][0]&&"0"<=w[l][1][1]&&"9">=w[l][1][1])for(d=0;d<b.data[l].length;d++)"Array"==b.data[l][d].constructor.name&&(x=b.data[l][d][0],q=Array(b.data[l][d][0]).fill(b.data[l][d][1]),b.data[l]=b.data[l].slice(0,d).concat(q).concat(b.data[l].slice(d+1)),d+=x-1);else for(d=0;d<b.data[l].length;d++)b.data[l][d]&&1<b.data[l][d].length&&(x=b.data[l][d][0],q=Array(b.data[l][d][0]).fill(b.data[l][d][1]),
b.data[l]=b.data[l].slice(0,d).concat(q).concat(b.data[l].slice(d+1)),d+=x-1);if("ts"==w[l][1])for(b.data[l][0]*=1E3,b.data[l][0]+=z,d=1;d<b.data[l].length;d++)b.data[l][d]=null!=b.data[l][d]&&null!=b.data[l][d-1]?b.data[l][d-1]+1E3*b.data[l][d]:1E3*b.data[l][d];else if("tm"==w[l][1])for(b.data[l][0]*=6E4,b.data[l][0]+=z,d=1;d<b.data[l].length;d++)b.data[l][d]=null!=b.data[l][d]&&null!=b.data[l][d-1]?b.data[l][d-1]+6E4*b.data[l][d]:6E4*b.data[l][d];else if("tms"==w[l][1])for(b.data[l][0]+=z,d=1;d<
b.data[l].length;d++)null!=b.data[l][d]&&null!=b.data[l][d-1]&&(b.data[l][d]=b.data[l][d-1]+b.data[l][d]);else if("x"==w[l][1][0])if(b.flags&&b.flags[w[l][0].toLowerCase()])for(u=b.flags[w[l][0].toLowerCase()],d=1;d<b.data[l].length;d++)null!=b.data[l][d]&&null!=b.data[l][d-1]&&(u[d]>>5==u[d-1]>>5?b.data[l][d]+=b.data[l][d-1]:(x=(u[d-1]>>5&7)-1,-1==x&&(x=parseInt(w[l][1][1])),q=(u[d]>>5&7)-1,-1==q&&(q=parseInt(w[l][1][1])),b.data[l][d]=parseInt(((b.data[l][d-1]*m[x]+b.data[l][d]*m[x>q?x:q])/m[q]).toFixed(0))));
else for(d=1;d<b.data[l].length;d++)null!=b.data[l][d]&&null!=b.data[l][d-1]&&(b.data[l][d]+=b.data[l][d-1]);else if("dd"==w[l][1]||"dq"==w[l][1]||"dm"==w[l][1]){if(0<b.data[l].length)for(b.data[l][0]+=y,d=1;d<b.data[l].length;d++)null!=b.data[l][d]&&null!=b.data[l][d-1]&&(b.data[l][d]+=b.data[l][d-1])}else if("dy"==w[l][1]&&0<b.data[l].length)for(b.data[l][0]*=1E4,d=1;d<b.data[l].length;d++)b.data[l][d]=null!=b.data[l][d]&&null!=b.data[l][d-1]?1E4*b.data[l][d]+b.data[l][d-1]:1E4*b.data[l][d]}}else if("row"==
l.rank)for(l=0;l<w.length;l++)if("dd"==w[l][1]||"dq"==w[l][1]||"dm"==w[l][1]){if(0<b.data.length)for(d=0;d<b.data.length;d++)b.data[d][l]+=y}else if("dy"==w[l][1]){if(0<b.data.length)for(d=0;d<b.data.length;d++)b.data[d][l]*=1E4}else if("ti"==w[l][1])for(d=0;d<b.data.length;d++){if(b.data[d]&&b.data[d][l])for(u=x=0;u<b.data[d][l].length;u++)b.data[d][l][u][0]+=x,x=b.data[d][l][u][0],b.data[d][l][u][0]*=1E3,b.data[d][l][u][1]+=x,x=b.data[d][l][u][1],b.data[d][l][u][1]*=1E3}else if("g"==w[l][1][0])for(d=
0;d<b.data.length;d++){if(b.data[d]&&b.data[d][l]&&b.data[d][l][2])for(u=q=0;u<b.data[d][l][2];u++)if(b.data[d][l][u+3])for(x=1;x<b.data[d][l][u+3].length;x++)b.data[d][l][u+3][x]+=q,q=b.data[d][l][u+3][x]}else if("ts"==w[l][1])for(d=0;d<b.data.length;d++)b.data[d]&&b.data[d][l]&&(b.data[d][l]*=1E3,b.data[d][l]+=z);else if("tm"==w[l][1])for(d=0;d<b.data.length;d++)b.data[d]&&b.data[d][l]&&(b.data[d][l]*=6E4,b.data[d][l]+=z);else if("tms"==w[l][1])for(d=0;d<b.data.length;d++)b.data[d]&&b.data[d][l]&&
(b.data[d][l]+=z);if(b.modify){if(b.modify.record)for(l=1,d=0;d<b.modify.record.length;d++)b.modify.record[d]+=l,l=b.modify.record[d];if(b.modify.flgs&&w){u=null;for(d=x=0;d<w.length;d++)0<=w[d][1].indexOf("!")&&(null==u&&(u={}),u[w[d][0].toLowerCase()]=b.modify.flgs[x++]);u&&(b.modify.flags=u)}if(b.modify.flags)for(t in u=b.modify.flags,u)for(d=0;d<u[t].length;d++)1<u[t][d].length&&(q=Array(u[t][d][0]).fill(u[t][d][1]),u[t]=u[t].slice(0,d).concat(q).concat(u[t].slice(d+1)))}}}},n=18980101,p=function(b,
w,z){var y=w.info,l=w.data;w=w.flags;var u=b.info,x=b.data;if(l){if("row"==y.rank){var d=a(z,l,w);if(d)if(y.thisBegin<u.dataBegin){for(var t=u.dataBegin-y.thisBegin,q=0;q<t;q++)x.unshift(null);for(q=0;q<d.length;q++)x[q]=d[q];if(w)for(var D in w){if(null==b.flags[D.toLowerCase()])b.flags[D.toLowerCase()]=[];else for(q=0;q<t;q++)b.flags[D.toLowerCase()].unshift(null);for(q=0;q<w[D].length;q++)b.flags[D.toLowerCase()][q]=w[D][q]}y.dataBegin=y.thisBegin}else if(y.thisBegin>=u.dataBegin){q=t=y.thisBegin-
u.dataBegin;for(l=0;l<d.length;q++,l++)x[q]=d[l];if(w)for(D in w)for(null==b.flags[D.toLowerCase()]&&(b.flags[D.toLowerCase()]=[]),q=t,l=0;l<w[D].length;q++,l++)b.flags[D.toLowerCase()][q]=w[D][l];y.dataBegin=u.dataBegin}y.dataRows=x.length}else{if(d=c(z,l,w))if(y.thisBegin<u.dataBegin){t=u.dataBegin-y.thisBegin;for(var A=0;A<z.length;A++){for(q=0;q<t;q++)x[A].unshift(null);for(q=0;q<d[A].length;q++)x[A][q]=d[A][q]}if(w)for(D in w){if(null==b.flags[D.toLowerCase()])b.flags[D.toLowerCase()]=[];else for(q=
0;q<t;q++)b.flags[D.toLowerCase()].unshift(null);for(q=0;q<w[D].length;q++)b.flags[D.toLowerCase()][q]=w[D][q]}y.dataBegin=y.thisBegin}else if(y.thisBegin>=u.dataBegin){t=y.thisBegin-u.dataBegin;for(A=0;A<z.length;A++)for(null==x[A]&&(x[A]=[]),q=t,l=0;l<d[A].length;q++,l++)x[A][q]=d[A][l];if(w)for(D in w)for(null==b.flags[D.toLowerCase()]&&(b.flags[D.toLowerCase()]=[]),q=t,l=0;l<w[D].length;q++,l++)b.flags[D.toLowerCase()][q]=w[D][l];y.dataBegin=u.dataBegin}y.dataRows=x&&x[0]?x[0].length:0}u.dataRows=
y.dataRows;u.dataBegin=y.dataBegin}else if(0==y.totalRows){if("row"==y.rank)b.data=[];else for(b.data=[],A=0;A<z.length;A++)b.data[A]=null;u.dataRows=0;u.dataBegin=0}}}GDataIncAnalysis.sharedInstance=function(){null==this.instance&&(this.instance=new GDataIncAnalysis);return this.instance};function GDataManager(){var a=function(e,h){var g=GRequestManager.getItemsWithId(e);if(g&&null!=g.onCallback)g.onCallback(h);else null!=GSDK_HOOK.getOnCallback()&&(g=GDataSourceManager.sharedInstance(),h=g.getDataSourceWithId(e),e={id:e,data:h},GSDK_HOOK.getOnCallback()(e))},c=function(e){var h=e[1];switch(e[0]){case "t":switch(h){case void 0:case "a":return GDataType.dtString;case "h":case "m":case "s":return GDataType.dtInt64}case "i":case "d":case "t":return GDataType.dtInt;case "f":case "x":return GDataType.dtFloat;
case "g":return GDataType.dtArray}},f=function(e,h){var g=GDataSetManager.sharedInstance(),m=GDataSourceManager.sharedInstance();g=g.getDataSetWithId(e);var v=0;h=h.result;if(0!=h.length){var n=h[0].table;var p=n.field;var b=n.data;var w=n.info;h=w.name;var z=w.totalRows;var y=w.begin;var l=(null!=b[0]?b[0]:[]).length;if("row"==w.rank){w=[];for(var u=0;u<l;u++){w[u]=[];for(var x=0;x<b.length;x++)w[u][x]=b[x][u]}n.info.rank="col";n.data=w;l=0<w.length?w[0].length:0}n=xDeepCopy(n);m.setDataSetSourceWithId(e,
n);g.rowCount=l;if(null!=p){e={};for(m=0;m<p.length;m++)v=new GColumnInfo,l=p[m][0],n=p[m][1],e[l]=v,v.index=m+1,v.name=l,v.dataType=c(n),v.data=n;g.columnInfos=e;v=p.length}g.name=h;g.begin=y;g.colCount=v;g.totalRows=z;return g}};this.fireData=function(e){var h=e.type,g=e.params;if("undefined"!=typeof g.limit&&-1!=g.limit.indexOf(",")){var m=g.limit.split(",");m[0]=parseInt(m[0]);m[1]=parseInt(m[1])}"http"==h?null!=m&&(e.limit=m,delete e.params.limit):"quote"==h&&(null!=m&&(g.limit=m),g.function=
"select",GDataTool.wsParamsFlatten(e,g));a:{m=GDataSourceManager.sharedInstance();var v=e.objectId;if(0==m.isDataSourceWithId(v)){var n=GDataSetManager.sharedInstance(),p=new GDataSet;n.addDataSetWithId(v,p);if("quote"==h&&(n=e.params,1==n.url.endsWith("/day")||1==n.url.endsWith("/trend")||1==n.url.endsWith("/minute")||1==n.url.endsWith("/minute5"))){m.addDataSourceWithId(v,{cacheWindow:!0});break a}m.addDataSourceWithId(v,{})}}"http"==h?(g=GDataTool.httpParamsToString(g),g={name:"staic",requestId:e.requestId,
field:e.field,condition:g},null!=e.limit&&(g.limit=e.limit),g=GDataTool.generateHttpMessage("Api","sdk",""+e.objectId,g),GANetwork.sendHttp(e.url,"["+g+"]")):"quote"==h&&(h=GDataTool.wsParamsToString(g),h={name:"quote",requestId:e.requestId,sql:h},null!=g.limit&&(h.limit=g.limit),e=GDataTool.generateWsMessage("Api","sdk",""+e.objectId,h),GANetwork.send(e))};this.receiveWSData=function(e,h){if("quote"==e)for(e=0;e<h.length;e++){var g=h[e].gid.idx,m=GDataSourceManager.sharedInstance(),v=GDataIncAnalysis.sharedInstance(),
n=m.getDataSourceWithId(g);v=v.socketDecode(n,h[e]);m.setDataSourceWithId(g,xDeepCopy(v));m=f(g,v);a(g,m)}};this.receiveHTTPData=function(e){for(var h=0;h<e.length;h++){var g=e[h].gid.idx,m=GDataSourceManager.sharedInstance(),v=GDataIncAnalysis.sharedInstance(),n=m.getDataSourceWithId(g);v=v.httpDecode(n,e[h]);m.setDataSourceWithId(g,xDeepCopy(v));m=f(g,v);a(g,m)}}}GDataManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataManager);return this.instance};
function GDataSourceManager(){var a={},c={};this.addDataSourceWithId=function(f,e){null==a[f]&&(a[f]=e)};this.getDataSourceWithId=function(f){return a[f]};this.setDataSourceWithId=function(f,e){return null!=a[f]?(a[f]=e,!0):!1};this.delDataSourceWithId=function(f){return null!=a[f]?delete a[f]:!1};this.getAllDataSource=function(){return a};this.clearAllDataSource=function(){a={}};this.isDataSourceWithId=function(f){return null!=a[f]?!0:!1};this.setDataSetSourceWithId=function(f,e){c[f]=e};this.getDataSetSourceWithId=
function(f){return c[f]}}GDataSourceManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataSourceManager);return this.instance};function GDataSetManager(){var a={};this.addDataSetWithId=function(c,f){null==a[c]&&(f.id=c,a[c]=f)};this.getDataSetWithId=function(c){return a[c]};this.setDataSetWithId=function(c,f){return null!=a[c]?(a[c]=f,!0):!1};this.delDataSetWithId=function(c){return null!=a[c]?delete a[c]:!1};this.getAllDataSet=function(){return a}}
GDataSetManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataSetManager);return this.instance};function GDataTool(){this.describe="\u5de5\u5177\u7c7b"}
GDataTool.httpParamsToString=function(a){var c=[],f;for(f in a)if("condition"==f)c.push(a[f]);else switch(a[f].constructor.name.toLowerCase()){case "string":c.push(f+" = '"+a[f]+"'");break;case "number":c.push(f+" = "+a[f]);break;case "array":for(var e="[",h=0;h<a[f].length;h++){var g=a[f][h];switch(g.constructor.name.toLowerCase()){case "string":e+=0==h?"'"+g+"'":",'"+g+"'";break;case "number":e+=0==h?""+g:","+g}}e+="]";c.push(f+" = "+e)}for(a=0;a<c.length;a++)var m=0==a?c[a]:m+(" and "+c[a]);return m};
GDataTool.generateHttpMessage=function(a,c,f,e){var h={lang:"zh-cn",gid:{fm:"",pg:"",idx:""},http:[]};h.gid.fm=a;h.gid.pg=c;h.gid.idx=f;a=GDataTool.packHttpMessage(e);h.http.push(a);return JSON.stringify(h)};
GDataTool.packHttpMessage=function(a){var c={gid:{name:"",id:""},field:[],condition:{}};for(f in a)null!=c[f]&&(c[f]="field"!=f||null!=a[f]&&""!=a[f]?a[f]:[]);c.gid={name:a.name,id:a.requestId};if(null!=c.field&&0<c.field.length){var f=c.field.split(",");for(var e=[],h=0;h<f.length;h++){var g=f[h].replace(/ /g,"");g=trim(g);g=g.toLowerCase();e.push(g)}c.field=e}if(null!=c.condition&&null!=a.condition){f=a.condition;var m;null!=a.must&&(m=a.must.split(","));f=GAnalysisES(f,m);m=f.esCondition;if(0==
f.mustCheckStatu)return;null!=a.param&&(m.param=a.param);c.condition=m}null!=a.limit&&0<a.limit.length?a.batchMode&&"limit"==a.batchMode.toLowerCase()?(c.from=a.limit[0],c.fromSize=a.limit[1]):(c.pageNo=a.limit[0],c.pageSize=a.limit[1]):(c.pageNo=null!=a.pageNo?a.pageNo:"0",c.pageSize=null!=a.pageSize?a.pageSize:"10");return c};
GDataTool.wsParamsToString=function(a){var c={type:null,field:null,from:null,where:null,date:null,last:null,resample:null,relation:null,includeFlags:null,subscribe:null,orderby:null},f;for(f in a){var e=a[f];switch(f.toLowerCase()){case "function":c.type=e;break;case "field":c.field=e;break;case "url":c.from="from "+e;if(null!=a.keys){e=c.from.split("/");for(var h=a.keys.split(","),g=1;g<e.length;g++){var m=trim(h[g-1]);e[g]=e[g]+"("+m+")"}c.from=e.join("/")}break;case "date":c.date="at "+e;break;
case "last":c.last="at last "+e;break;case "condition":c.where="where "+e;break;case "resample":c.resample="resample("+e+")";break;case "relations":c.relation="relation("+e+")";break;case "includeflags":1==e&&(c.includeFlags="include flags");break;case "subscribe":1==e&&(c.subscribe="sub 100");break;case "orderby":c.orderby="order by "+e}}var v;for(v in c)if(null!=c[v]){a=c[v];var n="type"===v?a:n+(" "+a)}return n};
GDataTool.generateWsMessage=function(a,c,f,e){a={lang:"zh-cn",gid:{fm:a,pg:c,idx:f}};c=[];e=GDataTool.packWsMessage(e);null!=e.limit&&(e.limit=e.limit[0]+","+e.limit[1]);c.push(e);e=makeMessageString(JSON.stringify(c));a.sql=e;return JSON.stringify(a)};GDataTool.packWsMessage=function(a,c){c={gid:{name:a.name,id:a.requestId,idx:void 0===c?0:c},type:"query"};c.sql=a.sql;null!=a.limit&&(c.limit=a.limit);return c};
GDataTool.wsParamsFlatten=function(a,c){for(var f in a)null!=a[f]&&("Object"==a[f].constructor.name?GDataTool.wsParamsFlatten(a[f],c):c[f]=a[f])};
GDataTool.getValueFormatString=function(a,c,f,e,h){if(null==a)return null!=f&&0<=f.indexOf("%N")?"-":"";if(e&&3==(e&3))return"-";if("Array"==a.constructor.name){if("ti"==c){f="";for(var g=0;g<a.length;g++)f+="["+getValueFormatString(a[g][0],"tm","HH:mm")+","+getValueFormatString(a[g][1],"tm","HH:mm")+"] ";return f}return JSON.stringify(a)}"%d"==f&&(c="i");g=2;c&&("i"==c[0]?g=0:1<c.length&&(g=parseInt(c.slice(1))));var m=GDataTool.isTextType(c),v="Number"==a.constructor.name?!0:!1;h&&h.unit&&1<h.unit&&
v?(a/=h.unit,h=""+a,v=h.indexOf("."),c=0<=v?2<h.length-v-1?"f2":"f"+(h.length-v-1):"f"):(null==c||m)&&v&&(m=!1,h=""+a,v=h.indexOf("."),0<=v?(c="f"+(h.length-v-1),g=h.length-v-1):(c="f",g=0));h=a;if(void 0!=f){if(m){if("."==f[0]){if(m=a.indexOf("."),-1!=m)return a.slice(0,m)}else if("["==f[0])return v=parseInt(f.slice(1)),a.slice(0,v);return a}if(0==a&&0<=f.indexOf("%0"))return"-";m=f.indexOf("%B");0<=m&&(h=-1,null!=e&&(h=(e>>5&7)-1),0>h&&(h=1<c.length?parseInt(c.slice(1)):0),a/=Math.pow(10,h),5<=
a||-5>=a)&&(a=Math.round(a));h=a;var n=f;for(v=0;8>v;v++)if(m=f.indexOf("%."+v),-1!=m){if("string"==typeof a)return void 0!=f&&0<=f.indexOf("%%")?a+"%":a;h=a.toFixed(v);void 0!=f&&0<=f.indexOf("%%")&&(h+="%");g=v;break}-1!=f.indexOf("%V")&&(n=xGlobal.integerFormat,null==n&&(n="%5K"));m=n.indexOf("%,");if(0<=m){h+="";a=h.length;for(m=a-1;0<m;m--)if("."==h[m]){a=m;break}if(3<a)for(m=a-3;0<m&&"-"!=h.slice(0,m);m-=3)h=h.slice(0,m)+","+h.slice(m);return h}m=0<=n.indexOf("%K")?0:0<=n.indexOf("%0K")?0:0<=
n.indexOf("%1K")?1:0<=n.indexOf("%2K")?2:0<=n.indexOf("%3K")?3:0<=n.indexOf("%4K")?4:0<=n.indexOf("%5K")?5:0<=n.indexOf("%6K")?6:0<=n.indexOf("%7K")?7:0<=n.indexOf("%8K")?8:-1;if(0<=m){c=!1;0>a&&(a=Math.abs(a),c=!0);f="";1E3>a?h=a.toFixed(g):1E6>a?(0<m&&(g=3),h=(a/1E3).toFixed(g),f="K"):1E9>a?(0<m&&(g=3),h=(a/1E6).toFixed(g),f="M"):1E12>a?(0<m&&(g=3),h=(a/1E9).toFixed(g),f="B"):(0<m&&(g=3),h=(a/1E12).toFixed(g),f="T");0==m||0==g||h.length<=m||g==g+m-h.length+1||(g=g+m-h.length+1,0>g&&(g=0),a=parseFloat(h),
h=a.toFixed(g));1==c&&(h="-"+h);if(0<g)for(g=h.length-1;0<g;g--)if("0"!=h[g]){h=h.substr(0,g+1);"."==h[h.length-1]&&(h=h.substr(0,h.length-1));break}return h+f}m=0<=n.indexOf("%W")?0:0<=n.indexOf("%0W")?0:0<=n.indexOf("%1W")?1:0<=n.indexOf("%2W")?2:0<=n.indexOf("%3W")?3:0<=n.indexOf("%4W")?4:0<=n.indexOf("%5W")?5:0<=n.indexOf("%6W")?6:0<=n.indexOf("%7W")?7:0<=n.indexOf("%8W")?8:-1;if("string"==typeof a)return"-";if(0<=m)return c=!1,0>a&&(a=Math.abs(a),c=!0),f="",1E4>a?h=a.toFixed(g):1E8>a?(0<m&&(g=
3),h=(a/1E4).toFixed(g),f="\u4e07"):1E12>a?(0<m&&(g=3),h=(a/1E8).toFixed(g),f="\u4ebf"):(0<m&&(g=3),h=(a/1E12).toFixed(g),f="\u4e07\u4ebf"),0==m||0==g||h.length<=m||g==g+m-h.length+1||(g=g+m-h.length+1,0>g&&(g=0),a=parseFloat(h),h=a.toFixed(g)),1==c&&(h="-"+h),h+f}if(void 0!=c)if("f"==c[0]||"x"==c[0])null!=e&&0<(e>>5&7)&&(g=(e>>5&7)-1),void 0!=f&&0<=f.indexOf("%+")&&0<=a?h="+"+a.toFixed(g):"number"==typeof a&&(h=a.toFixed(g)),void 0!=f&&0<=f.indexOf("%%")&&(h+="%");else if("i"==c[0]){if(void 0!=f&&
0<=f.indexOf("%+")&&0<=a)return"+"+a}else{if("d"==c)return a=""+a,a.slice(0,4)+"/"+a.slice(4,6)+"/"+a.slice(6,8);if("th"==c||"tm"==c||"ts"==c||"tms"==c||"dd"==c||"dm"==c||"dq"==c||"dy"==c){if("string"==typeof a)return a;e=!1;g=new Date;29991231>a&&("dd"==c||"dm"==c||"dq"==c||"dy"==c)?(g.setFullYear(parseInt(a/1E4),parseInt(a/100%100)-1,parseInt(a%100)),e=!0):g.setTime(a);0==e&&xGlobal.utcTime?(a=g.getUTCFullYear()+"/"+GDataTool.getValidDateTime(g.getUTCMonth()+1)+"/"+GDataTool.getValidDateTime(g.getUTCDate()),
h=GDataTool.getValidDateTime(g.getUTCHours())+":"+GDataTool.getValidDateTime(g.getUTCMinutes())+":"+GDataTool.getValidDateTime(g.getUTCSeconds())):(a=g.getFullYear()+"/"+GDataTool.getValidDateTime(g.getMonth()+1)+"/"+GDataTool.getValidDateTime(g.getDate()),h=GDataTool.getValidDateTime(g.getHours())+":"+GDataTool.getValidDateTime(g.getMinutes())+":"+GDataTool.getValidDateTime(g.getSeconds()));f?(h=f,0==e&&xGlobal.utcTime?(h=h.replace("YYYY",g.getUTCFullYear()),h=h.replace("YY",GDataTool.getValidDateTime(g.getUTCFullYear()%
100)),h=h.replace("MM",GDataTool.getValidDateTime(g.getUTCMonth()+1)),h=h.replace("DD",GDataTool.getValidDateTime(g.getUTCDate())),h=h.replace("HH",GDataTool.getValidDateTime(g.getUTCHours())),h=h.replace("mm",GDataTool.getValidDateTime(g.getUTCMinutes())),h=h.replace("SS",GDataTool.getValidDateTime(g.getUTCSeconds())),h=h.replace("WEEK",xGlobal.weekString_local[g.getUTCDay()])):(h=h.replace("YYYY",g.getFullYear()),h=h.replace("YY",GDataTool.getValidDateTime(g.getUTCFullYear()%100)),h=h.replace("MM",
GDataTool.getValidDateTime(g.getMonth()+1)),h=h.replace("WEEK",xGlobal.weekString_local[g.getUTCDay()]),0==e?(h=h.replace("DD",GDataTool.getValidDateTime(g.getDate())),h=h.replace("HH",GDataTool.getValidDateTime(g.getHours())),h=h.replace("mm",GDataTool.getValidDateTime(g.getMinutes())),h=h.replace("SS",GDataTool.getValidDateTime(g.getSeconds()))):(h=h.replace("DD,",GDataTool.getValidDateTime(g.getDate())),h=h.replace("DD",GDataTool.getValidDateTime(g.getDate())),h=h.replace("HH:",""),h=h.replace("mm:",
""),h=h.replace("SS",""),h=h.replace("HH",""),h=h.replace("mm","")))):h=e?a:a+", "+h;return h}if("ti"==c)for(h="",m=0;m<a.length;m++)f=new Date,f.setTime(a[m][0]),g=new Date,g.setTime(a[m][1]),h+="["+GDataTool.getValidDateTime(f.getHours())+":"+GDataTool.getValidDateTime(f.getMinutes())+","+GDataTool.getValidDateTime(g.getHours())+":"+GDataTool.getValidDateTime(g.getMinutes())+"] "}return h};GDataTool.isTextType=function(a){return null==a||"c"==a||"t"==a||"t"==a[0]&&"1"<=a[1]&&"9">=a[1]?!0:!1};
GDataTool.getValidDateTime=function(a){return 10>a?"0"+a:""+a};GDataTool.GETGFLAG_ISARROW_EQ=function(a){return 0==(a&3)?!0:!1};GDataTool.GETGFLAG_ISARROW_UP=function(a){return 1==(a&3)?!0:!1};GDataTool.GETGFLAG_ISARROW_DN=function(a){return 2==(a&3)?!0:!1};GDataTool.GETGFLAG_ISINVALID=function(a){return 3==(a&3)?!0:!1};GDataTool.GETGFLAG_COLOR=function(a){return a>>2&3};GDataTool.GETGFLAG_DEC=function(a){return a>>5&7?(a>>5&7)-1:-1};
GDataTool.GET_UP_DOWN_FLAGS=function(a){if(1==GDataTool.GETGFLAG_ISARROW_EQ(a))return 0;if(1==GDataTool.GETGFLAG_ISARROW_UP(a))return 1;if(1==GDataTool.GETGFLAG_ISARROW_DN(a))return 2};var xGlobal={};function GRequestManager(){this.requestList={}}GRequestManager.sharedInstance=function(){null==this.instance&&(this.instance=new GRequestManager);return this.instance};GRequestManager.requestList=GRequestManager.sharedInstance().requestList;GRequestManager.addItems=function(a){GRequestManager.requestList[a.id]=a};GRequestManager.getAllRequestItems=function(){return GRequestManager.requestList};GRequestManager.getItemsWithId=function(a){return GRequestManager.requestList[a]};
GRequestManager.deleteItemsWithId=function(a){var c=GRequestManager.requestList[a];c&&c.stop&&c.stop();return delete GRequestManager.requestList[a]};function GANetwork(){}GANetwork.send=function(a,c){c=void 0===c?null:c;(c=GWsManagers.sharedInstance().getWsWithType(null==c?"quote":c))?c.send(a):GSDKLog.error("ws\u672a\u521d\u59cb\u5316")};GANetwork.sendHttp=function(a,c){var f=GANetwork.getAHttpRequest();f.setUrl(GSession.sharedInstance().getHttpUrl()+a);f.setBody(c);f.send().then(function(e){GDataManager.sharedInstance().receiveHTTPData(e)}).catch(function(e){console.log(e);GSDKLog.log(e)})};GANetwork.getHttpRequest=function(){return new GHttp};
GANetwork.getAHttpRequest=function(){return new function(){var a=this;GHttp.call(this);this.send=function(){return new Promise(function(c,f){var e=getEnvInfo();if("web"==e){e=new webHttpRequest;e.onSuccess=function(p){"Array"!=p.constructor.name&&(p=[p]);if(1!=p[0].status){var b=new GMessage;b.message=p[0].msg;b.code=500;p=Error(JSON.stringify(b));f(p)}else c(p)};e.onFail=function(p){p="\u8fde\u63a5\u670d\u52a1\u5931\u8d25[\u8fd4\u56de\u7801:"+p.status+"],\u8bf7\u4e0e\u5ba2\u670d\u4eba\u5458\u8054\u7cfb.";
var b=new GMessage;b.message=p;b.code=500;p=Error(JSON.stringify(b));f(p)};a.setType("post");a.setHeader("Content-Type","application/json");var h=GTenant.sharedInstance().getUserData();h&&h.access_token&&a.setHeader("Authorization","Bearer "+h.access_token);h=a.getUrl();var g=a.getType(),m=a.getHeader(),v=a.getBody(),n=a.getParam();e.send(h,g,m,v,n)}else"node"==e&&GSDKlog.info("\u8fd4\u56denode Http\u5bf9\u8c61")})}}};function GEncoded(){this.byteToString=function(a){if("string"===typeof a)return a;for(var c="",f=0;f<a.length;f++){var e=a[f].toString(2),h=e.match(/^1+?(?=0)/);if(h&&8==e.length){e=h[0].length;h=a[f].toString(2).slice(7-e);for(var g=1;g<e;g++)h+=a[g+f].toString(2).slice(2);c+=String.fromCharCode(parseInt(h,2));f+=e-1}else c+=String.fromCharCode(a[f])}return c}}GEncoded.sharedInstance=function(){null==this.instance&&(this.instance=new GEncoded);return this.instance};
function xEnDecoder(a){var c=this;_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";_varStr="ABuvwxyz_456CDEFG$123HIJKLMWXYZabcdefgNOPQRSTUVhijklmnopqrst7890";if(a){a+="";for(var f=0,e=0;e<a.length;e++)f+=a.charCodeAt(e)+e;for(a=0;2>a;a++){var h=3.141592653589793;for(e=0;8>e;e++){h*=h;var g=(f*h+"").split(".");g=(g[0]+g[1]).substr(0,16);g=parseInt(g);for(var m=0;8>m;m++){var v=g%100;v%=_keyStr.length;g=parseInt(g/100);var n=g%100;g=parseInt(g/100);if(0<v&&v<_keyStr.length-
1)if(v+n>=_keyStr.length){n=_keyStr.length-v;var p=_keyStr.substr(0,v),b=_keyStr.substr(v,n);_keyStr=b+p}else p=_keyStr.substr(0,v),b=_keyStr.substr(v,n),v=_keyStr.substr(v+n),_keyStr=b+p+v}}}}this.encode=function(x){var d="",t=0;for(x=_utf8_encode(x);t<x.length;){var q=x.charCodeAt(t++);var D=x.charCodeAt(t++);var A=x.charCodeAt(t++);var G=q>>2;q=(q&3)<<4|D>>4;var B=(D&15)<<2|A>>6;var I=A&63;isNaN(D)?B=I=64:isNaN(A)&&(I=64);d=d+_keyStr.charAt(G)+_keyStr.charAt(q)+_keyStr.charAt(B)+_keyStr.charAt(I)}return d};
this.decode=function(x){var d="",t=0;for(x=x.replace(/[^A-Za-z0-9\+\/=]/g,"");t<x.length;){var q=_keyStr.indexOf(x.charAt(t++));var D=_keyStr.indexOf(x.charAt(t++));var A=_keyStr.indexOf(x.charAt(t++));var G=_keyStr.indexOf(x.charAt(t++));q=q<<2|D>>4;D=(D&15)<<4|A>>2;var B=(A&3)<<6|G;d+=String.fromCharCode(q);64!=A&&(d+=String.fromCharCode(D));64!=G&&(d+=String.fromCharCode(B))}return d=_utf8_decode(d)};_utf8_encode=function(x){x=x.replace(/\r\n/g,"\n");for(var d="",t=0;t<x.length;t++){var q=x.charCodeAt(t);
128>q?d+=String.fromCharCode(q):(127<q&&2048>q?d+=String.fromCharCode(q>>6|192):(d+=String.fromCharCode(q>>12|224),d+=String.fromCharCode(q>>6&63|128)),d+=String.fromCharCode(q&63|128))}return d};_utf8_decode=function(x){var d="",t=0;for(c1=c2=0;t<x.length;){var q=x.charCodeAt(t);128>q?(d+=String.fromCharCode(q),t++):191<q&&224>q?(c2=x.charCodeAt(t+1),d+=String.fromCharCode((q&31)<<6|c2&63),t+=2):(c2=x.charCodeAt(t+1),c3=x.charCodeAt(t+2),isNaN(c3)||(d+=String.fromCharCode((q&15)<<12|(c2&63)<<6|c3&
63)),t+=3)}return d};var w=function(x,d,t){"("==t?t=")":"["==t&&(t="]");for(d++;d<x.length;d++)if("("==x[d]||"["==x[d]){if(d=w(x,d,x[d]),null==d)break}else if(x[d]==t)return d},z=function(x,d,t){for(d++;d<x.length;d++)if(x[d]==t)return d},y=function(x,d){a:{for(;d<x.length&&(" "==x[d]||"\t"!=x[d]);)break a;d=void 0}var t;for(t=d;d<x.length;d++)if("["==x[d])d=w(x,d,x[d]);else if(" "==x[d]||"\t"==x[d]||"\n"==x[d]||";"==x[d]||","==x[d]||"?"==x[d]||":"==x[d]||"{"==x[d]||"("==x[d]||'"'==x[d]||"'"==x[d])return{i:d,
word:x.substr(t,d-t)};return{i:d,word:x.substr(t)}},l=function(){var x=parseInt(64*Math.random())%16;10>x&&(x=10);for(var d="",t=0;t<x;t++){var q=parseInt(100*Math.random())%54;d+=_varStr[q]}return"0"<=d[0]&&"9">=d[0]?l():d},u=function(x){for(var d="",t=0,q=0;q<x.length;q++)if("("==x[q]||"["==x[q]){d+=x.substr(t,q-t+1);t=q;q=w(x,q,x[q]);if(null==q)return;t=u(x.substr(t+1,q-t-1));d+=t.code;t=q}else if('"'==x[q]||"'"==x[q]){var D=x[q],A="";d+=x.substr(t,q-t+1);for(q++;q<x.length;q++){if(x[q]==D){t=
q;d+=A;break}A+="\\x"+x.charCodeAt(q).toString(16)}}q>t&&(d+=x.substr(t,q-t));return{i:q,code:d}};this.obfuscateJsCode=function(x){for(var d="",t=0,q,D=[],A=0;A<x.length;A++)if("("==x[A]||"["==x[A]){if(A=w(x,A,x[A]),null==A)return}else if('"'==x[A]||"'"==x[A]){if(A=z(x,A,x[A]),null==A)return}else if("/"!=x[A]||"/"!=x[A+1]&&"*"!=x[A+1])if("\n"==x[A]||" "==x[A]||"\t"==x[A])d+=x.substr(t,A-t),t=A+1;else{q=y(x,A);if(null==q)return;A=q.i;if("var"==q.word){A++;q=y(x,A);if(null==q)return;D.push({word:q.word,
name:l()});A=q.i}("a"<=q.word[0]&&"z">=q.word[0]||"A"<=q.word[0]&&"Z">=q.word[0])&&"("==x[A]&&(t=c.encode(q.word),d+=t,t=A)}else if(q=A,"/"==x[A+1])for(A+=2;A<x.length;A++){if("\n"==x[A]){d+=x.substr(t,q-t);t=A+2;break}}else for(A+=2;A<x.length;A++)if("*"==x[A]&&"/"==x[A+1]){d+=x.substr(t,q-t);t=A+2;break}A>t&&(d+=x.substr(t,A-t));for(A=0;A<D.length;A++)q="newCode = newCode.replace(/(\\b"+D[A].word+"\\b)/g,'"+D[A].name+"')",eval(q);if(d=u(d))return d.code}};function GHttp(){var a,c,f,e,h;this.setUrl=function(g){a=g};this.getUrl=function(){return a};this.setHeader=function(g,m){null==c&&(c={});c[g]=m};this.getHeader=function(){return c};this.setType=function(g){f=g};this.getType=function(){return f};this.setParam=function(g,m){null==e&&(e={});e[g]=m};this.getParam=function(){return e};this.setBody=function(g){h=g};this.getBody=function(){return h};this.send=function(){return new Promise(function(g,m){var v=getEnvInfo();"web"==v?(v=new webHttpRequest,
v.onSuccess=function(n){g(n)},v.onFail=function(n){m(n)},v.send(a,f,c,h,e)):"node"==v&&console.error("\u8fd4\u56denode Http\u5bf9\u8c61")})}}
function webHttpRequest(){var a=this;this.onSuccess;this.onFail;this.send=function(c,f,e,h,g){var m=new XMLHttpRequest;m.open(f,c);for(var v in e)null!=e[v]&&m.setRequestHeader(v,e[v]);c="";if(null!=h)c=h;else if(null!=g)if(f=f.toLowerCase(),"post"==f)c=JSON.stringify(g);else if("get"==f){f=0;for(var n in g)h=g[n],c=0==f?"?"+n+"="+h:c+("&"+n+"="+h),f++}m.send(c);GSDKLog.log("http\u53d1\u9001\u6570\u636e:"+c);m.onreadystatechange=function(){if(4==m.readyState)if(200==m.status){if(void 0!=m.responseText){var p=
m.responseText;p&&(p=JSON.parse(p),null!=a.onSuccess&&(a.onSuccess(p),GSDKLog.log("http\u63a5\u6536\u6570\u636e"+JSON.stringify(p))))}}else if(p={status:m.status},null!=a.onFail)a.onFail(p)}}};function GWsManagers(){var a={};this.addConnect=function(c,f){a[c]=f};this.getWsWithType=function(c){if(null!=a[c])return a[c]};this.getAllConnect=function(){return a};this.delWsWithType=function(c){null!=a[c]&&delete a[c]}}GWsManagers.sharedInstance=function(){null==this.instance&&(this.instance=new GWsManagers);return this.instance};function GWebsocket(){var a,c,f,e,h,g,m,v;this.setUrl=function(n){a=n};this.setType=function(n){};this.setProtocol=function(n){c=n};this.set_onOpen=function(n){e=n};this.set_onMessage=function(n){h=n};this.set_onClose=function(n){g=n};this.set_onError=function(n){m=n};this.setParams=function(n,p){null==f&&(f={});f[n]=p};this.send=function(n){v.readyState==v.OPEN?v.send(n):GSDKLog.log("ws\u672a\u8fde\u63a5")};this.close=function(n,p){v.close(n,p)};this.connect=function(){var n=getEnvInfo();if("web"==
n){v=new WebSocket(a,c);v.binaryType="arraybuffer";if(null!=f)for(var p in f)v[p]=f[p];v.onclose=g;v.onerror=m;v.onmessage=h;v.onopen=e}else"node"==n&&GSDKLog.error("\u8fd4\u56denode Http\u5bf9\u8c61")}};function GQuoteWs(){var a=this,c=this,f=null,e=null,h,g,m,v=0;this.quoteLogin=function(n,p,b,w,z){h=p;g=b;m=w;p=new GWebsocket;p.setParams("binaryType","arraybuffer");p.setUrl(n);p.setType("quote");p.setProtocol("gangtise");p.set_onOpen(a.onopen);p.set_onMessage(a.onmessage);p.set_onClose(a.onclose);p.set_onError(a.onerror);p.connect();f=z;GWsManagers.sharedInstance().addConnect("quote",p);c.webService=p};this.quoteLoginOut=function(n){c.webService.close(3999,"\u7528\u6237\u4e3b\u52a8\u9000\u51fa");
e=n};this.onopen=function(n){console.log("\u884c\u60c5\u8fde\u63a5\u5df2\u5f00\u542f");v=0;n=JSON.stringify({type:"login",gid:{pg:"1",idx:"-1"},account:h,userid:g,token:m});c.webService.send(n)};this.onmessage=function(n){var p=[];"{"==n.data[0]||"["==n.data[0]?n=n.data:(p=p.concat(Array.from(new Uint8Array(n.data))),n=29>p[0]?(new xGtsJason(json_dictionary)).decompress_json(p):GEncoded.sharedInstance().byteToString(p));console.log(n);results="["==n[0]?JSON.parse(n):[JSON.parse(n)];"login"==results[0].type?
f(!0):"close"==results[0].type?GSDKLog.log("\u5373\u5c06\u5173\u95ed",n):GDataManager.sharedInstance().receiveWSData("quote",results)};this.onclose=function(n){3999==n.code?e(!0):(console.log("onClose",n),n={code:n.code,message:n.reason},GSession.sharedInstance().quoteClose(n))};this.onerror=function(n){console.log("onError",n)};this.reload=function(){v++;GSession.sharedInstance().pushMsg("\u5f53\u524d\u6b63\u5728\u91cd\u8fde\uff0c\u91cd\u8fde\u7b2c"+v+"\u6b21",1002)}}
GQuoteWs.sharedInstance=function(){null==this.instance&&(this.instance=new GQuoteWs);return this.instance};function GService(){}GService.Path={tenantLogin:"thirdparty/login/tenantLogin",refreshToken:"auth/oauth/token?grant_type=refresh_token&refresh_token=",tenantLoginOut:"auth/oauth/logout"};
GService.tenantLoginApi=function(a){return new Promise(function(c,f){var e=GANetwork.getAHttpRequest();e.setUrl(GSession.sharedInstance().getHttpUrl()+GService.Path.tenantLogin);e.setBody(a);e.send().then(function(h){h=getTableForMap(h[0].result[0].table);var g={},m;for(m in h)g[m]=h[m].value;c(g)}).catch(function(h){console.log(h);f(h)})})};GService.tenantLoginOutApi=function(a,c){return new Promise(function(f,e){f({msg:"\u64cd\u4f5c\u6210\u529f\uff01",status:!0})})};
GService.refreshTokenApi=function(a,c){return new Promise(function(f,e){var h=GANetwork.getHttpRequest();h.setUrl(GSession.sharedInstance().getHttpUrl()+GService.Path.refreshToken+c);h.setType("post");h.setHeader("Content-Type","application/x-www-form-urlencoded");h.setHeader("Authorization","Basic "+a);h.send().then(function(g){if(void 0!=g.access_token)f(g);else{var m=new GMessage;m.message="Token\u5237\u65b0  "+g.msg;m.code=501;g=Error(JSON.stringify(m));e(g)}}).catch(function(g){console.log(g);
g="Token\u5237\u65b0, \u8fde\u63a5\u670d\u52a1\u5931\u8d25[\u8fd4\u56de\u7801:"+g.status+"],\u8bf7\u4e0e\u5ba2\u670d\u4eba\u5458\u8054\u7cfb.";var m=new GMessage;m.message=g;m.code=500;g=Error(JSON.stringify(m));e(g)})})};function GSession(){var a=this,c,f,e=function(){GTenant.sharedInstance().getToken().then(function(m){m=GTenant.sharedInstance().getUserData();h(m)}).catch(function(m){a.pushJsonMsg(m)})},h=function(m){var v=GSession.sharedInstance().getWSUrl(),n=m.tenantcode+"_"+m.userid,p=m.userid;m=m.access_token;GQuoteWs.sharedInstance().quoteLogin(v,n,p,m,function(b){var w=new GMessage;1==b?(w.message="\u767b\u5f55\u6210\u529f,\u884c\u60c5\u5df2\u5f00\u542f",w.code=2001):(w.message="\u884c\u60c5\u767b\u5f55\u5931\u8d25",
w.code=5001);GSDKLog.log("\u884c\u60c5\u767b\u5f55\u6210\u529f");a.pushNotification(w)})},g=function(m){c="ws://"+m+":9100/websocket";f="http://"+m+":9000/"};this.pushNotification=function(m){if(null!=GSDK.onNotification)GSDK.onNotification(m)};this.pushJsonMsg=function(m){try{var v=JSON.parse(m);a.pushMsg(v.message,v.code)}catch(n){console.log("errorJson\u4e0d\u662f\u4e00\u4e2aJson\u5bf9\u8c61")}};this.pushMsg=function(m,v){var n=new GMessage;n.message=m;n.code=v;a.pushNotification(n)};this.login=
function(m){GSDKLog.log("\u5f00\u59cb\u6267\u884c\u767b\u5f55\u6d41\u7a0b");null!=m.url?(GSDKLog.log("\u8bbe\u7f6e\u79df\u6237Url"),g(m.url),GSDKLog.log("\u5f00\u59cb\u6267\u884c\u79df\u6237\u767b\u5f55"),GTenant.sharedInstance().login(m).then(function(v){GSDKLog.log("\u79df\u6237\u767b\u5f55\u6210\u529f");return v}).then(function(v){GSDKLog.log("\u5f00\u59cb\u6267\u884c\u884c\u60c5\u767b\u5f55");h(v)}).catch(function(v){GSDKLog.log(v);a.pushJsonMsg(v.message)})):(m=new GMessage,m.message="\u672a\u8bbe\u7f6e\u79df\u6237url",
m.code=500,a.pushJsonMsg(JSON.stringify(m)))};this.loginOut=function(){GTenant.sharedInstance().loginOut().then(function(m){m;console.log(getNowSaftTime()+"    \u79df\u6237\u767b\u51fa\u6210\u529f!",m);return m}).then(function(m){a.clearUrl();GQuoteWs.sharedInstance().quoteLoginOut(function(v){var n=new GMessage;1==v?(n.message="\u767b\u51fa\u6210\u529f\uff0c\u884c\u60c5\u5df2\u65ad\u5f00",n.code=2002):(n.message="\u884c\u60c5\u767b\u51fa\u5931\u8d25",n.code=5002);a.pushNotification(n)})}).catch(function(m){console.log(m);
a.pushJsonMsg(m.message)})};this.quoteClose=function(m){a.pushMsg("\u884c\u60c5\u670d\u52a1\u5f02\u5e38\u65ad\u5f00",2003);console.log("\u884c\u60c5\u8fde\u63a5\u65ad\u5f00",m);e()};this.setProxyApi=function(){};this.getWSUrl=function(){return c};this.getHttpUrl=function(){return f};this.clearUrl=function(){f=c=null}}GSession.sharedInstance=function(){null==this.instance&&(this.instance=new GSession);return this.instance};var GSDK_HOOK=function(){};
GSDK_HOOK.start=function(){GSDK_HOOK.setOnNotification();GSDK_HOOK.setOnCallback();GSDK_HOOK.setOnRealLog()};GSDK_HOOK.setOnNotification=function(){"undefined"!=typeof sdk_cpp_notification?GSDK_HOOK.onNotification=sdk_cpp_notification:"undefined"!=typeof sdk_java_notification?GSDK_HOOK.onNotification=sdk_java_notification:"undefined"!=typeof sdk_oc_notification&&(GSDK_HOOK.onNotification=sdk_oc_notification);GSDK.onNotification=GSDK_HOOK.onNotification};
GSDK_HOOK.setOnRealLog=function(){"undefined"!=typeof sdk_cpp_log?GSDK_HOOK.onRealLog=sdk_cpp_log:"undefined"!=typeof sdk_java_log?GSDK_HOOK.onRealLog=sdk_java_log:"undefined"!=typeof sdk_oc_log&&(GSDK_HOOK.onRealLog=sdk_oc_log);GSDK.onRealLog=GSDK_HOOK.onRealLog};
GSDK_HOOK.setOnCallback=function(){"undefined"!=typeof sdk_cpp_callback?GSDK_HOOK.onCallback=sdk_cpp_callback:"undefined"!=typeof sdk_java_callback?GSDK_HOOK.onCallback=sdk_java_callback:"undefined"!=typeof sdk_oc_callback&&(GSDK_HOOK.onCallback=sdk_oc_callback)};GSDK_HOOK.getOnCallback=function(){return GSDK_HOOK.onCallback};GSDK_HOOK.getOnNotification=function(){return GSDK_HOOK.onNotification};GSDK_HOOK.getOnRealLog=function(){return GSDK_HOOK.onRealLog};function GTenant(){var a=this,c,f,e="R1RTX1RoaXJkX1BhcnR5Omdhbmd0aXNl",h,g=function(m){h=(new Date).getTime()+1E3*(parseInt(m.expires_in)-600);c=m};this.login=function(m){var v,n,p,b,w,z,y;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress){v=[];for(n in m)if(null!=m[n])switch(p=n.toLowerCase(),p){case "url":break;case "basic":e=m[n];break;default:v.push(n+" = '"+m[n]+"'")}b="";for(w=0;w<v.length;w++)b=0==w?v[w]:b+(" and "+v[w]);b=GAnalysisES(b);z=[{lang:"zh-cn",gid:{fm:"tenant"},
http:[{gid:{name:"tenantCheck"},type:"query",field:"access_token token_type refresh_token expires_in tenantid deviceType clientid tenantcode user_id".split(" "),condition:b.esCondition}]}];z=JSON.stringify(z);return l.yield(GService.tenantLoginApi(z).then(function(u){g(u);f=m;a.resetRefreshTokenTimer(u);GSDKLog.log("\u767b\u5f55\u6210\u529f\uff1a"+JSON.stringify(u));return u}).catch(function(u){GSDKLog.error("\u767b\u5f55\u5931\u8d25\uff1a"+u.message);throw Error(u.message);}),2)}y=l.yieldResult;
return l.return(y)})};this.loginOut=function(m){var v;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return n.yield(GService.tenantLoginOutApi().then(function(p){a.clearUserData();a.clearTimer();return p}).catch(function(p){console.log(p);throw Error(p.message);}),2);v=n.yieldResult;return n.return(v)})};this.getUserData=function(){return c};this.getUserArguments=function(){return f};this.getBasic=function(){return e};this.getToken=function(){return new Promise(function(m,
v){var n=(new Date).getTime(),p=c.access_token;n<h?m(p):(n=c.refresh_token,GService.refreshTokenApi(a.getBasic(),n).then(function(b){console.log(getNowSaftTime()+"    \u5237\u65b0Token\u6210\u529f!");g(b);a.resetRefreshTokenTimer(b);m(b.access_token)}).catch(function(b){console.log(b);a.login(f).then(function(w){m(w.access_token)}).catch(function(w){console.log(w);v(w.message)})}))})};this.refreshToken=function(m){m=m.refresh_token;GService.refreshTokenApi(a.getBasic(),m).then(function(v){console.log(getNowSaftTime()+
"    \u5237\u65b0Token\u6210\u529f!");g(v);a.resetRefreshTokenTimer(v)}).catch(function(v){console.log(v);GSession.sharedInstance().pushJsonMsg(v.message)})};this.resetRefreshTokenTimer=function(m){var v=m.expires_in-600,n=getEnvInfo();a.clearTimer();"web"==n?a.refreshTokenTimer=window.setTimeout(function(p){a.refreshToken(p)},1E3*v,m):"node"==n&&(a.refreshTokenTimer=setTimeout(function(p){a.refreshToken(p)},1E3*v,m))};this.clearTimer=function(){var m=getEnvInfo();"web"==m?null!=a.refreshTokenTimer&&
window.clearTimeout(a.refreshTokenTimer):"node"==m&&null!=a.refreshTokenTimer&&clearTimeout(a.refreshTokenTimer)};this.clearUserData=function(){f=userData=null}}GTenant.sharedInstance=function(){null==this.instance&&(this.instance=new GTenant);return this.instance};function GAnalysisES(a,c){if(null==a||""==a)return{};var f={seq:"(=)",eq:"=",gte:">=",lte:"<=",mustNot:"!=",gt:">",lt:"<",in:" in ",order:"order"},e={must:[]},h=!0;a=a.split(" and ");for(var g=0;g<a.length;g++){var m=a[g],v;for(v in f){var n=m.indexOf(f[v]);if("eq"==v&&-1!=n){var p=m[n-1];if(">"==p||"<"==p||"!"==p||"("==p)continue}if(-1!=n){var b=m.split(f[v]);p=trim(b[0]);p=p.replace(/_A_N_D_/g,"and");p=p.toLowerCase();var w=trim(b[1]);if(c)for(n=0;n<c.length;n++)p==c[n].toLowerCase()&&(""!=w&&w&&
"''"!=w&&'""'!=w||(h=!1));if(""==w||!w||"''"==w||'""'==w)break;else if("' '"==w||'" "'==w)w="",b[1]="''";if("break"==p)break;var z=void 0;n=!0;switch(f[v]){case ">=":case "<=":case ">":case "<":z={range:{}};z.range[p]={};for(var y in e)for(var l=e[y],u=0;u<l.length;u++){var x=l[u],d;for(d in x)null!=x[d][p]&&(z.range[p]=x[d][p],n=!1)}l=!0;if(0==trim(w).indexOf('"')||0==trim(w).indexOf("'"))l=!1;l?w=parseInt(trim(b[1])):(w=trimSingle(trim(b[1])),w=trimDbSingle(w),w=w.replace(/_A_N_D_/g,"and"));z.range[p][v]=
w;break;case "=":case "(=)":n=!0;w=[];if("(=)"==f[v]){w=trimSingle(trim(b[1]));w=trimDbSingle(w);w=JSON.parse(w);b={term:{}};b.term[p]=w;z=b;break}l=!1;if("string"==typeof b[1]&&0==trim(b[1]).indexOf("[")){if("[]"==b[1]){n=!1;break}l=!0;u=trim(b[1]).slice(1,-1);u=u.split(",");for(x=0;x<u.length;x++)if('""'!=trim(u[x])&&"''"!=trim(u[x])&&""!=trim(u[x])){if(0==u[x].indexOf("D'")){if("D''"==u[x]||'D""'==u[x])continue;var t=u[x].slice(2,-1);if(8==t.length){var q=t.slice(0,4);q+="-"+t.slice(4,6);q+="-"+
t.slice(6,8);u[x]="'"+q+"'"}}t=!0;if(0==trim(u[x]).indexOf('"')||0==trim(u[x]).indexOf("'"))t=!1;t?t=parseInt(trim(u[x])):(t=trimSingle(trim(u[x])),t=trimDbSingle(t),t=t.replace(/_A_N_D_/g,"and"));w.push(t)}}if(l){if(b=[],!(0>=w.length)){for(z=0;z<w.length;z++)b.push(w[z]);z={terms:{}};z.terms[p]=b}}else{if(0==b[1].indexOf("D'")){if("D''"==b[1]||'D""'==b[1])continue;z=b[1].slice(2,-1);8==z.length&&(w=z.slice(0,4),w+="-"+z.slice(4,6),w+="-"+z.slice(6,8),b[1]="'"+w+"'")}z=!0;if(0==trim(b[1]).indexOf('"')||
0==trim(b[1]).indexOf("'"))z=!1;if(z)w=parseInt(trim(b[1]));else{w=trimSingle(trim(b[1]));w=trimDbSingle(w);if(2<b.length)for(z=2;z<b.length;z++)l=trimSingle(trim(b[z])),l=trimDbSingle(l),w+="="+l;w=w.replace(/_A_N_D_/g,"and")}b={term:{}};b.term[p]=w;z=b}break;case " in ":n=!0;w.startsWith("(")&&w.endsWith(")")&&(w=w.slice(1,-1));z=w.split(",");b=[];for(w=0;w<z.length;w++)z[w]=z[w].replace(/'/g,""),b.push(z[w]);z={terms:{}};z.terms[p]=b;break;case "order":e.sort||(e.sort={});e.sort[p]={order:w};break;
case "!=":for(n=!1,e.must_not||(e.must_not=[]),p=analysisES(""==w?p+"=' '":p+"="+w).esCondition,b=0;b<p.must.length;b++)e.must_not[b]=p.must[b]}if(null!=z&&1==n){e.must.push(z);break}else if(0==n)break}}}return{esCondition:e,mustCheckStatu:h}};function ASTNode(){this.locModel={type:"",value:"",locIndex:null,loc:{start:{line:null,indexes:null},end:{line:null,indexes:null}}};this.astNode={type:"",id:"",params:[],body:[],parent:null}}
function ASTEnum(){this.keywordEnum={select:0,selecttree:1,"delete":2,from:3,and:4,or:5,at:6,"in":7,where:8,relation:9,include:10,sub:11,resample:12,"order by":13};this.punctuatorEnum={"(":0,")":1,",":2,"=":"eq",">":"gt",">=":"gte","<":"lt","<=":"lte","<>":"neq","!=":"neq","!":10,"/":11,"'":12,'"':13};this.charEnum={KEY_WORD:"Keyword",IDENTIFIER:"Identifier",PUNCTUATOR:"Punctuator",NUMERIC:"Numeric",STRING:"String",BOOLEAN:"Boolean"}}
ASTEnum.shareInstance=function(){this.instance||(this.instance=new ASTEnum);return this.instance};function GSQLModel(){this.field=[];this.keys=[];this.where=[];this.limit=[];this.orderby={};this.relations=[];this.resample={};this.expand=[];this._and=[];this.and={_and:this._and};this.model={type:"",field:this.field,table:""};this.codegenState={in:!1,where:!1,relation:!1,resample:!1,resampleStrObj:!1,resampleCount:0,brackets:!1,bracketsCount:0}}
function GScriptAST(){this.lineModel={line:null,indent:null,sliceStart:null,sliceEnd:null};this.punctuatorEnum=ASTEnum.shareInstance().punctuatorEnum;this.keywordEnum=ASTEnum.shareInstance().keywordEnum;this.charEnum=ASTEnum.shareInstance().charEnum;var a=new ASTNode;this.tokensLocNode=a.locModel;this.astNode=a.astNode;this.debug=!1;this.parse=function(c){var f={program:{},tokens:[],lines:[]};c=c.split("\n");for(var e=0;e<c.length;e++){var h=c[e],g=null,m=null,v=this.deCopy(this.lineModel);v.line=
h;v.indent=e;for(var n=0;n<h.length;n++)" "!==h[n]&&(null===g&&(g=n),m=n+1);v.sliceStart=g;v.sliceEnd=m;f.lines.push(v)}c=[];for(e=0;e<f.lines.length;e++){h=f.lines[e];g=h.line.substring(h.sliceStart,h.sliceEnd);m=0;v=-1;n=!1;for(var p=0;p<=g.length;p++){var b=g[p];switch(b){case " ":if(-1===v&&0==n)v=0;else break;this.addData(c,this.createLocNode(e,g,c.length,[m,p]));m=p;if(2<c.length){var w=c[c.length-2];b=c[c.length-1];null!=this.keywordEnum[(w.value+" "+b.value).toLowerCase()]&&(w=w.loc.start.indexes,
b=b.loc.end.indexes,c.splice(c.length-2,2),this.addData(c,this.createLocNode(e,g,c.length,[w,b])))}break;case "'":case '"':0===v?(m=p,v=-1,n=!0):-1===v&&1==n&&(n=!1,v=0,this.addData(c,this.createLocNode(e,g,c.length,[m,p+1])),m=p+2);break;case "/":case ",":case ")":case "(":case "=":v=0;" "!==g[p-1]&&!0!==this.isPunctuator(g[p-1])&&this.addData(c,this.createLocNode(e,g,c.length,[m,p]));this.addData(c,this.createLocNode(e,g,c.length,[p]));m=p;break;case "!":case "<":case ">":if(null==g[p+1]){this.errorMsg(h.indent,
g,p,g[p]+" \u7b26\u53f7\u8bed\u6cd5\u9519\u8bef");return}if(">"===g[p+1]||"="===g[p+1]){v=0;" "!==g[p-1]&&this.addData(c,this.createLocNode(e,g,c.length,[m,p]));this.addData(c,this.createLocNode(e,g,c.length,[p,p+2]));m=p++;break}v=0;" "!==g[p-1]&&this.addData(c,this.createLocNode(e,g,c.length,[m,p]));this.addData(c,this.createLocNode(e,g,c.length,[p]));m=p;break;default:0===v?(m=p,v=-1):null==b&&-1===v&&(v=0,this.addData(c,this.createLocNode(e,g,c.length,[m,p])),m=p)}}}f.tokens=c;c=this.createASTProgram(f.tokens);
f.program=c;return f};this.isPunctuator=function(c){return"undefined"!==typeof this.punctuatorEnum[c]?!0:!1};this.errorMsg=function(c,f,e,h){console.error("AST\u89e3\u6790\u5931\u8d25\uff1a\n        errorLine:\u7b2c"+c+"\u884c,\n        errorSQL:'"+f+"',\n        errorPos:\u4e0b\u6807"+e+",\n        errorMsg:'"+h+"'")};this.addData=function(c,f){c.push(f)};this.createLocNode=function(c,f,e,h){var g;if(1==h.length){f=f[h[0]];var m=g=h[0]}else f=f.substring(h[0],h[1]),m=h[0],g=h[1];h=this.deCopy(this.tokensLocNode);
h.locIndex=e;h.value=f;h.loc.start.line=c;h.loc.start.indexes=m;h.loc.end.line=c;h.loc.end.indexes=g;c=this.scannerValueType(f);h.type=c;return h};this.scannerValueType=function(c){return isNaN(Number(c))?null!=this.keywordEnum[c.toLowerCase()]?this.charEnum.KEY_WORD:null!=this.punctuatorEnum[c]?this.charEnum.PUNCTUATOR:"'"===c[0]||'"'===c[0]||"'"===c[c.length-1]||'"'===c[c.length-1]?this.charEnum.STRING:this.charEnum.IDENTIFIER:this.charEnum.NUMERIC};this.createASTProgram=function(c){for(var f={error:null,
body:[],params:[],sourceType:"sql",type:"Program"},e=f,h=[],g=0;g<c.length;g++){var m=c[g],v=m.type,n=m.value,p=this.deCopy(this.astNode);switch(v){case "Keyword":switch(n.toLowerCase()){case "select":case "selecttree":case "from":case "include":case "sub":p.type=v;p.id=m;p.parent=e;e.body.push(p);e=p;break;case "in":e.id.value="in";break;case "where":p.type=v;p.id=m;p.parent=e;e.body.push(p);e=this.deCopy(this.astNode);e.id=this.deCopy(m);e.id.value="and";e.id.type="Keyword";e.id.declaration="sourcewhere";
e.type="Keyword";e.parent=p;p.body.push(e);break;case "at":case "relation":case "resample":case "order by":for(n=null;null==n;)"from"==e.id.value?n=e:"from"==e.parent.id.value?n=e.parent:e=e.parent;e=n;p.type=v;p.id=m;p.parent=e;e.body.push(p);e=p;break;case "or":case "and":"where"!==e.id.value.toLowerCase()&&(e=e.parent),p.type=v,p.id=m,p.parent=e,e.body.push(p),e=p}break;case "Identifier":p.id=m;p.type=v;p.parent=e;e.params.push(p);break;case "Punctuator":switch(n){case "(":"from"===e.id.value.toLowerCase()?
(h.push(e),e=e.params,e=0>=e.length?e:e[e.length-1]):"where"!==e.id.value.toLowerCase()?(p.id=this.deCopy(m),p.id.value="where",p.id.type="Keyword",p.id.declaration="brackets",p.type="Keyword",p.parent=e,e.body.push(p),h.push(e),e=p):h.push(e);break;case ")":m=h[h.length-1];"in"===m.id.value&&"Keyword"===m.type&&(m=m.parent);if(0<e.params.length)e.params[e.params.length-1].id.declaration="endbrackets_1";else{for(;0<e.body.length;)e=e.body[e.body.length-1];null!=e.params&&(e=e.params[e.params.length-
1],p=e.id.declaration.split("_"),p=p[0]+"_"+(parseInt(p[1])+1),e.id.declaration=p)}h.pop();e=m;break;case "=":case "<":case "<=":case ">":case ">=":case "!=":case "<>":e.id.operator=n}break;case "Numeric":case "String":p.type=v,p.id=m,p.parent=e,e.params.push(p)}}return f};this.transform=function(c){};this.codegen=function(c){};this.VLR=function(c,f,e,h,g,m,v){if(null!=g){var n=g.value;switch(n){case "select":f.model.type=n;"left"==m&&(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value),
f.field.push(c.id.value));break;case "from":"left"==m&&(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value),f.model.table=""==f.model.table?c.id.value:f.model.table+("/"+c.id.value));break;case "in":"left"==m?(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value),n={},n[c.id.value]=null,f._and.push(n)):c.id&&"brackets"==c.id.declaration&&(1==this.debug&&console.log(n+"\u62ec\u53f7\u5f00\u59cb"),e.in=!0);break;case "where":if("left"==m){if(1==v&&null!=g.operator)if(1==this.debug&&
console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+c.id.value),1==e.brackets){var p={};g=this.punctuatorEnum[g.operator];var b=this.getFormatValue(c);p[g]=b;g=f._and[f._and.length-1];1<this.codegenState.bracketsCount&&(g=this.readNestObj(g).obj);if("Array"==g.constructor.name)g=g[g.length-1];else{for(var w in g)var z=w;g=g[z];g="Object"==g.constructor.name?g:g[g.length-1]}for(var y in g)z=y;null==g[z]?g[z]=p:console.error("\u63d2\u5165\u5931\u8d25\uff1a",p)}else 1==e.resample&&this.resampleInsert(c,
f,e);else if(1!=e.relation&&1!=e.resample&&1!=e.in&&"brackets"==g.declaration&&(1==this.debug&&console.log(n+"\u62ec\u53f7\u5f00\u59cb \u7c7b\u578b\u4e3a\uff1a"+c.parent.parent.id.value),e.brackets=!0,g={},g["_"+c.parent.parent.id.value]={},1<=e.bracketsCount?(p=f._and[f._and.length-1],p=this.readNestObj(p).obj,p.push(g)):f._and.push(g),e.bracketsCount++),1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value),1==e.relation)g=this.getFormatValue(c),f.relations.push(g);else if(1==e.resample)this.resampleInsert(c,
f,e);else if(1==e.in){g=this.getFormatValue(c);p=f._and[f._and.length-1];var l;for(l in p){var u=l;null==p[l]&&(p[l]={in:[]})}p[u].in.push(g)}else if(1==e.brackets)if(g=z=f._and[f._and.length-1],1<e.bracketsCount&&(g=this.readNestObj(g).obj),p={},p[c.id.value]=null,"Array"==g.constructor.name)g.push(p);else{for(var x in g)b=x;if(null==b){z=this.readNestObj(z).parent;for(var d in z)b=d;g[b]=p}else"Object"==g[b].constructor.name?g[b]=p:g[b].push(p)}c.id&&c.id.declaration&&1==c.id.declaration.startsWith("endbrackets")&&
(g=parseInt(c.id.declaration.split("_")[1]),1==e.relation?(1==this.debug&&console.log("relation\u7ed3\u675f"),e.relation=!1):1==e.in?(1==this.debug&&console.log("in\u7ed3\u675f"),e.in=!1):1==e.resample?(1==this.debug&&console.log("resample\u7ed3\u675f"),e.resample=!1):(e.brackets=!1,e.bracketsCount-=g,1==this.debug&&console.log(n+"\u62ec\u53f7\u7ed3\u675f "+g+"\u6b21,\u5269\u4f59\u9500\u6bc1\u62ec\u53f7\uff1a"+e.bracketsCount+"\u6b21 ")))}else e.where=!0;break;case "or":case "and":if("left"==m)if(1==
v){if(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+c.id.value),1==e.where)if(1==e.brackets){p=f._and[f._and.length-1];var t;for(t in p)var q=t;"_or"==q&&"and"==n?(n=this.readNestObj(p).obj,n=n[n.length-1],n=n._and,"Object"!=n.constructor.name&&(n=n[n.length-1]),this.insertValue(n,c,g)):"_and"==q&&"or"==n?(n=this.readNestObj(p).obj,n=n[n.length-1],n=n._or,"Object"!=n.constructor.name&&(n=n[n.length-1]),this.insertValue(n,c,g)):(p=this.readNestObj(p).obj,this.insertValue("Object"==
p.constructor.name?p:p[p.length-1],c,g))}else"or"==n?(n=f._and[f._and.length-1],n="Object"==n._or.constructor.name?n._or:n._or[n._or.length-1],this.insertValue(n,c,g)):this.insertValue(f._and[f._and.length-1],c,g)}else{if(1==e.where)if(g={},g[c.id.value]=null,1==e.brackets){y=f._and[f._and.length-1];for(var D in y)p=D;z=this.readNestObj(y).obj;if("_or"==p&&"and"==n)b={},"Object"==z.constructor.name&&"Object"==z[p].constructor.name?(y=this.readNestObj(y).parent,d=z[p],y[p]=[],z=y[p],b._and=[],b._and.push(d),
b._and.push(g)):"Array"==z.constructor.name?(p=z[z.length-1],0<p["_"+n].length&&(z=p["_"+n]),b=g):b._and=g,z.push(b);else if("_and"==p&&"or"==n)p={_or:{}},p._or=g,z.push(p);else{b=0;for(var A in y)b++;1<=b&&(y[p]=[],y[p].push(z),z=y[p]);z.push(g)}}else"or"==n?(p={_or:{}},p._or=g,f._and.push(p)):f._and.push(g);1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value)}else"endbrackets"!=g.declaration&&"endbrackets"!=c.id.declaration||1!=this.debug||console.log(n+"\u62ec\u53f7\u7ed3\u675f");break;
case "at":"left"==m&&(1==v?(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a "+c.id.value),null!=f.model[n+"Last"]?(g=this.getFormatValue(c),f.model[n+"Last"]=g):null!=f.model[n+"Date"]&&(g=this.punctuatorEnum[g.operator],p=this.getFormatValue(c),f.model[n+"Date"][g]=p)):(1==this.debug&&console.log(n+"\u8282\u70b9\uff1a "+c.id.value),"Identifier"==c.id.type&&("last"==c.id.value.toLowerCase()?f.model[n+"Last"]="":"date"==c.id.value.toLowerCase()&&(f.model[n+"Date"]={}))));break;case "relation":"left"==
m?1==v?1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+c.id.value):1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value):(1==this.debug&&console.log(n+"\u8282\u70b9->\u5b50\u8282\u70b9 "+c.id.value),e.relation=!0);break;case "resample":"left"==m?1==v?1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+g.operator+"  "+c.id.value):1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value):(1==this.debug&&console.log(n+"\u8282\u70b9->\u5b50\u8282\u70b9 "+c.id.value),
e.resample=!0);case "include":"left"==m&&"flags"==c.id.value.toLowerCase()&&(f.model.includeFlags=1);break;case "sub":"left"==m&&(n=this.getFormatValue(c),f.model.subscribe=n);break;case "order by":"left"==m&&(n=this.getFormatValue(c),0==v?f.orderby.field=n:1==v&&("desc"==n.toLowerCase()?f.orderby.desc=1:"asc"==n.toLowerCase()?f.orderby.desc=-1:console.info("order by \u9519\u8bef\u8bed\u53e5\uff1a"+n,c)));break;default:"left"==m&&1==this.debug&&console.log(n+"\u8282\u70b9\uff1a  "+c.id.value),null==
this.keywordEnum[n]&&c.parent&&c.parent.parent&&"from"==c.parent.parent.id.value&&(1==this.debug&&console.log("from\u8282\u70b9 - "+n+"\u503c\uff1a   "+c.id.value),f.keys.push(this.getFormatValue(c)))}}g=c.params;n=c.body;for(p=0;p<g.length;p++)this.VLR(g[p],f,e,!1,c.id,"left",p);for(g=0;g<n.length;g++)if(n[g].id.value&&"select"==n[g].id.value.toLowerCase()&&1==h){p=new GSQLModel;this.VLR(n[g],p,p.codegenState);1<p._and.length?p.model.where=p.and:1==p._and.length&&(p.model.where=p._and[0]);0<p.keys.length&&
(p.model.keys=p.keys);0<p.relations.length&&(p.model.relations=p.relations);1==this.mapIsLength(p.resample)&&(p.model.resample=p.resample);1==this.mapIsLength(p.orderby)&&(p.model.orderby=p.orderby);y=f._and[f._and.length-1];z=void 0;for(var G in y)z=G;y={};y[z]={in:p.model};f.where=y;null==f.model.where&&(f.model.where={});f.model.where=f.where;f._and.splice(f._and.length-1);f._and.push(f.where);e.in=!1}else this.VLR(n[g],f,e,!0,c.id,"right",null)};this.readNestObj=function(c){for(var f=0,e,h=0;h<
this.codegenState.bracketsCount;h++){f++;for(var g in c)1==g.startsWith("_")&&(f==this.codegenState.bracketsCount?(e=c,c=c[g]):(e=c,c=c[g][c[g].length-1]))}return{obj:c,parent:e}};this.insertValue=function(c,f,e){var h=!1,g=null,m;for(m in c)null==c[m]&&(g=m,h=!0);1==h?(h={},e=this.punctuatorEnum[e.operator],f=this.getFormatValue(f),h[e]=f,c[g]=h):console.error(val+"\u8282\u70b9\u63d2\u5165\u5931\u8d25\uff0c\u8fd0\u7b97\u7b26\uff1a"+e.operator+"\uff0c\u503c\uff1a"+f.id.value)};this.resampleInsert=
function(c,f,e){if("string"==c.id.type.toLowerCase())if(-1!=c.id.value.indexOf('"')&&3>c.id.value.split('"').length){var h=1==c.id.value.startsWith('"')?1:0;c.id.value=c.id.value.replace('"',"");e.resampleStrObj=1==e.resampleStrObj?!1:!0}else-1!=c.id.value.indexOf("'")&&3>c.id.value.split("'").length&&(h=1==c.id.value.startsWith("'")?1:0,c.id.value=c.id.value.replace("'",""),e.resampleStrObj=1==e.resampleStrObj?!1:!0);if(null!=h||1==e.resampleStrObj){null==f.resample.how&&(f.resample.how={});var g=
c.id.value.split(":");2==g.length?f.resample.how[g[0]]=g[1]:console.error("resample \u89e3\u6790\u5931\u8d25\uff0c\u9519\u8bef\u7684\u53d8\u9891\u53c2\u6570\uff01 "+c.id.value);0==e.resampleStrObj&&e.resampleCount++}else{if(0==e.resampleCount%2)g=this.getFormatValue(c),f.resample[g]=null;else{c=this.getFormatValue(c);f=this.readNestObj(f.resample).obj;for(var m in f)g=m;null==f[g]?f[g]=c:console.error("\u63d2\u5165\u5931\u8d25\uff1a",valueMap)}e.resampleCount++}};this.getFormatValue=function(c){return"String"==
c.id.type?eval(c.id.value):"Numeric"==c.id.type?parseInt(c.id.value):c.id.value};this.autoGenerate=function(c){var f=new GSQLModel;this.sqlModel=f;this.codegenState=f.codegenState;c=this.parse(c).program;this.VLR(c,this.sqlModel,this.codegenState,!1);1<this.sqlModel._and.length?this.sqlModel.model.where=this.sqlModel.and:1==this.sqlModel._and.length&&(this.sqlModel.model.where=this.sqlModel._and[0]);0<this.sqlModel.keys.length&&(this.sqlModel.model.keys=this.sqlModel.keys);0<this.sqlModel.relations.length&&
(this.sqlModel.model.relations=this.sqlModel.relations);1==this.mapIsLength(this.sqlModel.resample)&&(this.sqlModel.model.resample=this.sqlModel.resample);1==this.mapIsLength(this.sqlModel.orderby)&&(this.sqlModel.model.orderby=this.sqlModel.orderby);return this.sqlModel.model};this.getParams=function(c){for(var f=null,e=0;e<c.params.length;e++)null==f&&(f=[]),f.push(c.params[e]);return f};this.getParamsValue=function(c,f){for(var e=[],h=1;h<arguments.length;++h)e[h-1]=arguments[h];h=null;for(var g=
0;g<c.params.length;g++){null==h&&(h=[]);for(var m={},v=0;v<e.length;v++)m[e[v]]=c.params[g].id[e[v]];h.push(m)}return h};this.mapIsLength=function(c){for(var f in c)if(null!=c[f])return!0;return!1};this.deCopy=function(c){return JSON.parse(JSON.stringify(c))}}(function(){var a="object"===typeof window?window:{},c="function"===typeof define&&define.amd;"object"===typeof process&&process.versions&&process.versions.node&&(a=global);a.scriptAst=new GScriptAST;c&&define(function(){return exports})})();var GSDKLog=function(){};GSDKLog.log=function(a){GSDKLog.output("log",a)};GSDKLog.info=function(a){GSDKLog.output("info",a)};GSDKLog.error=function(a){GSDKLog.output("error",a)};GSDKLog.output=function(a,c){var f=new GLog;f.level=a;f.msg=c;f.time=getNowSaftTime();if(GSDK&&null!=GSDK.onRealLog)GSDK.onRealLog(f)};function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function ltrim(a){return a.replace(/(^\s*)/g,"")}function rtrim(a){return a.replace(/(\s*$)/g,"")}function trimSingle(a){return a.replace(/(^'*)|('*$)/g,"")}function trimDbSingle(a){return a.replace(/(^"*)|("*$)/g,"")}function isStringType(a){var c=/(^"*)|("*$)/;return/(^'*)|('*$)/.test(a)||c.test(a)?!0:!1}
function strIsNumber(a){var c=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return/^\d+(\.\d+)?$/.test(a)||c.test(a)?!0:!1}function objLength(a){var c=0,f;for(f in a)c++;return c}
function getTableForMap(a){var c=null;if(a&&a.data&&"row"==a.info.rank&&0<a.data.length&&a.field&&a.field.length==a.data[0].length)for(var f=0;f<a.field.length;f++)c||(c={}),c[a.field[f][0]]={value:a.data[0][f],valueType:a.field[f][1]};else if(a&&a.data&&"col"==a.info.rank&&0<a.data.length&&a.field&&a.field.length==a.data.length)for(f=0;f<a.field.length;f++)c||(c={}),c[a.field[f][0]]={value:a.data[f][0],valueType:a.field[f][1]};return c}
function getNowSaftTime(){var a=new Date,c=a.getFullYear(),f=a.getMonth()+1,e=a.getDate(),h=10>a.getHours()?"0"+a.getHours():a.getHours(),g=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes(),m=10>a.getSeconds()?"0"+a.getSeconds():a.getSeconds();a=a.getMilliseconds();return c+"-"+f+"-"+e+" "+h+":"+g+":"+m+"."+a}function getEnvInfo(){if("undefined"!=typeof window&&null!=window)return"web";if("object"===typeof process&&process.versions&&process.versions.node)return"node"}
function makeMessageString(a){a=a.replace(/"/g,"__2__");a=a.replace(/\n/g,"\\n");a=a.replace(/\t/g,"\\t");return a=a.replace(/\\/g,"\\\\")}function xDeepCopy(a){a=JSON.stringify(a);return JSON.parse(a)}function CheckMustParams(a,c){for(var f=0;f<c.length;f++)if(""==a[c[f]]||null==a[c[f]])return GSDKLog.error(c[f]+"\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a"),!1;return!0};
